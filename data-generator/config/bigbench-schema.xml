<?xml version="1.0" encoding="UTF-8"?>

<!--
READ ME
This configuration file is only for documentation. 
Changes you make here will not in any way influence the data generation. 
To be able to edit the files containing the data generation rules for 
Big-Data-Benchmark-for-Big-Bench you need to acquire a copy of the 
Parallel Data Generation Framework (PDGF). 
PDGF is a product of bankmark UG(haftungsbeschraenkt).
Please contact info@bankmark.de for an evaluation license.
-->

<schema name="bigbench">

 <!-- Table overview -->
 <!-- Table customer               columns: 18 dimension table -->
 <!-- Table customer_address       columns: 13 dimension table -->
 <!-- Table customer_demographics  columns:  9 dimension table -->
 <!-- Table date_dim               columns: 28 dimension table -->
 <!-- Table dbgen_version          columns:  4 dimension table -->
 <!-- Table household_demographics columns:  5 dimension table -->
 <!-- Table income_band            columns:  3 dimension table -->
 <!-- Table inventory              columns:  4 fact table-->
 <!-- Table item                   columns: 22 dimension table -->
 <!-- Table item_marketprices      columns:  6 -->
 <!-- Table product_reviews        columns:  8 -->
 <!-- Table promotion              columns: 19 dimension table -->
 <!-- Table reason                 columns:  3 dimension table -->
 <!-- Table ship_mode              columns:  6 dimension table -->
 <!-- Table store                  columns: 29 dimension table -->
 <!-- Table store_returns          columns: 20 fact table -->
 <!-- Table store_sales            columns: 23 fact table -->
 <!-- Table time_dim               columns: 10 dimension table -->
 <!-- Table warehouse              columns: 14 dimension table -->
 <!-- Table web_clickstreams       columns:  7 -->
 <!-- Table web_page               columns: 14 dimension table -->
 <!-- Table web_returns            columns: 24 fact table -->
 <!-- Table web_sales              columns: 35 fact table -->
 <!-- Table web_site               columns: 26 dimension table -->

 <!-- All random values are derived from this seed. As long as this value remains the same, 
 the generated dataset will be identical across multiple runs  ...  
 -->
 <seed>67456345324534L</seed>
 
 <!-- Random number generator implementation to use-->
 <!-- <rng name="PdgfDefaultRandom"></rng> -->
 
 <!-- Global constants -->
 <property name="${one_day_in_milliseconds}" type="double">24.0 * 60.0 * 60.0 * 1000.0</property><!-- one day -->
 <!-- datetime format:  "yyyy-MM-dd HH:mm:ss" --> 
  

 
 
 <!-- Refresh system -->
 <property name="${REFRESH_PHASE}" type="double">0</property><!-- 0==rows[0,REFRESH_PERCENTAGE*Table.Size]; 1==rows[REFRESH_PERCENTAGE*Table.Size+1, Table.Size] .Has effect only if  ${REFRESH_SYSTEM_ENABLED}==1. -->
 <property name="${REFRESH_SYSTEM_ENABLED}" type="double">1</property>
 <property name="${REFRESH_PERCENTAGE}" type="double">1.0d - 0.01d</property><!-- default  1%==0.01-->
 <property name="${DEBUG_REFRESH}" type="double">1</property>
 
 <!-- Global parameters (affect multiple tables)-->
 <property name="NULL_CHANCE" type="double">0.00025</property>
 
 <!-- serial keys like customer_sk date_sk etc.. start at 0 or at 1 or... -->
 <property name="${SK_ID_OFFSET}" type="double">0</property>


 <!-- benchmark time frame. Note: queries rely on this time frames, if you change that, change the query parametrization too--> 
 <property name="${CURRENT_DAY}" type="datetime">2006-01-02 00:00:00</property> <!-- implicit fact tables end day -->
 <property name="${FACT_TABLES_START_DAY}" type="datetime">2001-01-01 00:00:00</property>
 <property name="${FACT_TABLES_END_DAY}" type="datetime">${CURRENT_DAY}</property>
 <property name="${DIMENSION_TABLES_START_DAY}" type="datetime">2000-01-03 00:00:00</property>
 <property name="${DIMENSION_TABLES_END_DAY}" type="datetime">2004-01-05 00:00:00</property> <!--  does this make sense to end years before the FACT tables end date? -->
 

 <!-- Table scaling types -->
 <property name="${SF}" type="double">1</property> <!-- "root" scalefactor. SF 1 ~1GB, SF 10 ~10GB, .... -->
 <property name="${SF_log_1.5}" type="double">Math.log(${SF}) / Math.log(1.5d) + 1.0d</property>
 <property name="${SF_log_5}" type="double">(Math.log(${SF}) / Math.log(5.0d) + 1.0d)</property>
 <property name="${SF_sqrt}" type="double">Math.sqrt(${SF})</property>
 <property name="${SF_linear}" type="double">${SF} * (2.0d - (${SF_log_5} * ${SF_sqrt} / ${SF}))</property>


 
 <!-- address (used in various tables) -->
 <property name="${address_street_number_min}" type="double">1.0</property>
 <property name="${address_street_number_max}" type="double">1000.0</property>
 <property name="${address_suite_number_min}" type="double">1.0</property>
 <property name="${address_suite_number_max}" type="double">10.0</property>
 <property name="${address_zip_min}" type="double">10000.0</property>
 <property name="${address_zip_max}" type="double">99999.0</property>
 

 <!-- Table specific properties -->
 
 <!--  date_dim -->
 <property name="${date_dim_begin_date}" type="datetime">1900-01-01 00:00:00</property>
 <property name="${date_dim_end_date}" type="datetime">2200-01-01 00:00:00</property>
 
 <!-- customer -->
 <property name="${preferred_cust_likelihood}" type="double">0.5</property>
 
 <!-- customer_demographics -->
 <property name="${gender_likelihood}" type="double">0.5</property>
 <property name="${married_likelihood}" type="double">0.3</property>
 <property name="${divorced_likelihood}" type="double">0.2</property>
 <property name="${single_likelihood}" type="double">0.2</property>
 <property name="${widowed_likelihood}" type="double">0.2</property>
 
 <!-- income_band -->
 <property name="${income_band_stepsize}" type="double">10000</property>
 
 <!-- inventory -->
 <property name="${inventory_begin_date}" type="datetime">${FACT_TABLES_START_DAY}</property>
 <property name="${inventory_end_date}" type="datetime">${FACT_TABLES_END_DAY}</property> 
 <property name="${inventory_weeks}" type="long">(${inventory_end_date} - ${inventory_begin_date}) / ${one_day_in_milliseconds} / 7</property>
 <property name="${inventory_days_since_date_begin_date}" type="long">(${inventory_begin_date} - ${date_dim_begin_date}) / ${one_day_in_milliseconds}</property>
 
 <!-- item -->
 <property name="${item_begin_date}" type="datetime">${DIMENSION_TABLES_START_DAY}</property>
 <property name="${item_end_date}" type="datetime">${DIMENSION_TABLES_END_DAY}</property> 
 
 <!-- item_marketprice -->
 <property name="${item_marketprice_max_validity_days}" type="long">365</property><!-- item_marketprice of competitor can be valid this amount of days -->
 <property name="${item_marketprice_avg_competitors_per_item}" type="double">5</property>
 
 <!-- product_reviews -->
 <property name="${anonymous_reviews_per_item}" type="double">5</property>
 <property name="${reviews_per_user}" type="double">0.2</property>
 <property name="${reviews_per_sale}" type="double">0.01</property>
 <property name="${PR_CONTAINING_STORE_NAME_PERCENT}" type="double">0.001</property> <!-- ~7 reviews per store @ SF 1 (90k reviews)/(13 stores)* 0.001=6.9 -->
 
 <!-- promotion -->
 <property name="${dmail_likelihood}" type="double">0.5</property>
 <property name="${email_likelihood}" type="double">0.1</property>
 <property name="${catalog_likelihood}" type="double">0.1</property>
 <property name="${tv_likelihood}" type="double">0.1</property>
 <property name="${radio_likelihood}" type="double">0.1</property>
 <property name="${press_likelihood}" type="double">0.1</property>
 <property name="${event_likelihood}" type="double">0.1</property>
 <property name="${demo_likelihood}" type="double">0.1</property>
 <property name="${discount_active_likelihood}" type="double">0.1</property>
 
 <!-- store -->
 <property name="${store_begin_date}" type="datetime">${DIMENSION_TABLES_START_DAY}</property>
 <property name="${store_end_date}" type="datetime">${DIMENSION_TABLES_END_DAY}</property>
 <property name="${STORE_MIN_TAX_PERCENTAGE}" type="double">0.00</property>
 <property name="${STORE_MAX_TAX_PERCENTAGE}" type="double">0.11</property>
 
 <!-- store_returns -->
 <property name="${return_store_sale_likelihood}" type="double">0.1</property>
 <property name="${SR_SAME_CUSTOMER}" type="double">0.9</property>
 <property name="${SR_MAX_RETURN_DAYS_AFTER_PURCHASE}" type="double">715</property>
 
   
 <!-- store_sales -->
 <property name="${SS_QUANTITY_MAX}" type="double">100</property>
 <property name="${SS_WHOLESALE_MAX}" type="double">100.00</property>
 <property name="${SS_MARKUP_MAX}" type="double">1.00</property>
 <property name="${SS_DISCOUNT_MAX}" type="double">1.00</property>
 <property name="${store_sales_begin_date}" type="datetime">${FACT_TABLES_START_DAY}</property>
 <property name="${store_sales_end_date}" type="datetime">${FACT_TABLES_END_DAY}</property>
 <property name="${store_sales_days_since_date_begin_date}" type="long">(${store_sales_begin_date} - ${date_dim_begin_date}) / ${one_day_in_milliseconds}</property>
 <property name="${store_sales_days_within}" type="long">(${store_sales_end_date} - ${store_sales_begin_date}) / ${one_day_in_milliseconds}</property>
 <property name="${store_sales_end_date_sk}" type="long">${store_sales_days_since_date_begin_date}+${store_sales_days_within}</property>
 <property name="${SS_ITEMS_PER_ORDER_MIN}" type="double">1</property>
 <property name="${SS_ITEMS_PER_ORDER_MAX}" type="double">14</property>

 <!-- web_clickstreams -->
 <property name="${visitor_likelihood}" type="double">0.8</property>
 <property name="${visitor_known_likelihood}" type="double">0.5</property>
 <property name="${mean_clicks_per_visitor}" type="double">16</property>
 <property name="${mean_clicks_per_buyer}" type="double">4</property>
 <property name="${clickstreams_chunksize}" type="double">5</property>
  <!-- old system, superseded by '${clickstreams_chunksize}' etc.. -->
  <property name="${pages_per_item}" type="double">4</property><!-- unused -->
  <property name="${pages_to_buy}" type="double">4</property><!-- unused -->
  <property name="${items_per_cart}" type="double">12</property><!-- unused -->
  <property name="${buy_ratio}" type="double">4</property><!-- unused -->
 
 <!-- web_page -->
 <property name="${web_page_begin_date}" type="datetime">${DIMENSION_TABLES_START_DAY}</property>
 <property name="${web_page_end_date}" type="datetime">${DIMENSION_TABLES_END_DAY}</property> 
 <property name="${WP_AUTOGEN_PCT}" type="double">0.30</property>
 <property name="${WP_LINK_MIN}" type="double">2</property>
 <property name="${WP_LINK_MAX}" type="double">25</property>
 <property name="${WP_IMAGE_MIN}" type="double">1</property>
 <property name="${WP_IMAGE_MAX}" type="double">7</property>
 <property name="${WP_AD_MIN}" type="double">0</property>
 <property name="${WP_AD_MAX}" type="double">4</property>
 
 <!-- warehouse -->
 <property name="${W_SQFT_MIN}" type="double">50000</property>
 <property name="${W_SQFT_MAX}" type="double">1000000</property>
  
 <!-- web_returns -->
 <property name="${WR_return_web_sale_likelihood}" type="double">0.1</property>
 <property name="${WR_MAX_RETURN_DAYS_AFTER_PURCHASE}" type="double">715</property>
 
 <!-- web_sales -->
 <property name="${WS_QUANTITY_MAX}" type="double">100</property>
 <property name="${WS_WHOLESALE_MAX}" type="double">100.00</property>
 <property name="${WS_MARKUP_MAX}" type="double">2.00</property>
 <property name="${WS_DISCOUNT_MAX}" type="double">1.00</property>
 <property name="${WS_MIN_SHIP_DELAY}" type="double">1</property>
 <property name="${WS_MAX_SHIP_DELAY}" type="double">120</property>
 <property name="${WS_ITEMS_PER_ORDER_MIN}" type="double">1</property>
 <property name="${WS_ITEMS_PER_ORDER_MAX}" type="double">14</property>
 
 <property name="${WS_GIFT_PCT}" type="double">0.07</property>
 <property name="${web_sales_begin_date}" type="datetime">${FACT_TABLES_START_DAY}</property>
 <property name="${web_sales_end_date}" type="datetime">${FACT_TABLES_END_DAY}</property> 
 <property name="${web_sales_days_since_date_begin_date}" type="long">(${web_sales_begin_date} - ${date_dim_begin_date}) / ${one_day_in_milliseconds}</property>
 <property name="${web_sales_days_within}" type="long">(${web_sales_end_date} - ${web_sales_begin_date}) / ${one_day_in_milliseconds}</property>
 
 
 
 <!-- table sizes formulas (Scaling of tables with increasing scale factor SF) -->
  <!-- Not used tables: -->
 <property name="${income_band_size}" type="long">20</property>
 <property name="${reason_size}" type="long">35 * ${SF_log_1.5}</property>
 <property name="${ship_mode_size}" type="long">20</property>
 <property name="${web_site_size}" type="long">30</property>

 <!-- static (fixed size) tables -->
 <property name="${date_dim_size}" type="long">(${date_dim_end_date} - ${date_dim_begin_date}) / ${one_day_in_milliseconds}</property>
 <property name="${time_dim_size}" type="long">${one_day_in_milliseconds} / 1000</property>
 <property name="${customer_demographics_size}" type="long">1920800L</property>
 <property name="${household_demographics_size}" type="long">7200L</property>
 
 <!-- "normal" not refreshed tables -->
 <property name="${store_size}" type="long">12 * ${SF_sqrt}</property>
 <property name="${promotion_size}" type="long">300 * ${SF_log_1.5}</property>
 <property name="${warehouse_size}" type="long">5.0d * ${SF_log_5}</property>
 <property name="${web_page_size}" type="long">60 * ${SF_log_1.5}</property>
 
 <!-- refreshed tables -->
  <!-- 
   Refresh tables generate extra data during refresh (e.g. add new data to the existing tables)
  In "normal"-Phase  generate table rows:  [0,REFRESH_PERCENTAGE*Table.Size]; 
  In "refresh"-Phase generate table rows:  [REFRESH_PERCENTAGE*Table.Size+1, Table.Size] 
 -->
  <property name="${item_size_base}" type="long">18000.0d</property>
 
 
 <property name="${customer_size}" type="long">100000.0d * ${SF_sqrt}</property>
 <property name="${customer_address_size}" type="long">${customer_size} / 2</property>
 <property name="${item_size}" type="long">${item_size_base} * ${SF_sqrt}</property>
 <property name="${item_marketprices_size}" type="long">${item_size} * ${item_marketprice_avg_competitors_per_item}</property>
 <property name="${store_sales_size}" type="long">90000.0d * ${SF_linear}</property>
 <property name="${store_returns_size}" type="long">${return_store_sale_likelihood} * ${store_sales_size}</property>
 <property name="${inventory_size}" type="long">${inventory_weeks} * ${item_size} * ${warehouse_size}</property>
 <property name="${web_sales_size}" type="long">90000.0d * ${SF_linear}</property>
 <property name="${web_returns_size}" type="long">${WR_return_web_sale_likelihood} * ${web_sales_size}</property>
 <!--<property name="${product_reviews_size}" type="long">(${item_size} * ${anonymous_reviews_per_item}) + (${customer_size} * ${reviews_per_user}) + (${web_sales_size} * ${reviews_per_sale}) * ${SF}</property>-->
 <property name="${product_reviews_size}" type="long">(${item_size} * ${anonymous_reviews_per_item}) + (${web_sales_size} * ${reviews_per_sale})</property>
 <!--<property name="${web_clickstreams_size}" type="double">(${web_sales_size} * (${pages_per_item} + (${pages_to_buy} / ${items_per_cart}))) + (${web_sales_size} * ${buy_ratio} * ${pages_per_item}) * ${SF}</property>-->
 <property name="${web_clickstreams_size}" type="long">${clickstreams_chunksize} * ${web_sales_size}</property>
 
 
 
  <!-- item purchase distribution. Some items are more frequently purchased then others. used in store-/web-sales, influences store-/web-returns-->
 <property name="${nonUniformyPurchasedItems_Ratio}" type="double">0.4</property><!-- 40% of all items are chosen with a normal/gaussian distribution. (arround 6*${nonUniformyPurchasedItems_SD_BASE}=360 -->
 <property name="${staticPurchasedItems_Ratio}" type="double">0.05</property> <!-- 10% of all items have item sk: 10000-10003. Required for "frequently sold together" relation -->
 
 <property name="${nonUniformyPurchasedItems_SD_BASE}" type="double">60</property><!-- standard deviation at sf 1 -->
 <!-- customer purchase distribution. Some customers purchase more frequently then others. used in store-/web-sales, influences store-/web-returns-->
 <property name="${nonUniformyCustomerPurchases_SD_BASE}" type="double">400</property>
 <property name="${nonUniformyCustomerPurchases_Ratio}" type="double">0.5</property>
 

 <!-- Each row in this table represents one calendar day. The surrogate key (d_date_sk) for a given row is derived from the julian date being described by the row -->
 <table name="date_dim">
  <size>${date_dim_size}</size>
  
  <!-- used by Q4, Q6, Q7, Q9, Q13, Q16, Q17, Q19, Q21, Q22, Q23 -->
  <field name="d_date_sk" size="19" type="BIGINT" primary="true">
    <gen_IdGenerator> <min>${SK_ID_OFFSET}</min> </gen_IdGenerator>
  </field>
  
  <field name="d_date_id" size="16" type="CHAR" primary="false">
   <gen_ConvertNumberToStringGenerator>
    <gen_IdGenerator/>
    <size>16.0</size>
    <characters>ABCDEFGHIJKLMNOPQRSTUVWXYZ</characters>
   </gen_ConvertNumberToStringGenerator>
  </field>
  
  <!-- used by Q4, Q16, Q19, Q22 -->
  <field name="d_date" size="13" type="CHAR" primary="false">
   <gen_DateTimeGenerator>
     <disableRng>true</disableRng>
     <useFixedStepSize>true</useFixedStepSize>
     <startDate>${date_dim_begin_date}</startDate>
     <endDate>${date_dim_end_date}</endDate>
     <outputFormat>yyyy-MM-dd</outputFormat>
    </gen_DateTimeGenerator>
  </field>
  
  <!-- used by Q7 -->
  <field name="d_month_seq" size="10" type="INTEGER" primary="false">
    <gen_DetailFromDateGenerator>
     <reference field="d_date" />
     <outputFormat>'MONTH_SEQUENCE'</outputFormat>
     <startDate>${date_dim_begin_date}</startDate>
    </gen_DetailFromDateGenerator>
  </field>
  
  <!-- used by Q19 -->
  <field name="d_week_seq" size="10" type="INTEGER" primary="false">
    <gen_DetailFromDateGenerator>
     <reference field="d_date" />
     <outputFormat>'WEEK_SEQUENCE'</outputFormat>
    </gen_DetailFromDateGenerator>
  </field>
  
  <field name="d_quarter_seq" size="10" type="INTEGER" primary="false">
    <gen_DetailFromDateGenerator>
     <reference field="d_date" />
     <outputFormat>'QUARTER_SEQUENCE'</outputFormat>
     <startDate>${date_dim_begin_date}</startDate>
    </gen_DetailFromDateGenerator>
  </field>
  
  <!-- used by Q6, Q7, Q9, Q13, Q17, Q21, Q23 -->
  <field name="d_year" size="10" type="INTEGER" primary="false">
   <gen_DateTimeGenerator>
    <disableRng>true</disableRng>
    <useFixedStepSize>true</useFixedStepSize>
    <startDate>${date_dim_begin_date}</startDate>
    <endDate>${date_dim_end_date}</endDate>
    <outputFormat>yyyy</outputFormat>
   </gen_DateTimeGenerator>
  </field>
  
  <field name="d_dow" size="10" type="INTEGER" primary="false">
   <gen_DetailFromDateGenerator>
    <reference field="d_date" />
    <outputFormat>'DAY_OF_WEEK_NUM'</outputFormat>
   </gen_DetailFromDateGenerator>
  </field>
  
  <!-- used by Q7, Q17, Q21, Q23 -->
  <field name="d_moy" size="10" type="INTEGER" primary="false">
   <gen_DateTimeGenerator>
    <disableRng>true</disableRng>
    <useFixedStepSize>true</useFixedStepSize>
    <startDate>${date_dim_begin_date}</startDate>
    <endDate>${date_dim_end_date}</endDate>
    <outputFormat>M</outputFormat>
   </gen_DateTimeGenerator>
  </field>
  
  <field name="d_dom" size="10" type="INTEGER" primary="false">
   <gen_DateTimeGenerator>
    <disableRng>true</disableRng>
    <useFixedStepSize>true</useFixedStepSize>
    <startDate>${date_dim_begin_date}</startDate>
    <endDate>${date_dim_end_date}</endDate>
    <outputFormat>d</outputFormat>
   </gen_DateTimeGenerator>
  </field>
  
  <field name="d_qoy" size="10" type="INTEGER" primary="false">
    <gen_DetailFromDateGenerator>
     <reference field="d_date" />
     <outputFormat>'QUARTER_OF_YEAR'</outputFormat>
    </gen_DetailFromDateGenerator>
  </field>
  
  <field name="d_fy_year" size="10" type="INTEGER" primary="false">
    <gen_DateTimeGenerator>
     <disableRng>true</disableRng>
     <useFixedStepSize>true</useFixedStepSize>
     <startDate>${date_dim_begin_date}</startDate>
     <endDate>${date_dim_end_date}</endDate>
     <outputFormat>yyyy</outputFormat>
    </gen_DateTimeGenerator>
  </field>
  
  <field name="d_fy_quarter_seq" size="10" type="INTEGER" primary="false">
    <gen_DetailFromDateGenerator>
     <reference field="d_date" />
     <outputFormat>'QUARTER_SEQUENCE'</outputFormat>
     <startDate>${date_dim_begin_date}</startDate>
    </gen_DetailFromDateGenerator>
  </field>
  
  <field name="d_fy_week_seq" size="10" type="INTEGER" primary="false">
    <gen_DetailFromDateGenerator>
     <reference field="d_date" />
     <outputFormat>'WEEK_SEQUENCE'</outputFormat>
    </gen_DetailFromDateGenerator>
  </field>
  
  <field name="d_day_name" size="9" type="CHAR" primary="false">
   <gen_DateTimeGenerator>
    <disableRng>true</disableRng>
    <useFixedStepSize>true</useFixedStepSize>
    <startDate>${date_dim_begin_date}</startDate>
    <endDate>${date_dim_end_date}</endDate>
    <outputFormat>EEEE</outputFormat>
   </gen_DateTimeGenerator>
  </field>
  
  <field name="d_quarter_name" size="6" type="CHAR" primary="false">
    <gen_DetailFromDateGenerator>
     <reference field="d_date" />
     <outputFormat>yyyy'QQUARTER_OF_YEAR'</outputFormat>
   </gen_DetailFromDateGenerator>
  </field>
  
  <field name="d_holiday" size="1" type="CHAR" primary="false">
   <gen_IFGenerator>
    <if><!-- ((Boolean)generator[0]).booleanValue() --></if>
      <gen_DetailFromDateGenerator>
       <reference field="d_date" />
       <outputFormat>'IS_HOLIDAY'</outputFormat>
       <startDate>${date_dim_begin_date}</startDate>
      </gen_DetailFromDateGenerator>
    
    <then>
     <gen_StaticValueGenerator>
      <value>Y</value>
     </gen_StaticValueGenerator>
    </then>
    <else>
     <gen_StaticValueGenerator>
      <value>Y</value>
     </gen_StaticValueGenerator>
    </else>
   </gen_IFGenerator>
  </field>
  
  <field name="d_weekend" size="1" type="CHAR" primary="false">
   <gen_IFGenerator>
    <if><!-- ((Boolean)generator[0]).booleanValue() --></if>
      <gen_DetailFromDateGenerator>
       <reference field="d_date" />
       <outputFormat>'IS_WEEK_DAY'</outputFormat>
       <startDate>${date_dim_begin_date}</startDate>
      </gen_DetailFromDateGenerator>
    
    <then>
     <gen_StaticValueGenerator>
      <value>N</value>
     </gen_StaticValueGenerator>
    </then>
    <else>
     <gen_StaticValueGenerator>
      <value>Y</value>
     </gen_StaticValueGenerator>
    </else>
   </gen_IFGenerator>
  </field>
  
  <field name="d_following_holiday" size="1" type="CHAR" primary="false">
    <gen_RandomAString>
     <min>1.0</min>
     <max>1.0</max>
     <characters>NY</characters>
    </gen_RandomAString>
  </field>
  
  <field name="d_first_dom" size="10" type="INTEGER" primary="false">
    <gen_LongGenerator>
     <min>2415021.0</min>
     <max>2488070.0</max>
    </gen_LongGenerator>
  </field>
  
  <field name="d_last_dom" size="10" type="INTEGER" primary="false">
    <gen_LongGenerator>
     <min>2415020.0</min>
     <max>2488372.0</max>
    </gen_LongGenerator>
  </field>
  
  <field name="d_same_day_ly" size="10" type="INTEGER" primary="false">
    <gen_LongGenerator>
     <min>2414657.0</min>
     <max>2487705.0</max>
    </gen_LongGenerator>
  </field>
  
  <field name="d_same_day_lq" size="10" type="INTEGER" primary="false">
    <gen_LongGenerator>
     <min>2414930.0</min>
     <max>2487978.0</max>
    </gen_LongGenerator>
  </field>
  
  <field name="d_current_day" size="1" type="CHAR" primary="false">
   <gen_IFGenerator>
    <if><!-- ((Number)generator[0]).longValue()==${CURRENT_DAY} --></if>
      <gen_OtherFieldValueGenerator>
       <reference field="d_date" />
      </gen_OtherFieldValueGenerator>
    
    <then>
     <gen_StaticValueGenerator>
      <value>Y</value>
     </gen_StaticValueGenerator>
    </then>
    <else>
     <gen_StaticValueGenerator>
      <value>N</value>
     </gen_StaticValueGenerator>
    </else>
   </gen_IFGenerator>
  </field>
  
  <field name="d_current_week" size="1" type="CHAR" primary="false">
   <gen_IFGenerator>
    <if><!-- ((Number)generator[0]).longValue()==${CURRENT_DAY} --></if>
      <gen_OtherFieldValueGenerator>
       <reference field="d_date" />
      </gen_OtherFieldValueGenerator>
    
    <then>
     <gen_StaticValueGenerator>
      <value>Y</value>
     </gen_StaticValueGenerator>
    </then>
    <else>
     <gen_StaticValueGenerator>
      <value>N</value>
     </gen_StaticValueGenerator>
    </else>
   </gen_IFGenerator>
  </field>
  
  <field name="d_current_month" size="1" type="CHAR" primary="false">
   <gen_IFGenerator>
    <if><!-- ((Number)generator[0]).longValue()==${CURRENT_DAY} --></if>
      <gen_OtherFieldValueGenerator>
       <reference field="d_date" />
      </gen_OtherFieldValueGenerator>
    
    <then>
     <gen_StaticValueGenerator>
      <value>Y</value>
     </gen_StaticValueGenerator>
    </then>
    <else>
     <gen_StaticValueGenerator>
      <value>N</value>
     </gen_StaticValueGenerator>
    </else>
   </gen_IFGenerator>
  </field>
  
  <field name="d_current_quarter" size="1" type="CHAR" primary="false">
   <gen_IFGenerator>
    <if><!-- ((Number)generator[0]).longValue()==${CURRENT_DAY} --></if>
      <gen_OtherFieldValueGenerator>
       <reference field="d_date" />
      </gen_OtherFieldValueGenerator>
    
    <then>
     <gen_StaticValueGenerator>
      <value>Y</value>
     </gen_StaticValueGenerator>
    </then>
    <else>
     <gen_StaticValueGenerator>
      <value>N</value>
     </gen_StaticValueGenerator>
    </else>
   </gen_IFGenerator>
  </field>
  
  <field name="d_current_year" size="1" type="CHAR" primary="false">
   <gen_IFGenerator>
    <if><!-- ((Number)generator[0]).longValue()==${CURRENT_DAY} --></if>
      <gen_OtherFieldValueGenerator>
       <reference field="d_date" />
      </gen_OtherFieldValueGenerator>
    
    <then>
     <gen_StaticValueGenerator>
      <value>Y</value>
     </gen_StaticValueGenerator>
    </then>
    <else>
     <gen_StaticValueGenerator>
      <value>N</value>
     </gen_StaticValueGenerator>
    </else>
   </gen_IFGenerator>
   </field>
 </table>


<!-- Each row in this table represents one second -->
 <table name="time_dim">
  <size>${time_dim_size}</size>
  
  <!-- used by Q4, Q14 -->
  <field name="t_time_sk" size="19" type="BIGINT" primary="true">
  <gen_IdGenerator> <min>${SK_ID_OFFSET}</min> </gen_IdGenerator>
  </field>
  
  <field name="t_time_id" size="16" type="CHAR" primary="false">
   <gen_ConvertNumberToStringGenerator>
    <gen_IdGenerator/>
    <size>16.0</size>
    <characters>ABCDEFGHIJKLMNOPQRSTUVWXYZ</characters>
   </gen_ConvertNumberToStringGenerator>
  </field>
  
  <!-- used by Q4 -->
  <field name="t_time" size="10" type="INTEGER" primary="false">
   <gen_IdGenerator />
  </field>
  
  <!-- used by Q14 -->
  <field name="t_hour" size="10" type="INTEGER" primary="false">
   <gen_DateTimeGenerator>
    <disableRng>true</disableRng>
    <useFixedStepSize>true</useFixedStepSize>
    <startDate>2000-01-01 00:00:00</startDate>
    <endDate>2000-01-02 00:00:00</endDate>
    <outputFormat>H</outputFormat>
   </gen_DateTimeGenerator>
  </field>
  
  <field name="t_minute" size="10" type="INTEGER" primary="false">
   <gen_DateTimeGenerator>
    <disableRng>true</disableRng>
    <useFixedStepSize>true</useFixedStepSize>
    <startDate>2000-01-01 00:00:00</startDate>
    <endDate>2000-01-02 00:00:00</endDate>
    <outputFormat>m</outputFormat>
   </gen_DateTimeGenerator>
  </field>
  
  <field name="t_second" size="10" type="INTEGER" primary="false">
   <gen_DateTimeGenerator>
    <disableRng>true</disableRng>
    <useFixedStepSize>true</useFixedStepSize>
    <startDate>2000-01-01 00:00:00</startDate>
    <endDate>2000-01-02 00:00:00</endDate>
    <outputFormat>s</outputFormat>
   </gen_DateTimeGenerator>
  </field>
  
  <field name="t_am_pm" size="2" type="CHAR" primary="false">
  <gen_IFGenerator>
    <if><!--generator[0].toString().length()>1 && generator[0].toString().compareTo("12")>=0; --></if>
      <gen_OtherFieldValueGenerator>
       <reference field="t_hour" />
      </gen_OtherFieldValueGenerator>
    
    <then>
     <gen_StaticValueGenerator>
      <value>PM</value>
     </gen_StaticValueGenerator>
    </then>
    <else>
     <gen_StaticValueGenerator>
      <value>AM</value>
     </gen_StaticValueGenerator>
    </else>
   </gen_IFGenerator>
  </field>
  
  <field name="t_shift" size="20" type="CHAR" primary="false">
   <gen_SwitchGenerator>
    
    <gen_OtherFieldValueGenerator>
     <reference field="t_hour" />
    </gen_OtherFieldValueGenerator>        
    
    <case value="0">
     <gen_StaticValueGenerator><value>third</value></gen_StaticValueGenerator>
    </case>
    <case value="1">
     <gen_StaticValueGenerator><value>third</value></gen_StaticValueGenerator>
    </case>
    <case value="2">
     <gen_StaticValueGenerator><value>third</value></gen_StaticValueGenerator>
    </case>
    <case value="3">
     <gen_StaticValueGenerator><value>third</value></gen_StaticValueGenerator>
    </case>
    <case value="4">
     <gen_StaticValueGenerator><value>third</value></gen_StaticValueGenerator>
    </case>
    <case value="5">
     <gen_StaticValueGenerator><value>third</value></gen_StaticValueGenerator>
    </case>
    <case value="6">
     <gen_StaticValueGenerator><value>third</value></gen_StaticValueGenerator>
    </case>
    <case value="7">
     <gen_StaticValueGenerator><value>first</value></gen_StaticValueGenerator>
    </case>
    <case value="8">
     <gen_StaticValueGenerator><value>first</value></gen_StaticValueGenerator>
    </case>
    <case value="9">
     <gen_StaticValueGenerator><value>first</value></gen_StaticValueGenerator>
    </case>
    <case value="10">
     <gen_StaticValueGenerator><value>first</value></gen_StaticValueGenerator>
    </case>
    <case value="11">
     <gen_StaticValueGenerator><value>first</value></gen_StaticValueGenerator>
    </case>
    <case value="12">
     <gen_StaticValueGenerator><value>first</value></gen_StaticValueGenerator>
    </case>
    <case value="13">
     <gen_StaticValueGenerator><value>first</value></gen_StaticValueGenerator>
    </case>
    <case value="14">
     <gen_StaticValueGenerator><value>first</value></gen_StaticValueGenerator>
    </case>
    <case value="15">
     <gen_StaticValueGenerator><value>second</value></gen_StaticValueGenerator>
    </case>
    <case value="16">
     <gen_StaticValueGenerator><value>second</value></gen_StaticValueGenerator>
    </case>
    <case value="17">
     <gen_StaticValueGenerator><value>second</value></gen_StaticValueGenerator>
    </case>
    <case value="18">
     <gen_StaticValueGenerator><value>second</value></gen_StaticValueGenerator>
    </case>
    <case value="19">
     <gen_StaticValueGenerator><value>second</value></gen_StaticValueGenerator>
    </case>
    <case value="20">
     <gen_StaticValueGenerator><value>second</value></gen_StaticValueGenerator>
    </case>
    <case value="21">
     <gen_StaticValueGenerator><value>second</value></gen_StaticValueGenerator>
    </case>
    <case value="22">
     <gen_StaticValueGenerator><value>second</value></gen_StaticValueGenerator>
    </case>
    <case value="23">
     <gen_StaticValueGenerator><value>third</value></gen_StaticValueGenerator>
    </case>
   </gen_SwitchGenerator>
  </field>
  
  <field name="t_sub_shift" size="20" type="CHAR" primary="false">
   <gen_SwitchGenerator>
    <gen_OtherFieldValueGenerator>
     <reference field="t_hour" />
    </gen_OtherFieldValueGenerator>        
    <case value="0">
     <gen_StaticValueGenerator><value>night</value></gen_StaticValueGenerator>
    </case>
    <case value="1">
     <gen_StaticValueGenerator><value>night</value></gen_StaticValueGenerator>
    </case>
    <case value="2">
     <gen_StaticValueGenerator><value>night</value></gen_StaticValueGenerator>
    </case>
    <case value="3">
     <gen_StaticValueGenerator><value>night</value></gen_StaticValueGenerator>
    </case>
    <case value="4">
     <gen_StaticValueGenerator><value>night</value></gen_StaticValueGenerator>
    </case>
    <case value="5">
     <gen_StaticValueGenerator><value>night</value></gen_StaticValueGenerator>
    </case>
    <case value="6">
     <gen_StaticValueGenerator><value>morning</value></gen_StaticValueGenerator>
    </case>
    <case value="7">
     <gen_StaticValueGenerator><value>morning</value></gen_StaticValueGenerator>
    </case>
    <case value="8">
     <gen_StaticValueGenerator><value>morning</value></gen_StaticValueGenerator>
    </case>
    <case value="9">
     <gen_StaticValueGenerator><value>morning</value></gen_StaticValueGenerator>
    </case>
    <case value="10">
     <gen_StaticValueGenerator><value>morning</value></gen_StaticValueGenerator>
    </case>
    <case value="11">
     <gen_StaticValueGenerator><value>morning</value></gen_StaticValueGenerator>
    </case>
    <case value="12">
     <gen_StaticValueGenerator><value>afternoon</value></gen_StaticValueGenerator>
    </case>
    <case value="13">
     <gen_StaticValueGenerator><value>afternoon</value></gen_StaticValueGenerator>
    </case>
    <case value="14">
     <gen_StaticValueGenerator><value>afternoon</value></gen_StaticValueGenerator>
    </case>
    <case value="15">
     <gen_StaticValueGenerator><value>afternoon</value></gen_StaticValueGenerator>
    </case>
    <case value="16">
     <gen_StaticValueGenerator><value>afternoon</value></gen_StaticValueGenerator>
    </case>
    <case value="17">
     <gen_StaticValueGenerator><value>evening</value></gen_StaticValueGenerator>
    </case>
    <case value="18">
     <gen_StaticValueGenerator><value>evening</value></gen_StaticValueGenerator>
    </case>
    <case value="19">
     <gen_StaticValueGenerator><value>evening</value></gen_StaticValueGenerator>
    </case>
    <case value="20">
     <gen_StaticValueGenerator><value>evening</value></gen_StaticValueGenerator>
    </case>
    <case value="21">
     <gen_StaticValueGenerator><value>evening</value></gen_StaticValueGenerator>
    </case>
    <case value="22">
     <gen_StaticValueGenerator><value>evening</value></gen_StaticValueGenerator>
    </case>
    <case value="23">
     <gen_StaticValueGenerator><value>evening</value></gen_StaticValueGenerator>
    </case>
   </gen_SwitchGenerator>
  </field>
  
  
  <field name="t_meal_time" size="20" type="CHAR" primary="false" nullable="true">
   <gen_SwitchGenerator>
    <gen_OtherFieldValueGenerator>
     <reference field="t_hour" />
    </gen_OtherFieldValueGenerator>        
    <case value="0">
   <gen_StaticValueGenerator><value></value></gen_StaticValueGenerator>
    </case>
    <case value="1">
     <gen_StaticValueGenerator><value></value></gen_StaticValueGenerator>
    </case>
    <case value="2">
     <gen_StaticValueGenerator><value></value></gen_StaticValueGenerator>
    </case>
    <case value="3">
     <gen_StaticValueGenerator><value></value></gen_StaticValueGenerator>
    </case>
    <case value="4">
     <gen_StaticValueGenerator><value></value></gen_StaticValueGenerator>
    </case>
    <case value="5">
     <gen_StaticValueGenerator><value></value></gen_StaticValueGenerator>
    </case>
    <case value="6">
     <gen_StaticValueGenerator><value>breakfast</value></gen_StaticValueGenerator>
    </case>
    <case value="7">
     <gen_StaticValueGenerator><value>breakfast</value></gen_StaticValueGenerator>
    </case>
    <case value="8">
     <gen_StaticValueGenerator><value>breakfast</value></gen_StaticValueGenerator>
    </case>
    <case value="9">
     <gen_StaticValueGenerator><value>breakfast</value></gen_StaticValueGenerator>
    </case>
    <case value="10">
     <gen_StaticValueGenerator><value></value></gen_StaticValueGenerator>
    </case>
    <case value="11">
     <gen_StaticValueGenerator><value></value></gen_StaticValueGenerator>
    </case>
    <case value="12">
     <gen_StaticValueGenerator><value>lunch</value></gen_StaticValueGenerator>
    </case>
    <case value="13">
     <gen_StaticValueGenerator><value>lunch</value></gen_StaticValueGenerator>
    </case>
    <case value="14">
     <gen_StaticValueGenerator><value>lunch</value></gen_StaticValueGenerator>
    </case>
    <case value="15">
     <gen_StaticValueGenerator><value></value></gen_StaticValueGenerator>
    </case>
    <case value="16">
     <gen_StaticValueGenerator><value></value></gen_StaticValueGenerator>
    </case>
    <case value="17">
     <gen_StaticValueGenerator><value>dinner</value></gen_StaticValueGenerator>
    </case>
    <case value="18">
     <gen_StaticValueGenerator><value>dinner</value></gen_StaticValueGenerator>
    </case>
    <case value="19">
     <gen_StaticValueGenerator><value>dinner</value></gen_StaticValueGenerator>
    </case>
    <case value="20">
     <gen_StaticValueGenerator><value></value></gen_StaticValueGenerator>
    </case>
    <case value="21">
     <gen_StaticValueGenerator><value></value></gen_StaticValueGenerator>
    </case>
    <case value="22">
     <gen_StaticValueGenerator><value></value></gen_StaticValueGenerator>
    </case>
    <case value="23">
     <gen_StaticValueGenerator><value></value></gen_StaticValueGenerator>
    </case>
   </gen_SwitchGenerator>
  </field>
 </table>


 <!-- The customer demographics table contains one row for each unique combination of customer demographic information -->
 <table name="customer_demographics">
  <size>${customer_demographics_size}</size>
  
  <!-- used by Q5, Q8, Q9 -->
  <field name="cd_demo_sk" size="19" type="BIGINT" primary="true">
   <gen_IdGenerator />
  </field>
  
  <!-- used by Q5 -->
  <field name="cd_gender" size="1" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="gender" valueColumn="0" weightColumn="0" />
   </gen_NullGenerator>
  </field>
  
  <!-- used by Q9 -->
  <field name="cd_marital_status" size="1" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="marital_status" valueColumn="0" weightColumn="0" />
   </gen_NullGenerator>
  </field>
  
  <!-- used by Q5, Q9 -->
  <field name="cd_education_status" size="20" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="education" valueColumn="0" weightColumn="0" />
   </gen_NullGenerator>
  </field>
  
  <field name="cd_purchase_estimate" size="10" type="INTEGER" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="purchase_band" valueColumn="0" weightColumn="0" />
   </gen_NullGenerator>
  </field>
  
  <field name="cd_credit_rating" size="10" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="credit_rating" valueColumn="0" weightColumn="0" />
   </gen_NullGenerator>
  </field>
  
  <field name="cd_dep_count" size="10" type="INTEGER" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="dependent_count" valueColumn="0" weightColumn="0" />
   </gen_NullGenerator>
  </field>
  
  <field name="cd_dep_employed_count" size="10" type="INTEGER" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
   <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="dependent_count" valueColumn="0" weightColumn="0" />
   </gen_NullGenerator>
  </field>
  
  <field name="cd_dep_college_count" size="10" type="INTEGER" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
   <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="dependent_count" valueColumn="0" weightColumn="0" />
   </gen_NullGenerator>
  </field>
 </table>
 
 
 
 
 
 <!-- Each row of this table defines a household demographic profile -->
 <table name="household_demographics">
  <size>${household_demographics_size}</size>
  
  <!-- used by Q14 -->
  <field name="hd_demo_sk" size="19" type="BIGINT" primary="true">
   <gen_IdGenerator />
  </field>
  
  <!-- FK ib_income_band_sk -->
  <field name="hd_income_band_sk" size="19" type="BIGINT" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_ReferenceGenerator choose="random" from="historical">
     <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="income_band" field="ib_income_band_sk" />
    </gen_ReferenceGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="hd_buy_potential" size="15" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="buy_potential" valueColumn="0" weightColumn="0" />
   </gen_NullGenerator>
  </field>
  
  <!-- used by Q14 -->
  <field name="hd_dep_count" size="10" type="INTEGER" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="dependent_count" valueColumn="0" weightColumn="0" />
   </gen_NullGenerator>
  </field>
  
  <field name="hd_vehicle_count" size="10" type="INTEGER" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="vehicle_count" valueColumn="0" weightColumn="0" />
   </gen_NullGenerator>
  </field>
 </table>
 



 <!-- Each row in this dimension table represents a customer -->
 <table name="customer">
  <size>${customer_size}</size>
  
  <!-- used by Q5, Q6, Q7, Q13, Q17 -->
  <field name="c_customer_sk" size="19" type="BIGINT" primary="true">
  <gen_IdGenerator> <min>${SK_ID_OFFSET}</min> </gen_IdGenerator>
  </field>
  
  <!-- used by Q6, Q13 -->
  <field name="c_customer_id" size="16" type="CHAR" primary="false">
   <gen_ConvertNumberToStringGenerator>
    <gen_IdGenerator/>
    <size>16.0</size>
    <characters>ABCDEFGHIJKLMNOPQRSTUVWXYZ</characters>
   </gen_ConvertNumberToStringGenerator>
  </field>
  
  <!-- used by Q5 -->
  <!-- FK cd_demo_sk -->
  <field name="c_current_cdemo_sk" size="19" type="BIGINT" primary="false" nullable="true">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_ReferenceGenerator choose="random" from="historical">
     <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer_demographics" field="cd_demo_sk" >
       <!-- 
       <maxID>0;
          pdgf.core.dbSchema.Table refTable=((pdgf.core.dbSchema.Reference)getParent()).getRefTable();
          pdgf.core.dataGenerator.beans.WorkUnit wu= refTable.getScheduler().getPartitioner().getPrePartition(getParentProject(), refTable);
          long maxID=wu.rowStop;
          result=maxID;
          
          if(${DEBUG_REFRESH}>0){
               System.out.println("##################\nReference: "+getParent() );
            System.out.println("refTable size :" + refTable.getSize());
            System.out.println("maxID: " + maxID);
            System.out.println("################");
          } 
       </maxID>
       -->
     </reference>
    </gen_ReferenceGenerator>
   </gen_NullGenerator>
  </field>
  
  <!-- FK hd_demo_sk -->
  <field name="c_current_hdemo_sk" size="19" type="BIGINT" primary="false" nullable="true">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_ReferenceGenerator choose="random" from="historical">
     <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="household_demographics" field="hd_demo_sk" />
    </gen_ReferenceGenerator>
   </gen_NullGenerator>
  </field>
  
  <!-- used by Q7, Q17 -->
  <!-- FK ca_address_sk -->
  <field name="c_current_addr_sk" size="19" type="BIGINT" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_ReferenceGenerator choose="random" from="historical">
     <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer_address" field="ca_address_sk" />
    </gen_ReferenceGenerator>
   </gen_NullGenerator>
  </field>
  
  <!-- FK d_date_sk -->
  <field name="c_first_shipto_date_sk" size="19" type="BIGINT" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_ReferenceGenerator choose="random" from="historical">
     <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="date_dim" field="d_date_sk" />
    </gen_ReferenceGenerator>
   </gen_NullGenerator>
  </field>
  
  <!-- FK d_date_sk -->
  <field name="c_first_sales_date_sk" size="19" type="BIGINT" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_ReferenceGenerator choose="random" from="historical">
     <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="date_dim" field="d_date_sk" />
    </gen_ReferenceGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="c_salutation" size="10" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_TemplateGenerator>
     <getValue><!--            
      pdgf.generator.WeightedListGenerator$WeightedListWriteable w = (pdgf.generator.WeightedListGenerator$WeightedListWriteable)(generator[0].getValue());
      long plainWeight=w.getWl().getPlainWeightValue(1, w.getChoice());
      if(plainWeight==0L){
       fvdto.setBothValues(generator[1].getValue());
      }else{
       fvdto.setBothValues(generator[2].getValue());
      }
     --></getValue>
     
     <!-- generator[0]-->
     <gen_OtherFieldValueGenerator>
       <reference field="c_first_name" />
     </gen_OtherFieldValueGenerator>
     <!-- generator[1]-->
     <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="salutations" valueColumn="0" weightColumn="1" />
     <!-- generator[2]-->
     <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="salutations" valueColumn="0" weightColumn="2" />
    </gen_TemplateGenerator>  
   </gen_NullGenerator>
  </field>
  
  <!-- used by Q6, Q13 -->
  <field name="c_first_name" size="20" type="CHAR" primary="false">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="first_names" valueColumn="name" weightColumn="unified" id="genderChooser"/>
  </field>
  
  <!-- used by Q6, Q13 -->
  <field name="c_last_name" size="30" type="CHAR" primary="false">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="last_names" valueColumn="0" weightColumn="0" />
  </field>
  
  <!-- used by Q6 -->
  <field name="c_preferred_cust_flag" size="1" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_ProbabilityGenerator>
     <probability value="${preferred_cust_likelihood}">
      <gen_StaticValueGenerator>
       <value>Y</value>
      </gen_StaticValueGenerator>
     </probability>
     <probability value="1 - ${preferred_cust_likelihood}">
      <gen_StaticValueGenerator>
       <value>N</value>
      </gen_StaticValueGenerator>
     </probability>
    </gen_ProbabilityGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="c_birth_day" size="10" type="INTEGER" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_LongGenerator>
     <min>1.0</min>
     <max>31.0</max>
    </gen_LongGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="c_birth_month" size="10" type="INTEGER" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_LongGenerator>
     <min>1.0</min>
     <max>12.0</max>
    </gen_LongGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="c_birth_year" size="10" type="INTEGER" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_LongGenerator>
     <min>1924.0</min>
     <max>1992.0</max>
    </gen_LongGenerator>
   </gen_NullGenerator>
  </field>
  
  <!-- used by Q6 -->
  <field name="c_birth_country" size="20" type="VARCHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="countries" valueColumn="0" weightColumn="0" />
   </gen_NullGenerator>
  </field>
  
  <!-- used by Q6 -->
  <field name="c_login" size="13" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_RandomAString>
     <min>1.0</min>
     <max>13.0</max>
    </gen_RandomAString>
   </gen_NullGenerator>
  </field>
  
  <!-- used by Q6 -->
  <field name="c_email_address" size="50" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_EmailGenerator>
     <file>dicts/mail_provider.dict</file>
     <reference id="lastname" field="c_last_name"/>
     <reference id="firstname" field="c_first_name"/>
    </gen_EmailGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="c_last_review_date" size="19" type="VARCHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_RandomAString>
     <min>1.0</min>
     <max>10.0</max>
    </gen_RandomAString>
   </gen_NullGenerator>
  </field>
 </table>
 
 
 <!-- Each row in this table represents a unique customer address (each customer can have more than one address) -->
 <table name="customer_address">
  <size>${customer_address_size}</size>
  
  <!-- used by Q7, Q9, Q17 -->
  <field name="ca_address_sk" size="19" type="BIGINT" primary="true">
  <gen_IdGenerator> <min>${SK_ID_OFFSET}</min> </gen_IdGenerator>
  </field>
  
  <field name="ca_address_id" size="16" type="CHAR" primary="false">
   <gen_ConvertNumberToStringGenerator>
    <gen_IdGenerator/>
    <size>16.0</size>
    <characters>ABCDEFGHIJKLMNOPQRSTUVWXYZ</characters>
   </gen_ConvertNumberToStringGenerator>
  </field>
  
  <field name="ca_street_number" size="10" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_LongGenerator>
     <min>${address_street_number_min}</min>
     <max>${address_street_number_max}</max>
    </gen_LongGenerator>
   </gen_NullGenerator>
  </field>

  <field name="ca_street_name" size="60" type="VARCHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_TemplateGenerator>
     <getValue><!-- String streetName= (rng.nextDouble()>0.5 ? (generator[0].toString() + " " + generator[1].toString()):  generator[1].toString());
                    fvdto.setBothValues(streetName); 
     --></getValue>
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="street_names" valueColumn="0" weightColumn="0" />
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="street_names" valueColumn="0" weightColumn="0" />
    </gen_TemplateGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="ca_street_type" size="15" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="street_type" valueColumn="0" weightColumn="0" />
   </gen_NullGenerator>
  </field>
  
  <field name="ca_suite_number" size="10" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_RandomAString>
     <min>${address_suite_number_min}</min>
     <max>${address_suite_number_max}</max>
    </gen_RandomAString>
   </gen_NullGenerator>
  </field>
  
  <field name="ca_city" size="60" type="VARCHAR" primary="false">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="cities" valueColumn="0" weightColumn="0" />
  </field>
  
  <!-- used by Q9 -->
  <field name="ca_county" size="30" type="VARCHAR" primary="false">
    <gen_WeightedListGenerator id="countyChooser" filename="dicts/bigbench/ds-genProbabilities.txt" list="fips_county" valueColumn="county" weightColumn="uniform" />
  </field>
  
  <!-- used by Q7, Q9 -->
  <field name="ca_state" size="2" type="CHAR" primary="false">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="fips_county" valueColumn="st" weightColumn="uniform">
     <sameChoiceAs field="ca_county" generatorByID="countyChooser"/>
    </gen_WeightedListGenerator>
  </field>
  
  <field name="ca_zip" size="10" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_LongGenerator>
     <min>${address_zip_min}</min>
     <max>${address_zip_max}</max>
    </gen_LongGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="ca_country" size="20" type="VARCHAR" primary="false">
    <gen_StaticValueGenerator>
     <value>United States</value>
    </gen_StaticValueGenerator>
  </field>
  
  <!-- used by Q17 -->
  <!-- decimalSize="5,2"-->
  <field name="ca_gmt_offset" size="5" type="NUMERIC" primary="false">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="fips_county" valueColumn="gmt" weightColumn="uniform">
     <sameChoiceAs field="ca_county" generatorByID="countyChooser"/>
    </gen_WeightedListGenerator>
  </field>
  
  <field name="ca_location_type" size="20" type="CHAR" primary="false">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="location_type" valueColumn="0" weightColumn="0" />
  </field>
 </table>
 
 

 
 <!-- Each row in this table represents the quantity of a particular item on-hand at a given warehouse during a specific week -->
 <table name="inventory">
  <size>${inventory_size}</size>
  
  <!-- used by Q22, Q23 -->
  <!-- FK d_date_sk -->
  <field name="inv_date_sk" size="19" type="BIGINT" primary="true">
   <gen_FormulaGenerator>
    <formula>((long) gc.getID() / (long) ${item_size} / (long) ${warehouse_size}) * 7 + (long) ${inventory_days_since_date_begin_date}</formula>
    <decimalPlaces>0</decimalPlaces>
   </gen_FormulaGenerator>
   <!--
   <gen_ReferenceGenerator choose="random" from="historical">
     <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="date_dim" field="d_date_sk" />
   </gen_ReferenceGenerator>
   -->
  </field>
  
  <!-- used by Q22, Q23 -->
  <!-- FK i_item_sk -->
  <field name="inv_item_sk" size="19" type="BIGINT" primary="true">
   <gen_FormulaGenerator>
    <formula>(long) gc.getID() % (long) ${item_size}</formula>
    <decimalPlaces>0</decimalPlaces>
   </gen_FormulaGenerator>
   <!--
   <gen_ReferenceGenerator choose="random" from="historical">
    <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="item" field="i_item_sk" />
   </gen_ReferenceGenerator>
   -->
  </field>
  
  <!-- used by Q22, Q23 -->
  <!-- FK w_warehouse_sk -->
  <field name="inv_warehouse_sk" size="19" type="BIGINT" primary="true">
   <gen_FormulaGenerator>
    <formula>((long) gc.getID() / (long) ${item_size}) % (long) ${warehouse_size}</formula>
    <decimalPlaces>0</decimalPlaces>
   </gen_FormulaGenerator>
   <!--
   <gen_ReferenceGenerator choose="random" from="historical">
    <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="warehouse" field="w_warehouse_sk" />
   </gen_ReferenceGenerator>
   -->
  </field>
  
  <!-- used by Q22, Q23 -->
  <field name="inv_quantity_on_hand" size="10" type="INTEGER" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_LongGenerator>
     <min>0.0</min>
     <max>1000.0</max>
    </gen_LongGenerator>
   </gen_NullGenerator>
  </field>
 </table>
 
 
 <!-- Each row in this table represents a unique product formulation (e.g., size, color, manufacturer, etc.) -->
 <table name="item">
  <size>${item_size}</size>
  
  <!-- used by Q5, Q7, Q12, Q15, Q16, Q17, Q19, Q21, Q22, Q23, Q24, Q26, Q29, Q30 -->
  <field name="i_item_sk" size="19" type="BIGINT" primary="true">
  <gen_IdGenerator> <min>${SK_ID_OFFSET}</min> </gen_IdGenerator>
  </field>
  
  <!-- used by Q16, Q21, Q22 -->
  <field name="i_item_id" size="16" type="CHAR" primary="false">
   <gen_ConvertNumberToStringGenerator>
    <gen_IdGenerator/>
    <size>16.0</size>
    <characters>ABCDEFGHIJKLMNOPQRSTUVWXYZ</characters>
   </gen_ConvertNumberToStringGenerator>
  </field>
  
  <field name="i_rec_start_date" size="13" type="CHAR" primary="false">
    <gen_DateTimeGenerator>
     <useFixedStepSize>true</useFixedStepSize>
     <startDate>${item_begin_date}</startDate>
     <endDate>${inventory_begin_date}</endDate>
     <outputFormat>yyyy-MM-dd</outputFormat>
    </gen_DateTimeGenerator>
  </field>
  
  <field name="i_rec_end_date" size="13" type="CHAR" primary="false"  nullable="true">
   <!-- all items are active for the moment => NULL -->
   <gen_StaticValueGenerator>
    <value></value>
   </gen_StaticValueGenerator>
   <!--
   <gen_NullGenerator probability="0.5">
      <gen_AddRandomSecondsGenerator>
       <reference field="i_rec_start_date" />
       <outputFormat>yyyy-MM-dd</outputFormat>
       <min>2.0 * 365 * ${one_day_in_milliseconds} / 1000</min>
       <max>4.0 * 365 * ${one_day_in_milliseconds} / 1000</max>
      </gen_AddRandomSecondsGenerator>
   </gen_NullGenerator>
  -->
  </field>
  
  <!-- used by Q21 -->
  <field name="i_item_desc" size="200" type="VARCHAR" primary="false"><!-- TODO add Markov generator for description -->
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_RandomSentence>
      <min>150</min> <max>200</max>
    </gen_RandomSentence>
   </gen_NullGenerator>
  </field>
  
  <!-- used by Q7, Q22, Q24 -->
  <!-- decimalSize="7,2"-->
  <field name="i_current_price" size="7" type="NUMERIC" primary="false">
    <gen_DoubleGenerator>
     <minD>0.09d</minD>
     <maxD>99.99d</maxD>
     <decimalPlaces>2</decimalPlaces>
    </gen_DoubleGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="i_wholesale_cost" size="7" type="NUMERIC" primary="false">
    <gen_DoubleGenerator>
     <minD>0.02d</minD>
     <maxD>87.36d</maxD>
     <decimalPlaces>2</decimalPlaces>
    </gen_DoubleGenerator>
  </field>
  
  <field name="i_brand_id" size="10" type="INTEGER" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_LongGenerator>
     <min>1001001.0</min>
     <max>10016017.0</max>
    </gen_LongGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="i_brand" size="50" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_RandomAString>
     <min>1.0</min>
     <max>50.0</max>
    </gen_RandomAString>
   </gen_NullGenerator>
  </field>
  
  <!-- used by Q26 -->
  <field name="i_class_id" size="10" type="INTEGER" primary="false">
   <gen_WeightedListGenerator filename="dicts/bigbench/categoriesWeightedList.txt" list="subcategories" valueColumn="1" weightColumn="1" id="categoryChooser" >
    <sameChoiceAs field="i_class" generatorByID="classChooser"/>
   </gen_WeightedListGenerator>
  </field>
  
  <field name="i_class" size="50" type="CHAR" primary="false">
   <gen_WeightedListGenerator filename="dicts/bigbench/categoriesWeightedList.txt"   list="subcategories" valueColumn="0" weightColumn="1" id="classChooser" />
  </field>
  
  <!-- used by Q1, Q15, Q29, Q30 -->
  <field name="i_category_id" size="10" type="INTEGER" primary="false">
   <gen_WeightedListGenerator filename="dicts/bigbench/categoriesWeightedList.txt" list="subcategories" valueColumn="3" weightColumn="1" id="categoryChooser" >
    <sameChoiceAs field="i_class" generatorByID="classChooser"/>
   </gen_WeightedListGenerator>
  </field>
  
  <!-- used by Q5, Q7, Q12, Q17, Q26 -->
  <field name="i_category" size="50" type="CHAR" primary="false">
   <gen_WeightedListGenerator filename="dicts/bigbench/categoriesWeightedList.txt" list="subcategories" valueColumn="2" weightColumn="1" id="categoryChooser" >
    <sameChoiceAs field="i_class" generatorByID="classChooser"/>
   </gen_WeightedListGenerator>
  </field>
  
  <field name="i_manufact_id" size="10" type="INTEGER" primary="false">
   <gen_LongGenerator>
    <min>1.0</min>
    <max>1000.0</max>
   </gen_LongGenerator>
  </field>
  
  <field name="i_manufact" size="50" type="CHAR" primary="false">
   <gen_RandomAString>
    <min>1.0</min>
    <max>50.0</max>
   </gen_RandomAString>
  </field>
  
  <field name="i_size" size="20" type="CHAR" primary="false">
  <!-- "NULL" are generated in sizes list -->
   <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="sizes" valueColumn="0" weightColumn="0" />
  </field>
  
  <field name="i_formulation" size="20" type="CHAR" primary="false">
   <gen_RandomAString>
    <min>1.0</min>
    <max>20.0</max>
   </gen_RandomAString>
  </field>
  
  <field name="i_color" size="20" type="CHAR" primary="false">
   <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="colors" valueColumn="0" weightColumn="0" />
  </field>
  
  <field name="i_units" size="10" type="CHAR" primary="false">
   <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="units" valueColumn="0" weightColumn="0" />
  </field>
  
  <field name="i_container" size="10" type="CHAR" primary="false">
   <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="container" valueColumn="0" weightColumn="0" />
  </field>
  
  <field name="i_manager_id" size="10" type="INTEGER" primary="false">
   <gen_LongGenerator>
    <min>1.0</min>
    <max>100.0</max>
   </gen_LongGenerator>
  </field>
  
  <field name="i_product_name" size="50" type="CHAR" primary="false">
   <gen_RandomAString>
    <min>3.0</min>
    <max>50.0</max>
   </gen_RandomAString>
  </field>
 </table>
 
 
 <table name="item_marketprices">
  <size>${item_marketprices_size}</size>
  
  <field name="imp_sk" size="19" type="BIGINT" primary="true">
  <gen_IdGenerator> <min>${SK_ID_OFFSET}</min> </gen_IdGenerator>
  </field>
  
  <!-- used by Q24 -->
  <!-- FK i_item_sk -->
  <field name="imp_item_sk" size="19" type="BIGINT" primary="false">
   <gen_ReferenceGenerator id="itemChooser" choose="random" from="historical">
    <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="item" field="i_item_sk" />
   </gen_ReferenceGenerator>
  </field>
  
  <field name="imp_competitor" size="20" type="VARCHAR" primary="false">
  
  <!-- limit to only 1000 unique competitor names -->
  <gen_ConvertNumberToStringGenerator>
     <gen_LongGenerator>
      <min>1.0</min>
      <max>1000.0</max>
     </gen_LongGenerator>
    <size>16.0</size>
    <characters>ABCDEFGHIJKLMNOPQRSTUVWXYZ</characters>
   </gen_ConvertNumberToStringGenerator>
   
   
    <!-- street names would make nice Company names , but we have to limit to ~1000 unique ones -->
    <!-- 
   <gen_TemplateGenerator>
     <getValue><!- 
      StringBuilder sb = new StringBuilder();
      sb.append(generator[0].toString());
      //in 50% add a second name
      if(rng.nextDouble()>0.5){
        sb.append('-');
        sb.append(generator[1].toString());
      }
      //truncate to length
      if(sb.length() >20){
        sb.setLength(20);
      }
                     
       fvdto.setBothValues(sb.toString()); 
     -></getValue>
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="street_names" valueColumn="0" weightColumn="0" />
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="street_names" valueColumn="0" weightColumn="0" />
   </gen_TemplateGenerator>
    -->
   <!-- 
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_RandomAString>
     <min>1.0</min>
     <max>20.0</max>
    </gen_RandomAString>
   </gen_NullGenerator>
    -->
  </field>
  
  <!-- used by Q24 -->
  <!-- decimalSize="7,2"-->
  <field name="imp_competitor_price" size="7" type="NUMERIC" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_DoubleGenerator>
     <minD>0.09d</minD>
     <maxD>99.99d</maxD>
     <decimalPlaces>2</decimalPlaces>
    </gen_DoubleGenerator>
   </gen_NullGenerator>
  </field>
  
  <!-- used by Q24 -->
  <field name="imp_start_date_sk" size="19" type="BIGINT" primary="false">
  <!-- monotonic increasing date timestamp starting at the same day as store sales (${store_sales_days_since_date_begin_date}) and increasing with equal steps of: datarange/tablesize  -->
   <gen_FormulaGenerator>
    <formula>${store_sales_days_since_date_begin_date} + Math.floor(gc.getID() * (( ${store_sales_days_within} - 1) / ${item_marketprices_size} ))</formula>
    <decimalPlaces>0</decimalPlaces>
   </gen_FormulaGenerator>

  </field>
  
  <!-- used by Q24 -->
  <field name="imp_end_date_sk" size="19" type="BIGINT" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_FormulaGenerator>
      <!-- way a) randomly valid between start_date and a certain fixed time range -->
      <!--
     <formula>(long)generator[0] + parent.getRandomSample(0L, (long)${item_marketprice_max_validity_days} , random)</formula>
      -->  
     <!-- way b) randomly valid between start_date and end of current store sales -->
     <formula> parent.getRandomSample((long)generator[0], (long)${store_sales_end_date_sk} , random)</formula>
     <decimalPlaces>0</decimalPlaces>
     <!-- generator[0] -->
     <gen_OtherFieldValueGenerator>
      <reference field="imp_start_date_sk" />
     </gen_OtherFieldValueGenerator>
    </gen_FormulaGenerator>
   </gen_NullGenerator>
  </field>
 </table>
 
 
 <table name="product_reviews">
  <size>${product_reviews_size}</size>
  
  <!-- used by Q27, Q28 -->
  <field name="pr_review_sk" size="19" type="BIGINT" primary="true">
  <gen_IdGenerator> <min>${SK_ID_OFFSET}</min> </gen_IdGenerator>
  </field>
  
  <!-- used by Q18 -->
  <field name="pr_review_date" size="13" type="CHAR" primary="false">
    <gen_DateTimeGenerator>
     <useFixedStepSize>true</useFixedStepSize>
     <startDate>${FACT_TABLES_START_DAY}</startDate>
     <endDate>${FACT_TABLES_END_DAY}</endDate>
     <outputFormat>yyyy-MM-dd</outputFormat>
    </gen_DateTimeGenerator>
  </field>
  
  <field name="pr_review_time" size="6" type="CHAR" primary="false">
    <gen_DateTimeGenerator>
     <useFixedStepSize>true</useFixedStepSize>
     <startDate>${FACT_TABLES_START_DAY}</startDate> <!-- does not realy matter, as long as it covers at least one day -->
     <endDate>${FACT_TABLES_END_DAY}</endDate>
     <outputFormat>HH:mm:ss</outputFormat>
    </gen_DateTimeGenerator>
  </field>
  
  <!-- used by Q11, Q28 -->
  <field name="pr_review_rating" size="10" type="INTEGER" primary="false">
   <!-- weighted rating 1-5, value cols (int, varchar) weightcols: (uniform, weighted) -->
   <gen_WeightedListGenerator filename="dicts/bigbench/categoriesWeightedList.txt" list="ratingWeights" valueColumn="1" weightColumn="1" />
  </field>
  
  <!-- FK i_item_sk -->
  <field name="pr_item_sk" size="19" type="BIGINT" primary="false">
    <gen_RandomListItemsGenerator id="itemChooser" singleItemAsList="false">
      <max>1</max>
      <!-- <sameChoiceAs field="sr_item_sk" generatorByID="listIndexChooser" /> -->
      <gen_ReferenceGenerator choose="sameChoiceAs" from="">
        <sameChoiceAs field="pr_order_sk" generatorByID="orderChooser"/>
        <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="web_sales" field="ws_item_sk" /><!-- reference result can be null -->
      </gen_ReferenceGenerator>
    </gen_RandomListItemsGenerator>

    <!-- 
     <gen_ReferenceGenerator id="itemChooser" choose="random" from="historical">
      <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="item" field="i_item_sk" />
     </gen_ReferenceGenerator>
     -->
  </field>
  
  <field name="pr_user_sk" size="19" type="BIGINT" primary="false">
    <gen_ReferenceGenerator choose="sameChoiceAs" from="">
      <sameChoiceAs field="pr_order_sk" generatorByID="orderChooser"/>
      <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="web_sales" field="ws_ship_customer_sk" /><!-- reference result can be null -->
    </gen_ReferenceGenerator>
    
     <!-- old system not tied to websales -->
     <!--pr_user_sk not used in any query right now. For now random number is sufficient. We could choose a valid user analogue to pr_item sk -->
     <!-- 
      <gen_LongGenerator>
       <min>${SK_ID_OFFSET}</min>
       <max>${customer_size}+${SK_ID_OFFSET}</max>
      </gen_LongGenerator>
     -->
  </field>
  
  <field name="pr_order_sk" size="19" type="BIGINT" primary="false">
   <!--pr_order_sk not used in any query right now. For now random number is sufficient. We could choose a valid user analogue to pr_item sk -->
   <gen_PermutationReferenceGenerator id="orderChooser">
    <boundsCheckEnabledOverride>0</boundsCheckEnabledOverride>
    <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="web_sales" field="ws_order_number" />
   </gen_PermutationReferenceGenerator>
   
   <!-- Old system, not tied to web_sales
  
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_LongGenerator>
     <min>${SK_ID_OFFSET}</min>
     <max>${web_sales_size}+${SK_ID_OFFSET}</max>
    </gen_LongGenerator>
   </gen_NullGenerator>
     -->
  </field>
  
  <!-- 
   <field name="pr_i_category" size="19" type="BIGINT" primary="false">
   <gen_ReferenceGenerator choose="sameChoiceAs" from="">
     <sameChoiceAs field="pr_item_sk" generatorByID="itemChooser"/><useValueAsIDsource>true</useValueAsIDsource>
     <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="item" field="i_category" />
    </gen_ReferenceGenerator>
   </field>
   -->
   
  <!-- used by Q10, Q18, Q19, Q27, Q28 -->
  <field name="pr_review_content" size="0" type="LONGVARCHAR" primary="false">
  
   <!-- x percent of reviews must contain a random "store_name" from stores table => required by q18 serarching for this--> 
   <gen_ProbabilityGenerator>
     <probability value="1.0d - ${PR_CONTAINING_STORE_NAME_PERCENT}">
          <!--Generate a review suiting the item category and the rating -->
          <gen_BigBenchReviewGenerator>
              <markovChainsPath>dicts/bigbench/reviews-markovchains</markovChainsPath>  
            
              <!-- required intra tuple reference to rating -->
              <gen_OtherFieldValueGenerator>
                <reference field="pr_review_rating" />
              </gen_OtherFieldValueGenerator>
             
              <!-- required reference to i_category, YES category, not subcategory. In truth i_category chooses both, but it depends on the column within the weighted list.  -->
              <gen_ReferenceGenerator choose="sameChoiceAs" from="">
               <sameChoiceAs field="pr_item_sk" generatorByID="itemChooser"/><useValueAsIDsource>true</useValueAsIDsource>
               <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="item" field="i_category" />
              </gen_ReferenceGenerator>
              
              <!-- Fallback generator if no fitting Markov chain is found for specified category/rating   -->   
              <gen_RandomSentence>
                <min>150</min> <max>150</max>
              </gen_RandomSentence>
              
          </gen_BigBenchReviewGenerator>
     </probability>
     <!-- x percent of reviews contain a exisiting s_store_name -->
     <probability value="${PR_CONTAINING_STORE_NAME_PERCENT}">
        <gen_TemplateGenerator>
            <getValue><!-- 
                //multiline code, xml comment tags are required
                //add whitespace prefix to store name for later insert into review text without sticking to preceeding word.
                String store_name = " " + generator[0].toString();
                String review = generator[1].toString();   
                
                //most efficient way, as StringBuilder can share its internal buffer with new String
                StringBuilder buf = new StringBuilder(store_name.length()+review.length()); //set to final len, avoid resizing
                buf.append(review);
                //insert store name at random position
                int insertPos = parent.getRandomSample(0,review.length(),rng);
                
                //find next whitespace
                insertPos = review.indexOf(' ', insertPos);
                if(insertPos <1){ //no whitespace found, append at end of review 
                  buf.append(store_name);
                }else{
                  buf.insert(insertPos,store_name);
                }
                fvdto.setBothValues(buf.toString()); 
            --></getValue>
            
            <!-- Generator[0] store name-->
            <gen_ReferenceGenerator choose="random" from="historical">
              <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="store" field="s_store_name" />
            </gen_ReferenceGenerator> 
            
            <!-- Generator[1] review text-->
            <!--Generate a review suiting the item category and the rating -->
            <gen_BigBenchReviewGenerator>
                <markovChainsPath>dicts/bigbench/reviews-markovchains</markovChainsPath>  
              
                <!-- required intra tuple reference to rating -->
                <gen_OtherFieldValueGenerator>
                  <reference field="pr_review_rating" />
                </gen_OtherFieldValueGenerator>
               
                <!-- required reference to i_category, YES category, not subcategory. In truth i_category chooses both, but it depends on the column within the weighted list.  -->
                <gen_ReferenceGenerator choose="sameChoiceAs" from="">
                 <sameChoiceAs field="pr_item_sk" generatorByID="itemChooser"/><useValueAsIDsource>true</useValueAsIDsource>
                 <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="item" field="i_category" />
                </gen_ReferenceGenerator>
                
                <!-- Fallback generator if no fitting Markov chain is found for specified category/rating   -->   
                <gen_RandomSentence>
                  <min>150</min> <max>150</max>
                </gen_RandomSentence>
              </gen_BigBenchReviewGenerator>
          </gen_TemplateGenerator>
        </probability>
     </gen_ProbabilityGenerator>
  </field>
 </table>
 
 
 <!-- Each row in this table represents details of a specific product promotion (e.g., advertising, sales, PR) -->
 <table name="promotion">
  <size>${promotion_size}</size>
  
  <!-- used by Q17 -->
  <field name="p_promo_sk" size="19" type="BIGINT" primary="true">
  <gen_IdGenerator> <min>${SK_ID_OFFSET}</min> </gen_IdGenerator>
  </field>
  
  <field name="p_promo_id" size="16" type="CHAR" primary="false">
   <gen_ConvertNumberToStringGenerator>
    <gen_IdGenerator/>
    <size>16.0</size>
    <characters>ABCDEFGHIJKLMNOPQRSTUVWXYZ</characters>
   </gen_ConvertNumberToStringGenerator>
  </field>
  
  <!-- FK d_date_sk -->
  <field name="p_start_date_sk" size="19" type="BIGINT" primary="false">
    <gen_ReferenceGenerator choose="random" from="historical">
     <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="date_dim" field="d_date_sk" />
    </gen_ReferenceGenerator>
  </field>
  
  <!-- FK d_date_sk -->
  <field name="p_end_date_sk" size="19" type="BIGINT" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_FormulaGenerator>
     <formula>parent.getRandomSample((long)generator[0], (long) (${date_dim_size} ), random)</formula>
     <decimalPlaces>0</decimalPlaces>
     <gen_OtherFieldValueGenerator>
      <reference field="p_start_date_sk" />
     </gen_OtherFieldValueGenerator>
    </gen_FormulaGenerator>
   </gen_NullGenerator>
  </field>
  
  <!-- FK i_item_sk -->
  <field name="p_item_sk" size="19" type="BIGINT" primary="false">
    <gen_ReferenceGenerator choose="random" from="historical">
     <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="item" field="i_item_sk" />
    </gen_ReferenceGenerator>
  </field>
  
  <!-- decimalSize="15,2"-->
  <field name="p_cost" size="15" type="NUMERIC" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_DoubleGenerator>
     <minD>10.00d</minD>
     <maxD>1000.00d</maxD>
     <decimalPlaces>2</decimalPlaces>
    </gen_DoubleGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="p_response_target" size="10" type="INTEGER" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_LongGenerator>
     <min>1.0</min>
     <max>1.0</max>
    </gen_LongGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="p_promo_name" size="50" type="CHAR" primary="false">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="syllables" valueColumn="0" weightColumn="0" />
  </field>
  
  <!-- used by Q17 -->
  <field name="p_channel_dmail" size="1" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_ProbabilityGenerator>
     <probability value="${dmail_likelihood}">
      <gen_StaticValueGenerator>
       <value>Y</value>
      </gen_StaticValueGenerator>
     </probability>
     <probability value="1 - ${dmail_likelihood}">
      <gen_StaticValueGenerator>
       <value>N</value>
      </gen_StaticValueGenerator>
     </probability>
    </gen_ProbabilityGenerator>
   </gen_NullGenerator>
  </field>
  
  <!-- used by Q17 -->
  <field name="p_channel_email" size="1" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_ProbabilityGenerator>
     <probability value="${email_likelihood}">
      <gen_StaticValueGenerator>
       <value>Y</value>
      </gen_StaticValueGenerator>
     </probability>
     <probability value="1 - ${email_likelihood}">
      <gen_StaticValueGenerator>
       <value>N</value>
      </gen_StaticValueGenerator>
     </probability>
    </gen_ProbabilityGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="p_channel_catalog" size="1" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_ProbabilityGenerator>
     <probability value="${catalog_likelihood}">
      <gen_StaticValueGenerator>
       <value>Y</value>
      </gen_StaticValueGenerator>
     </probability>
     <probability value="1 - ${catalog_likelihood}">
      <gen_StaticValueGenerator>
       <value>N</value>
      </gen_StaticValueGenerator>
     </probability>
    </gen_ProbabilityGenerator>
   </gen_NullGenerator>
  </field>
  
  <!-- used by Q17 -->
  <field name="p_channel_tv" size="1" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_ProbabilityGenerator>
     <probability value="${tv_likelihood}">
      <gen_StaticValueGenerator>
       <value>Y</value>
      </gen_StaticValueGenerator>
     </probability>
     <probability value="1 - ${tv_likelihood}">
      <gen_StaticValueGenerator>
       <value>N</value>
      </gen_StaticValueGenerator>
     </probability>
    </gen_ProbabilityGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="p_channel_radio" size="1" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_ProbabilityGenerator>
     <probability value="${radio_likelihood}">
      <gen_StaticValueGenerator>
       <value>Y</value>
      </gen_StaticValueGenerator>
     </probability>
     <probability value="1 - ${radio_likelihood}">
      <gen_StaticValueGenerator>
       <value>N</value>
      </gen_StaticValueGenerator>
     </probability>
    </gen_ProbabilityGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="p_channel_press" size="1" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_ProbabilityGenerator>
     <probability value="${press_likelihood}">
      <gen_StaticValueGenerator>
       <value>Y</value>
      </gen_StaticValueGenerator>
     </probability>
     <probability value="1 - ${press_likelihood}">
      <gen_StaticValueGenerator>
       <value>N</value>
      </gen_StaticValueGenerator>
     </probability>
    </gen_ProbabilityGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="p_channel_event" size="1" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_ProbabilityGenerator>
     <probability value="${event_likelihood}">
      <gen_StaticValueGenerator>
       <value>Y</value>
      </gen_StaticValueGenerator>
     </probability>
     <probability value="1 - ${event_likelihood}">
      <gen_StaticValueGenerator>
       <value>N</value>
      </gen_StaticValueGenerator>
     </probability>
    </gen_ProbabilityGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="p_channel_demo" size="1" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_ProbabilityGenerator>
     <probability value="${demo_likelihood}">
      <gen_StaticValueGenerator>
       <value>Y</value>
      </gen_StaticValueGenerator>
     </probability>
     <probability value="1 - ${demo_likelihood}">
      <gen_StaticValueGenerator>
       <value>N</value>
      </gen_StaticValueGenerator>
     </probability>
    </gen_ProbabilityGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="p_channel_details" size="100" type="VARCHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_RandomSentence>
      <min>50</min> <max>100</max>
    </gen_RandomSentence>
   </gen_NullGenerator>
  </field>
  
  <field name="p_purpose" size="15" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_StaticValueGenerator>
     <value>Unknown</value>
    </gen_StaticValueGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="p_discount_active" size="1" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_ProbabilityGenerator>
     <probability value="${discount_active_likelihood}">
      <gen_StaticValueGenerator>
       <value>Y</value>
      </gen_StaticValueGenerator>
     </probability>
     <probability value="1 - ${discount_active_likelihood}">
      <gen_StaticValueGenerator>
       <value>N</value>
      </gen_StaticValueGenerator>
     </probability>
    </gen_ProbabilityGenerator>
   </gen_NullGenerator>
  </field>
 </table>




 <!-- Each row in this dimension table represents detals of a store -->
 <table name="store">
  <size>${store_size}</size>
  
  <!-- used by Q9, Q17, Q18, Q21 -->
  <field name="s_store_sk" size="19" type="BIGINT" primary="true">
  <gen_IdGenerator> <min>${SK_ID_OFFSET}</min> </gen_IdGenerator>
  </field>
  
  <!-- used by Q21 -->
  <field name="s_store_id" size="16" type="CHAR" primary="false">
   <gen_ConvertNumberToStringGenerator>
    <gen_IdGenerator/>
    <size>16.0</size>
    <characters>ABCDEFGHIJKLMNOPQRSTUVWXYZ</characters>
   </gen_ConvertNumberToStringGenerator>
  </field>
  
  <field name="s_rec_start_date" size="13" type="CHAR" primary="false">
    <gen_DateTimeGenerator>
     <useFixedStepSize>true</useFixedStepSize>
     <startDate>${store_begin_date}</startDate>
     <endDate>${store_sales_begin_date}</endDate>
     <outputFormat>yyyy-MM-dd</outputFormat>
    </gen_DateTimeGenerator>
  </field>
  
  <field name="s_rec_end_date" size="13" type="CHAR" primary="false"  nullable="true">
   <!-- all stores are active for the moment => NULL -->
   <gen_StaticValueGenerator>
    <value></value>
   </gen_StaticValueGenerator>
   <!-- s_rec_end_date not used by any query right now. If required the following modelling would be a good start:
   <gen_NullGenerator probability="0.5">
      <gen_AddRandomSecondsGenerator>
       <reference field="s_rec_start_date" />
       <outputFormat>yyyy-MM-dd</outputFormat>
       <min>2.0 * 365 * ${one_day_in_milliseconds} / 1000</min>
       <max>4.0 * 365 * ${one_day_in_milliseconds} / 1000</max>
      </gen_AddRandomSecondsGenerator>
   </gen_NullGenerator>
   -->
  </field>
  
  <!-- FK d_date_sk -->
  <field name="s_closed_date_sk" size="19" type="BIGINT" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_ReferenceGenerator choose="random" from="historical">
     <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="date_dim" field="d_date_sk" />
    </gen_ReferenceGenerator>
   </gen_NullGenerator>
  </field>
  
  <!-- used by Q18, Q21 -->
  <field name="s_store_name" size="50" type="VARCHAR" primary="false">
    <!-- Name is supposed to be NOT unique (thats what s_store_id and s_store_sk are for)--> 
    <!-- just use "cities" as store name, which makes a nice name for a store but limit to single word --> 
    <gen_TemplateGenerator>
      <getValue><!-- //multiline code, xml comment tags are required
              String value=generator[0].toString();  
              int idx= value.indexOf(' ');
              if (idx>0){
                value = value.substring(0,idx);
              }
              fvdto.setBothValues(value.trim()); 
              --></getValue>
      <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="cities" valueColumn="0" weightColumn="1" />
    </gen_TemplateGenerator>
   
  </field>
  
  <field name="s_number_employees" size="10" type="INTEGER" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_LongGenerator>
     <min>200.0</min>
     <max>300.0</max>
    </gen_LongGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="s_floor_space" size="10" type="INTEGER" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_LongGenerator>
     <min>5000000.0</min>
     <max>10000000.0</max>
    </gen_LongGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="s_hours" size="20" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="call_center_hours" valueColumn="0" weightColumn="0" />
   </gen_NullGenerator>
  </field>
  
  <field name="s_manager" size="40" type="VARCHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_TemplateGenerator>
     <getValue>fvdto.setBothValues(generator[0] + " " + generator[1]);</getValue>
     <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="first_names" valueColumn="0" weightColumn="0" />
     <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="last_names" valueColumn="0" weightColumn="0" />
    </gen_TemplateGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="s_market_id" size="10" type="INTEGER" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_LongGenerator>
     <min>2.0</min>
     <max>10.0</max>
    </gen_LongGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="s_geography_class" size="100" type="VARCHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_StaticValueGenerator>
     <value>Unknown</value>
    </gen_StaticValueGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="s_market_desc" size="100" type="VARCHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
     <gen_RandomSentence>
      <min>50</min> <max>100</max>
    </gen_RandomSentence>
   </gen_NullGenerator>
  </field>
  
  <field name="s_market_manager" size="40" type="VARCHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_TemplateGenerator>
     <getValue>fvdto.setBothValues(generator[0] + " " + generator[1]);</getValue>
     <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="first_names" valueColumn="0" weightColumn="0" />
     <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="last_names" valueColumn="0" weightColumn="0" />
    </gen_TemplateGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="s_division_id" size="10" type="INTEGER" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_LongGenerator>
     <min>1.0</min>
     <max>1.0</max>
    </gen_LongGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="s_division_name" size="50" type="VARCHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_StaticValueGenerator>
     <value>Unknown</value>
    </gen_StaticValueGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="s_company_id" size="10" type="INTEGER" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_LongGenerator>
     <min>1.0</min>
     <max>1.0</max>
    </gen_LongGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="s_company_name" size="50" type="VARCHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_StaticValueGenerator>
     <value>Unknown</value>
    </gen_StaticValueGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="s_street_number" size="10" type="VARCHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_LongGenerator>
     <min>${address_street_number_min}</min>
     <max>${address_street_number_max}</max>
    </gen_LongGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="s_street_name" size="60" type="VARCHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_TemplateGenerator>
     <getValue><!-- String streetName= (rng.nextDouble()>0.5 ? (generator[0].toString() + " " + generator[1].toString()):  generator[1].toString());
                    fvdto.setBothValues(streetName); 
     --></getValue>
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="street_names" valueColumn="0" weightColumn="0" />
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="street_names" valueColumn="0" weightColumn="0" />
    </gen_TemplateGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="s_street_type" size="15" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="street_type" valueColumn="0" weightColumn="0" />
   </gen_NullGenerator>
  </field>
  
  <field name="s_suite_number" size="10" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_RandomAString>
     <min>${address_suite_number_min}</min>
     <max>${address_suite_number_max}</max>
    </gen_RandomAString>
   </gen_NullGenerator>
  </field>
  
  <field name="s_city" size="60" type="VARCHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="cities" valueColumn="0" weightColumn="0" />
   </gen_NullGenerator>
  </field>
  
  <field name="s_county" size="30" type="VARCHAR" primary="false">
    <gen_WeightedListGenerator id="countyChooser" filename="dicts/bigbench/ds-genProbabilities.txt" list="fips_county" valueColumn="county" weightColumn="uniform" />
  </field>
  
  <field name="s_state" size="2" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="fips_county" valueColumn="st" weightColumn="uniform">
     <sameChoiceAs field="s_county" generatorByID="countyChooser"/>
    </gen_WeightedListGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="s_zip" size="10" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_LongGenerator>
     <min>${address_zip_min}</min>
     <max>${address_zip_max}</max>
    </gen_LongGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="s_country" size="20" type="VARCHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_StaticValueGenerator>
     <value>United States</value>
    </gen_StaticValueGenerator>
   </gen_NullGenerator>
  </field>
  
  <!-- used by Q17 -->
  <!-- decimalSize="5,2"-->
  <field name="s_gmt_offset" size="5" type="NUMERIC" primary="false">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="fips_county" valueColumn="gmt" weightColumn="uniform">
     <sameChoiceAs field="s_county" generatorByID="countyChooser"/>
    </gen_WeightedListGenerator>
  </field>
  
  <!-- decimalSize="5,2"-->
  <field name="s_tax_precentage" size="5" type="NUMERIC" primary="false">
    <gen_DoubleGenerator>
     <minD>${STORE_MIN_TAX_PERCENTAGE}</minD>
     <maxD>${STORE_MAX_TAX_PERCENTAGE}</maxD>
     <decimalPlaces>2</decimalPlaces>
    </gen_DoubleGenerator>
  </field>
 </table>
 
 <!-- Each row in this dimension table represents a warehouse where items are stocked -->
 <table name="warehouse">
  <size>${warehouse_size}</size>
  
  <!-- used by Q16, Q23 -->
  <field name="w_warehouse_sk" size="19" type="BIGINT" primary="true">
  <gen_IdGenerator> <min>${SK_ID_OFFSET}</min> </gen_IdGenerator>
  </field>
  
  <field name="w_warehouse_id" size="16" type="CHAR" primary="false">
   <gen_ConvertNumberToStringGenerator>
    <gen_IdGenerator/>
    <size>16.0</size>
    <characters>ABCDEFGHIJKLMNOPQRSTUVWXYZ</characters>
   </gen_ConvertNumberToStringGenerator>
  </field>
  
  <!-- used by Q22, Q23 -->
  <field name="w_warehouse_name" size="20" type="VARCHAR" primary="false">
     <gen_RandomSentence>
      <min>10</min> <max>20</max>
     </gen_RandomSentence>
  </field>
  
  <field name="w_warehouse_sq_ft" size="10" type="INTEGER" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_LongGenerator>
     <min>${W_SQFT_MIN}</min>
     <max>${W_SQFT_MAX}</max>
    </gen_LongGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="w_street_number" size="10" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_LongGenerator>
     <min>${address_street_number_min}</min>
     <max>${address_street_number_max}</max>
    </gen_LongGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="w_street_name" size="60" type="VARCHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_TemplateGenerator>
     <getValue><!-- String streetName= (rng.nextDouble()>0.5 ? (generator[0].toString() + " " + generator[1].toString()):  generator[1].toString());
                    fvdto.setBothValues(streetName); 
     --></getValue>
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="street_names" valueColumn="0" weightColumn="0" />
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="street_names" valueColumn="0" weightColumn="0" />
    </gen_TemplateGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="w_street_type" size="15" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="street_type" valueColumn="0" weightColumn="0" />
   </gen_NullGenerator>
  </field>
  
  
  <field name="w_suite_number" size="10" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_RandomAString>
     <min>${address_suite_number_min}</min>
     <max>${address_suite_number_max}</max>
    </gen_RandomAString>
   </gen_NullGenerator>
  </field>
  
  <field name="w_city" size="60" type="VARCHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="cities" valueColumn="0" weightColumn="0" />
   </gen_NullGenerator>
  </field>
  
  <field name="w_county" size="30" type="VARCHAR" primary="false">
    <gen_WeightedListGenerator id="countyChooser" filename="dicts/bigbench/ds-genProbabilities.txt" list="fips_county" valueColumn="county" weightColumn="uniform" />
  </field>
  
  <!-- used by Q16 -->
  <field name="w_state" size="2" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="fips_county" valueColumn="st" weightColumn="uniform">
     <sameChoiceAs field="w_county" generatorByID="countyChooser"/>
    </gen_WeightedListGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="w_zip" size="10" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_LongGenerator>
     <min>${address_zip_min}</min>
     <max>${address_zip_max}</max>
    </gen_LongGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="w_country" size="20" type="VARCHAR" primary="false">
    <gen_StaticValueGenerator>
     <value>United States</value>
    </gen_StaticValueGenerator>
  </field>
  
  <!-- decimalSize="5,2"-->
  <field name="w_gmt_offset" size="5" type="NUMERIC" primary="false">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="fips_county" valueColumn="gmt" weightColumn="uniform">
     <sameChoiceAs field="w_county" generatorByID="countyChooser"/>
    </gen_WeightedListGenerator>
  </field>
 </table>
 
 
 
 
 <!-- Each row in this table represents a single lineitem for a sale made through the store channel and recorded in the store_sales fact table -->
 <table name="store_sales">
  <size>${store_sales_size}</size>
  
  <!-- used by Q6, Q7, Q9, Q12, Q13, Q15, Q17, Q18, Q20, Q21, Q24, Q25 -->
  <!-- FK d_date_sk -->
  <field name="ss_sold_date_sk" size="19" type="BIGINT" primary="false">
   <gen_FormulaGenerator>
    <formula>${store_sales_days_since_date_begin_date} + Math.floor(gc.getID() * ((${store_sales_days_within} - 1) / ${store_sales_size}))</formula>
    <decimalPlaces>0</decimalPlaces>
   </gen_FormulaGenerator>
  </field>
  <!--
  <field name="ss_sold_date_sk" size="19" type="BIGINT" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_ReferenceGenerator choose="random" from="historical">
     <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="date_dim" field="d_date_sk" />
    </gen_ReferenceGenerator>
   </gen_NullGenerator>
  </field>
  -->
  
  <!-- used by Q12 -->
  <!-- FK t_time_sk -->
  <field name="ss_sold_time_sk" size="19" type="BIGINT" primary="false">
    <gen_ReferenceGenerator choose="random" from="historical">
     <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="time_dim" field="t_time_sk" />
    </gen_ReferenceGenerator>
  </field>
  
  <!-- used by Q1, Q7, Q12, Q15, Q17, Q20, Q21, Q24, Q26 -->
  <!-- FK i_item_sk,sr_item_sk -->
  <field name="ss_item_sk" size="19" type="BIGINT" primary="true">
    <!-- we have to satisfy many query reqirements here: 
    1) a query may choose to select a single random item_sk and do analytics on this item => ensure that each item gets sold at least once.
    2) a query may search for "frequently sold" and "frequently sold together" relations, so we need to ensure to have good selling items while still satisfying 1)
    3) a query may compare sales channels, so web-sales must have roughly the same sales charateristics
    -->
    <!-- "ForGenerator" is inside of Probabitly choice, because we want high frequency itmes to be "SOLD TOGETHER" not just appearing mor frequent over all purchases -->
    <!-- because of this modeling, ss_item_sk no longer determines the number of items per order, this responsibility is switched over to ss_promo_sk (PDGF'S reference system will ensure correctness even if ss_promo_sk is defined after ss_item_sk) -->

  
   <!-- purchase i items together in the same purchase (list of items will be expanded by custom output plugin in bigbench-generation.xml to multiple lines in the final table) -->
      <gen_ForGenerator id="uniform_numberOfItemsChooser">
        <sameChoiceAs field="ss_promo_sk" generatorByID="numberOfItemsChooser"/>
        <do>
           <gen_ProbabilityGenerator>
              <!-- uniform random -->
              <!-- ${staticPurchasedItems_Ratio} relates to the total number of sold items => translate to fraction of a fraction -->
              <probability value="1.0 - ( ${staticPurchasedItems_Ratio} + ${nonUniformyPurchasedItems_Ratio} )">
                  <gen_ReferenceGenerator id="uniform_itemChooser" choose="random" from="historical" > 
                    <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="item" field="i_item_sk" />
                  </gen_ReferenceGenerator>
              </probability>
              
              <probability value=" ${staticPurchasedItems_Ratio}">
                <gen_ReferenceGenerator id="static_itemChooser" choose="idFromSubGenerator" from="historical" > 
                   <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="item" field="i_item_sk" />          
                   <!-- sub generator that chooses the item_sk id -->      
                   <gen_LongGenerator>
                    <min>10000</min>
                    <max>10003</max>
                   </gen_LongGenerator> 
                </gen_ReferenceGenerator>
              </probability>
            
              <probability value="${nonUniformyPurchasedItems_Ratio}">
                <gen_ReferenceGenerator id="nonUniform_itemChooser" choose="randomPermuted" from="historical" > 
                  <distribution name="Normal" mean="${item_size} / 2 " sd="${nonUniformyPurchasedItems_SD_BASE}*${SF_log_5}"/> <!-- 68% of all values are within [-sd, sd] and 99.7% are within [-3*sd, 3*sd] -->
                  <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="item" field="i_item_sk" />
                  <!-- ws_item_sk and ss_item_sk ReferenceGenerator use the same fixed permutation => they will compute the same permutation in 'randomPermuted' mode and thus picking the same items with the same frequency. -->
                </gen_ReferenceGenerator>
              </probability>
            
            </gen_ProbabilityGenerator>
          </do>
        </gen_ForGenerator>        

  </field>
  
  <!-- used by Q6, Q7, Q12, Q13, Q17, Q20, Q21, Q25, Q26 -->
  <!-- FK c_customer_sk -->
  <field name="ss_customer_sk" size="19" type="BIGINT" primary="false">
    <!-- Modeling: every customer_sk has purchases (the customer registered, so he has purchases) To achieve this, a fraction of all sales is distributed evenly accross all customers-->
    <!-- After some minimal purchase activiy per customer is ensured, we select some higly active customers using a normal distribution. -->
    <gen_ProbabilityGenerator id="customerDistributionChooser">
      <probability value="1.0 - ${nonUniformyCustomerPurchases_Ratio}">
        <gen_ReferenceGenerator choose="random" from="historical" id="customerChooser_uniform">
          <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer" field="c_customer_sk" />
        </gen_ReferenceGenerator>
      </probability>
      <probability value="${nonUniformyCustomerPurchases_Ratio}">
        <gen_ReferenceGenerator choose="randomPermuted" from="historical" id="customerChooser_nonUniform">
          <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer" field="c_customer_sk" />
          <distribution name="Normal" mean="${customer_size} / 2 " sd=" ${nonUniformyCustomerPurchases_SD_BASE} * ${SF_log_5}"/> <!-- 68% of all values are within [-sd, sd] and 99.7% are within [-3*sd, 3*sd] -->
        </gen_ReferenceGenerator>
      </probability>
    </gen_ProbabilityGenerator>
  </field>
  
  <!-- used by Q9 -->
  <!-- FK cd_demo_sk -->
  <field name="ss_cdemo_sk" size="19" type="BIGINT" primary="false" nullable="true">
    <gen_NullGenerator probability="${NULL_CHANCE}">
       <gen_ProbabilityGenerator>
          <sameChoiceAs field="ss_customer_sk" generatorByID="customerDistributionChooser"/>
          <probability value="1.0 - ${nonUniformyCustomerPurchases_Ratio}">
            <gen_ReferenceGenerator choose="sameChoiceAs" from="">
              <sameChoiceAs field="ss_customer_sk" generatorByID="customerChooser_uniform"/>
              <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer" field="c_current_cdemo_sk" /><!-- reference result can be null -->
            </gen_ReferenceGenerator>
         </probability>
         <probability value="${nonUniformyCustomerPurchases_Ratio}">
            <gen_ReferenceGenerator choose="sameChoiceAs" from="">
              <sameChoiceAs field="ss_customer_sk" generatorByID="customerChooser_nonUniform"/>
              <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer" field="c_current_cdemo_sk" /><!-- reference result can be null -->
            </gen_ReferenceGenerator>
         </probability>
       </gen_ProbabilityGenerator>
    </gen_NullGenerator>
  </field>
  
  <!-- FK hd_demo_sk -->
  <field name="ss_hdemo_sk" size="19" type="BIGINT" primary="false" nullable="true">
   <gen_NullGenerator probability="${NULL_CHANCE}">
       <gen_ProbabilityGenerator>
          <sameChoiceAs field="ss_customer_sk" generatorByID="customerDistributionChooser"/>
          <probability value="1.0 - ${nonUniformyCustomerPurchases_Ratio}">
            <gen_ReferenceGenerator choose="sameChoiceAs" from="">
              <sameChoiceAs field="ss_customer_sk" generatorByID="customerChooser_uniform"/>
              <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer" field="c_current_hdemo_sk" /><!-- reference result can be null -->
            </gen_ReferenceGenerator>
         </probability>
         <probability value="${nonUniformyCustomerPurchases_Ratio}">
            <gen_ReferenceGenerator choose="sameChoiceAs" from="">
              <sameChoiceAs field="ss_customer_sk" generatorByID="customerChooser_nonUniform"/>
              <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer" field="c_current_hdemo_sk" /><!-- reference result can be null -->
            </gen_ReferenceGenerator>
         </probability>
       </gen_ProbabilityGenerator>
    </gen_NullGenerator>
  </field>
  
  <!-- used by Q9 -->
  <!-- FK ca_address_sk -->
  <field name="ss_addr_sk" size="19" type="BIGINT" primary="false">
    <gen_NullGenerator probability="${NULL_CHANCE}">
       <gen_ProbabilityGenerator>
          <sameChoiceAs field="ss_customer_sk" generatorByID="customerDistributionChooser"/>
          <probability value="1.0 - ${nonUniformyCustomerPurchases_Ratio}">
            <gen_ReferenceGenerator choose="sameChoiceAs" from="">
              <sameChoiceAs field="ss_customer_sk" generatorByID="customerChooser_uniform"/>
              <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer" field="c_current_addr_sk" /><!-- reference result can be null -->
            </gen_ReferenceGenerator>
         </probability>
         <probability value="${nonUniformyCustomerPurchases_Ratio}">
            <gen_ReferenceGenerator choose="sameChoiceAs" from="">
              <sameChoiceAs field="ss_customer_sk" generatorByID="customerChooser_nonUniform"/>
              <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer" field="c_current_addr_sk" /><!-- reference result can be null -->
            </gen_ReferenceGenerator>
         </probability>
       </gen_ProbabilityGenerator>
    </gen_NullGenerator>
  </field>
  
  <!-- used by Q1, Q9, Q15, Q17, Q18, Q21 -->
  <!-- FK s_store_sk -->
  <field name="ss_store_sk" size="19" type="BIGINT" primary="false">
    <gen_ReferenceGenerator choose="random" from="historical">
     <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="store" field="s_store_sk" />
    </gen_ReferenceGenerator>
  </field>
  
  <!-- used by Q17 -->
  <!-- FK p_promo_sk -->
  <field name="ss_promo_sk" size="19" type="BIGINT" primary="false">
   <gen_ForGenerator id="numberOfItemsChooser">
      <i>
        <gen_LongGenerator>
          <min>${SS_ITEMS_PER_ORDER_MIN}</min>
          <max>${SS_ITEMS_PER_ORDER_MAX}</max>
        </gen_LongGenerator>
      </i>
    <do>
     <gen_NullGenerator probability="${NULL_CHANCE}">
      <gen_ReferenceGenerator choose="random" from="historical">
       <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="promotion" field="p_promo_sk" />
      </gen_ReferenceGenerator>
     </gen_NullGenerator>
    </do>
   </gen_ForGenerator>
  </field>
  
  <!-- used by Q1, Q20, Q21, Q25 -->
  <!-- FK sr_ticket_number ??? cyclic dependency ss_ticket_number <=> sr_ticket_number -->
  <field name="ss_ticket_number" size="19" type="BIGINT" primary="true">
    <gen_IdGenerator> <min>${SK_ID_OFFSET}</min> </gen_IdGenerator>
  </field>
  
  <!-- used by q20 ,Q21, Q24 -->
  <field name="ss_quantity" size="10" type="INTEGER" primary="false">
   <gen_ForGenerator>
     <sameChoiceAs field="ss_promo_sk" generatorByID="numberOfItemsChooser"/>
    <do>
     <gen_LongGenerator>
      <min>1.0</min>
      <max>${SS_QUANTITY_MAX}</max>
     </gen_LongGenerator>
    </do>
   </gen_ForGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="ss_wholesale_cost" size="7" type="NUMERIC" primary="false">
   <gen_ForGenerator>
     <sameChoiceAs field="ss_promo_sk" generatorByID="numberOfItemsChooser"/>
    <do>
     <gen_DoubleGenerator>
      <minD>1.00d</minD>
      <maxD>${SS_WHOLESALE_MAX}</maxD>
      <decimalPlaces>2</decimalPlaces>
     </gen_DoubleGenerator>
    </do>
   </gen_ForGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="ss_list_price" size="7" type="NUMERIC" primary="false">
    <gen_ForGenerator>
       <sameChoiceAs field="ss_promo_sk" generatorByID="numberOfItemsChooser"/>
      <do>
        <gen_ForFormulaGenerator>
          <formula>generator[0] * (1 + generator[1])</formula>
          <decimalPlaces roundPlainValue="1">2</decimalPlaces><!-- round formula result-->
          <!--generator[0]-->
          <gen_OtherFieldValueGenerator>
            <reference field="ss_wholesale_cost" />
          </gen_OtherFieldValueGenerator>
          <!--generator[1]-->
          <gen_DoubleGenerator>
            <minD>0.00d</minD>
            <maxD>${SS_MARKUP_MAX}</maxD>
            <decimalPlaces>2</decimalPlaces>
          </gen_DoubleGenerator>
        </gen_ForFormulaGenerator>
      </do>
    </gen_ForGenerator>
  </field>
  
  <!-- used by Q9 -->
  <!-- decimalSize="7,2"-->
  <field name="ss_sales_price" size="7" type="NUMERIC" primary="false">
    <gen_ForGenerator>
       <sameChoiceAs field="ss_promo_sk" generatorByID="numberOfItemsChooser"/>
      <do>
        <gen_ForFormulaGenerator>
          <formula>generator[0] * (1 - generator[1])</formula>
          <decimalPlaces roundPlainValue="1">2</decimalPlaces><!-- round formula result-->
          
          <!--generator[0]-->
          <gen_OtherFieldValueGenerator>
            <reference field="ss_list_price" />
          </gen_OtherFieldValueGenerator>
          <!--generator[1]-->
          <gen_DoubleGenerator>
            <minD>0.00d</minD>
            <maxD>${SS_DISCOUNT_MAX}</maxD>
            <decimalPlaces>2</decimalPlaces>
          </gen_DoubleGenerator>
        </gen_ForFormulaGenerator>
      </do>
    </gen_ForGenerator>
  </field>
  
  <!-- used by Q6 -->
  <!-- decimalSize="7,2"-->
  <field name="ss_ext_discount_amt" size="7" type="NUMERIC" primary="false">
    <gen_ForGenerator>
       <sameChoiceAs field="ss_promo_sk" generatorByID="numberOfItemsChooser"/>
      <do>
        <gen_ForFormulaGenerator>
          <formula>generator[0] - generator[1]</formula>
          <decimalPlaces roundPlainValue="1">2</decimalPlaces><!-- round formula result-->
          <!--generator[0]-->
          <gen_OtherFieldValueGenerator>
            <reference field="ss_ext_list_price" />
          </gen_OtherFieldValueGenerator>
          <!--generator[1]-->
          <gen_OtherFieldValueGenerator>
            <reference field="ss_ext_sales_price" />
          </gen_OtherFieldValueGenerator>
        </gen_ForFormulaGenerator>
      </do>
    </gen_ForGenerator>
  </field>
  
  <!-- used by Q6, Q17 -->
  <!-- decimalSize="7,2"-->
  <field name="ss_ext_sales_price" size="7" type="NUMERIC" primary="false">
    <gen_ForGenerator>
       <sameChoiceAs field="ss_promo_sk" generatorByID="numberOfItemsChooser"/>
      <do>
        <gen_ForFormulaGenerator>
          <formula>generator[0] * generator[1]</formula>
          <decimalPlaces roundPlainValue="1">2</decimalPlaces><!-- round formula result-->
          <!--generator[0]-->
          <gen_OtherFieldValueGenerator>
            <reference field="ss_sales_price" />
          </gen_OtherFieldValueGenerator>
          <!--generator[1]-->
          <gen_OtherFieldValueGenerator>
            <reference field="ss_quantity" />
          </gen_OtherFieldValueGenerator>
        </gen_ForFormulaGenerator>
      </do>
    </gen_ForGenerator>
  </field>
  
  <!-- used by Q6 -->
  <!-- decimalSize="7,2"-->
  <field name="ss_ext_wholesale_cost" size="7" type="NUMERIC" primary="false">
    <gen_ForGenerator>
       <sameChoiceAs field="ss_promo_sk" generatorByID="numberOfItemsChooser"/>
      <do>
        <gen_ForFormulaGenerator>
          <formula>generator[0] * generator[1]</formula>
          <decimalPlaces roundPlainValue="1">2</decimalPlaces><!-- round formula result-->
          <!--generator[0]-->
          <gen_OtherFieldValueGenerator>
            <reference field="ss_wholesale_cost" />
          </gen_OtherFieldValueGenerator>
          <!--generator[1]-->
          <gen_OtherFieldValueGenerator>
            <reference field="ss_quantity" />
          </gen_OtherFieldValueGenerator>
        </gen_ForFormulaGenerator>
      </do>
    </gen_ForGenerator>
  </field>
  
  <!-- used by Q6 -->
  <!-- decimalSize="7,2"-->
  <field name="ss_ext_list_price" size="7" type="NUMERIC" primary="false">
    <gen_ForGenerator>
       <sameChoiceAs field="ss_promo_sk" generatorByID="numberOfItemsChooser"/>
      <do>
        <gen_ForFormulaGenerator>
          <formula>generator[0] * generator[1]</formula><!-- round formula result-->
          <decimalPlaces roundPlainValue="1">2</decimalPlaces>
          <!--generator[0]-->
          <gen_OtherFieldValueGenerator>
            <reference field="ss_list_price" />
          </gen_OtherFieldValueGenerator>
          <!--generator[1-->
          <gen_OtherFieldValueGenerator>
            <reference field="ss_quantity" />
          </gen_OtherFieldValueGenerator>
        </gen_ForFormulaGenerator>
      </do>
    </gen_ForGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="ss_ext_tax" size="7" type="NUMERIC" primary="false">
    <gen_ForGenerator>
       <sameChoiceAs field="ss_promo_sk" generatorByID="numberOfItemsChooser"/>
      <do>
        <gen_ForFormulaGenerator>
          <formula>generator[0] * generator[1]</formula>
          <decimalPlaces roundPlainValue="1">2</decimalPlaces><!-- round formula result-->
          <!--generator[0]-->
          <gen_DoubleGenerator>
            <minD>0.00d</minD>
            <maxD>0.09d</maxD>
            <decimalPlaces>2</decimalPlaces>
          </gen_DoubleGenerator>
          <!--generator[1]-->
          <gen_OtherFieldValueGenerator>
            <reference field="ss_net_paid" />
          </gen_OtherFieldValueGenerator>
        </gen_ForFormulaGenerator>
      </do>
    </gen_ForGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="ss_coupon_amt" size="7" type="NUMERIC" primary="false">
    <gen_ForGenerator>
       <sameChoiceAs field="ss_promo_sk" generatorByID="numberOfItemsChooser"/>
      <do>
        <gen_ProbabilityGenerator>
          <probability value="0.8">
            <gen_StaticValueGenerator>
              <value>0.00</value>
            </gen_StaticValueGenerator>
          </probability>
          <probability value="0.2">
            <gen_ForFormulaGenerator>
              <formula>generator[0] * generator[1]</formula>
              <decimalPlaces roundPlainValue="1">2</decimalPlaces>
              <gen_OtherFieldValueGenerator>
                <reference field="ss_ext_sales_price" />
              </gen_OtherFieldValueGenerator>
              <gen_DoubleGenerator>
                <minD>0.00d</minD>
                <maxD>1.00d</maxD>
                <decimalPlaces>2</decimalPlaces>
              </gen_DoubleGenerator>
            </gen_ForFormulaGenerator>
          </probability>
        </gen_ProbabilityGenerator>
      </do>
    </gen_ForGenerator>
  </field>
  
  <!-- used by Q13, Q15, Q17, Q20, Q25 -->
  <!-- decimalSize="7,2"-->
  <field name="ss_net_paid" size="7" type="NUMERIC" primary="false">
    <gen_ForGenerator>
       <sameChoiceAs field="ss_promo_sk" generatorByID="numberOfItemsChooser"/>
      <do>
        <gen_ForFormulaGenerator>
          <formula>generator[0] - generator[1]</formula>
          <decimalPlaces roundPlainValue="1">2</decimalPlaces>
          <!--generator[0]-->
          <gen_OtherFieldValueGenerator>
            <reference field="ss_ext_sales_price" />
          </gen_OtherFieldValueGenerator>
          <!--generator[0]-->
          <gen_OtherFieldValueGenerator>
            <reference field="ss_coupon_amt" />
          </gen_OtherFieldValueGenerator>
        </gen_ForFormulaGenerator>
      </do>
    </gen_ForGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="ss_net_paid_inc_tax" size="7" type="NUMERIC" primary="false">
    <gen_ForGenerator>
       <sameChoiceAs field="ss_promo_sk" generatorByID="numberOfItemsChooser"/>
      <do>
        <gen_ForFormulaGenerator>
          <formula>generator[0] + generator[1]</formula>
          <decimalPlaces roundPlainValue="1">2</decimalPlaces>
          <gen_OtherFieldValueGenerator>
          <reference field="ss_net_paid" />
            </gen_OtherFieldValueGenerator>
          <gen_OtherFieldValueGenerator>
            <reference field="ss_ext_tax" />
          </gen_OtherFieldValueGenerator>
        </gen_ForFormulaGenerator>
      </do>
    </gen_ForGenerator>
  </field>
  
  <!-- used by Q9 -->
  <!-- decimalSize="7,2"-->
  <field name="ss_net_profit" size="7" type="NUMERIC" primary="false">
    <gen_ForGenerator>
       <sameChoiceAs field="ss_promo_sk" generatorByID="numberOfItemsChooser"/>
      <do>
       <gen_ForFormulaGenerator>
        <formula>generator[0] - generator[1]</formula>
        <decimalPlaces roundPlainValue="1">2</decimalPlaces>
        <gen_OtherFieldValueGenerator>
         <reference field="ss_net_paid" />
        </gen_OtherFieldValueGenerator>
        <gen_OtherFieldValueGenerator>
         <reference field="ss_ext_wholesale_cost" />
        </gen_OtherFieldValueGenerator>
       </gen_ForFormulaGenerator>
      </do>
    </gen_ForGenerator>
  </field>
 </table>
 
 
 
 
 
 <!-- Each row in this table represents a single lineitem for the return of an item sold through the store channel and recorded in the store_returns fact table -->
 <table name="store_returns">
  <size>${store_returns_size}</size>
  
  <!-- used by Q19, Q20, Q21 -->
  <!-- FK d_date_sk -->
  <field name="sr_returned_date_sk" size="19" type="BIGINT" primary="false">
    <gen_FormulaGenerator>
     <formula>(long)generator[0] + parent.getRandomSample(0L, (long) (${SR_MAX_RETURN_DAYS_AFTER_PURCHASE}), random)</formula>
     <decimalPlaces>0</decimalPlaces>
     <gen_ReferenceGenerator choose="sameChoiceAs" from="">
      <sameChoiceAs field="sr_ticket_number" generatorByID="orderChooser"/>
      <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="store_sales" field="ss_sold_date_sk" />
     </gen_ReferenceGenerator>
    </gen_FormulaGenerator>
  </field>
  
  <!-- FK t_time_sk -->
  <field name="sr_return_time_sk" size="19" type="BIGINT" primary="false">
  <!-- TODO: check: makes more sense if return time is the same (returned items arrive in one package at same time)-->
   <gen_ForGenerator>
    <sameChoiceAs field="sr_item_sk" generatorByID="listIndexChooser" />
    <do>
      <gen_ReferenceGenerator choose="random" from="historical">
       <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="time_dim" field="t_time_sk" />
      </gen_ReferenceGenerator>
    </do>
   </gen_ForGenerator>
  </field>
  
  <!-- used by Q19, Q20, Q21 -->
  <!-- FK i_item_sk,ss_item_sk -->
  <field name="sr_item_sk" size="19" type="BIGINT" primary="true">
   <gen_RandomListItemsGenerator id="listIndexChooser">
    <gen_ReferenceGenerator choose="sameChoiceAs" from="">
     <sameChoiceAs field="sr_ticket_number" generatorByID="orderChooser"/>
     <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="store_sales" field="ss_item_sk" />
    </gen_ReferenceGenerator>
   </gen_RandomListItemsGenerator>
  </field>
  
  <!-- used by Q20, Q21 -->
  <!-- FK c_customer_sk -->
  <field name="sr_customer_sk" size="19" type="BIGINT" primary="false">
   <gen_ProbabilityGenerator id="isGiftChooser">
    <probability value="1 - ${SR_SAME_CUSTOMER}">
      <gen_ReferenceGenerator choose="random" from="historical">
       <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer" field="c_customer_sk" />
      </gen_ReferenceGenerator>
    </probability>
    <probability value="${SR_SAME_CUSTOMER}">
      <gen_ReferenceGenerator choose="sameChoiceAs" from="">
       <sameChoiceAs field="sr_ticket_number" generatorByID="orderChooser"/>
       <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="store_sales" field="ss_customer_sk" />
      </gen_ReferenceGenerator>
    </probability>
   </gen_ProbabilityGenerator>
  </field>
  
  <!-- FK cd_demo_sk -->
  <field name="sr_cdemo_sk" size="19" type="BIGINT" primary="false" nullable="true">
   <gen_ProbabilityGenerator>
    <sameChoiceAs field="sr_customer_sk" generatorByID="isGiftChooser"/>
    <probability value="1 - ${SR_SAME_CUSTOMER}">
     <gen_NullGenerator probability="${NULL_CHANCE}">
      <gen_ReferenceGenerator choose="random" from="historical">
       <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer_demographics" field="cd_demo_sk" />
      </gen_ReferenceGenerator>
     </gen_NullGenerator>
    </probability>
    <probability value="${SR_SAME_CUSTOMER}">
     <gen_NullGenerator probability="${NULL_CHANCE}">
      <gen_ReferenceGenerator choose="sameChoiceAs" from="">
       <sameChoiceAs field="sr_ticket_number" generatorByID="orderChooser"/>
       <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="store_sales" field="ss_cdemo_sk" /><!-- reference result can be null -->
      </gen_ReferenceGenerator>
     </gen_NullGenerator>
    </probability>
   </gen_ProbabilityGenerator>
  </field>
  
  <!-- FK hd_demo_sk -->
  <field name="sr_hdemo_sk" size="19" type="BIGINT" primary="false" nullable="true">
   <gen_ProbabilityGenerator>
    <sameChoiceAs field="sr_customer_sk" generatorByID="isGiftChooser"/>
    <probability value="1 - ${SR_SAME_CUSTOMER}">
     <gen_NullGenerator probability="${NULL_CHANCE}">
      <gen_ReferenceGenerator choose="random" from="historical">
       <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="household_demographics" field="hd_demo_sk" /> 
      </gen_ReferenceGenerator>
     </gen_NullGenerator>
    </probability>
    <probability value="${SR_SAME_CUSTOMER}">
     <gen_NullGenerator probability="${NULL_CHANCE}">
      <gen_ReferenceGenerator choose="sameChoiceAs" from="">
       <sameChoiceAs field="sr_ticket_number" generatorByID="orderChooser"/>
       <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="store_sales" field="ss_hdemo_sk" /> <!-- reference result can be null -->
      </gen_ReferenceGenerator>
     </gen_NullGenerator>
    </probability>
   </gen_ProbabilityGenerator>
  </field>
  
  <!-- FK ca_address_sk -->
  <field name="sr_addr_sk" size="19" type="BIGINT" primary="false">
   <gen_ProbabilityGenerator>
    <sameChoiceAs field="sr_customer_sk" generatorByID="isGiftChooser"/>
    <probability value="1 - ${SR_SAME_CUSTOMER}">
     <gen_NullGenerator probability="${NULL_CHANCE}">
      <gen_ReferenceGenerator choose="random" from="historical">
       <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer_address" field="ca_address_sk" />
      </gen_ReferenceGenerator>
     </gen_NullGenerator>
    </probability>
    <probability value="${SR_SAME_CUSTOMER}">
     <gen_NullGenerator probability="${NULL_CHANCE}">
      <gen_ReferenceGenerator choose="sameChoiceAs" from="">
       <sameChoiceAs field="sr_ticket_number" generatorByID="orderChooser"/>
       <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="store_sales" field="ss_addr_sk" />
      </gen_ReferenceGenerator>
     </gen_NullGenerator>
    </probability>
   </gen_ProbabilityGenerator>
  </field>
  
  <!-- FK s_store_sk -->
  <field name="sr_store_sk" size="19" type="BIGINT" primary="false">
    <gen_ReferenceGenerator choose="sameChoiceAs" from="">
     <sameChoiceAs field="sr_ticket_number" generatorByID="orderChooser"/>
     <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="store_sales" field="ss_store_sk" />
    </gen_ReferenceGenerator>
  </field>
  
  <!-- FK r_reason_sk -->
  <field name="sr_reason_sk" size="19" type="BIGINT" primary="false">
   <gen_ForGenerator>
    <sameChoiceAs field="sr_item_sk" generatorByID="listIndexChooser" />
    <do>
     <gen_NullGenerator probability="${NULL_CHANCE}">
      <gen_ReferenceGenerator choose="random" from="historical">
       <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="reason" field="r_reason_sk" />
      </gen_ReferenceGenerator>
     </gen_NullGenerator>
    </do>
   </gen_ForGenerator>
  </field>
  
  <!-- used by Q20, Q21 -->
  <!-- FK ss_ticket_number -->
  <field name="sr_ticket_number" size="19" type="BIGINT" primary="false">
   <gen_PermutationReferenceGenerator id="orderChooser">
    <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="store_sales" field="ss_ticket_number" />
   </gen_PermutationReferenceGenerator>
  </field>
  
  <!-- used by Q19, Q21 -->
  <field name="sr_return_quantity" size="10" type="INTEGER" primary="false">
  <!-- random number of itmes from ss_quantity -->
   <gen_ExtendedFormulaGenerator>
    <formula>parent.getRandomSample(1l, (long) generator[0], random)</formula>
    <decimalPlaces>0</decimalPlaces>
    <gen_RandomListItemsGenerator>
     <sameChoiceAs field="sr_item_sk" generatorByID="listIndexChooser" />
     <gen_ReferenceGenerator choose="sameChoiceAs" from="">
      <sameChoiceAs field="sr_ticket_number" generatorByID="orderChooser"/>
      <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="store_sales" field="ss_quantity" />
     </gen_ReferenceGenerator>
    </gen_RandomListItemsGenerator>
   </gen_ExtendedFormulaGenerator>
  </field>
  
  <!-- used by Q20 -->
  <!-- decimalSize="7,2"-->
  <field name="sr_return_amt" size="7" type="NUMERIC" primary="false">
  <!-- alias: ext_sales_price, net_paid -->
   <!-- Formula: ss_sales_price * sr_return_quantity -->
    <gen_ExtendedFormulaGenerator>
      <formula>generator[0] * generator[1]</formula>
      <decimalPlaces>2</decimalPlaces>
      <!-- generator[0] -->
      <gen_RandomListItemsGenerator>
        <sameChoiceAs field="sr_item_sk" generatorByID="listIndexChooser" />
        <gen_ReferenceGenerator choose="sameChoiceAs" from="">
          <sameChoiceAs field="sr_ticket_number" generatorByID="orderChooser"/>
          <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="store_sales" field="ss_sales_price" />
        </gen_ReferenceGenerator>
      </gen_RandomListItemsGenerator>
      <!-- generator[1] -->
      <gen_OtherFieldValueGenerator>
        <reference field="sr_return_quantity" />
      </gen_OtherFieldValueGenerator>
    </gen_ExtendedFormulaGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="sr_return_tax" size="7" type="NUMERIC" primary="false">
    <!-- alias: ext_tax -->
    <!-- Formula: sr_return_amt * tax_pct -->
    <!-- TODO: where should tax_pct come from????? -->
    <gen_ExtendedFormulaGenerator>
      <formula>generator[0] * generator[1]</formula>
      <decimalPlaces>2</decimalPlaces>
      <!-- generator[0] -->
      <gen_DoubleGenerator>
        <minD>0.00d</minD>
        <maxD>0.09d</maxD>
        <decimalPlaces>2</decimalPlaces>
      </gen_DoubleGenerator>
      <!-- generator[1] -->
      <gen_OtherFieldValueGenerator>
        <reference field="sr_return_amt" />
      </gen_OtherFieldValueGenerator>
    </gen_ExtendedFormulaGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="sr_return_amt_inc_tax" size="7" type="NUMERIC" primary="false">
    <!-- alias: net_paid_inc_tax-->
    <!-- sr_return_amt + sr_return_tax -->
    <gen_ExtendedFormulaGenerator>
      <formula>generator[0] + generator[1]</formula>
      <decimalPlaces>2</decimalPlaces>
      <gen_OtherFieldValueGenerator>
        <reference field="sr_return_amt" />
      </gen_OtherFieldValueGenerator>
      <gen_OtherFieldValueGenerator>
        <reference field="sr_return_tax" />
      </gen_OtherFieldValueGenerator>
    </gen_ExtendedFormulaGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="sr_fee" size="7" type="NUMERIC" primary="false">
    <gen_ForGenerator>
      <sameChoiceAs field="sr_item_sk" generatorByID="listIndexChooser" />
      <do>
        <gen_DoubleGenerator>
          <minD>0.50d</minD>
          <maxD>100.00d</maxD>
          <decimalPlaces>2</decimalPlaces>
        </gen_DoubleGenerator>
      </do>
    </gen_ForGenerator>
    </field>
  
  <!-- decimalSize="7,2"-->
  <field name="sr_return_ship_cost" size="7" type="NUMERIC" primary="false">
    <!-- alias: ext_shipping_cost-->
    <!-- 
    shipping = rand[0.0, 0.5]
    shipping_cost = list_price * shipping
    ext_shipping_cost = shipping_cost * quantity 
    ext_shipping_cost = list_price * shipping * quantity
    ext_shipping_cost = ss_list_price * shipping(randDecimal[0.00, 1.00] * sr_return_quantity

    -->
    <gen_ExtendedFormulaGenerator>
      <formula>generator[0] * generator[1] *  generator[2]</formula>
      <decimalPlaces>2</decimalPlaces>
      <!-- generator[0] ss_list_price-->
      <gen_RandomListItemsGenerator>
        <sameChoiceAs field="sr_item_sk" generatorByID="listIndexChooser" />
        <gen_ReferenceGenerator choose="sameChoiceAs" from="">
          <sameChoiceAs field="sr_ticket_number" generatorByID="orderChooser"/>
          <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="store_sales" field="ss_list_price" />
        </gen_ReferenceGenerator>
      </gen_RandomListItemsGenerator>
      <!-- generator[1] shipping -->
      <gen_DoubleGenerator>
        <minD>0.00d</minD>
        <maxD>1.00d</maxD>
        <decimalPlaces>2</decimalPlaces>
      </gen_DoubleGenerator>
      <!-- generator[2] quantity -->
      <gen_OtherFieldValueGenerator>
        <reference field="sr_return_quantity" />
      </gen_OtherFieldValueGenerator>
    </gen_ExtendedFormulaGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="sr_refunded_cash" size="7" type="NUMERIC" primary="false">
    <!-- rand[0.0,1.0] * netPaid == rand[0.0,1.0] * sr_return_amt -->
    <gen_ExtendedFormulaGenerator>
      <formula>generator[0] * generator[1]</formula>
      <decimalPlaces>2</decimalPlaces>
      <!-- generator[0] -->
      <gen_DoubleGenerator>
        <minD>0.00d</minD>
        <maxD>1.00d</maxD>
      <decimalPlaces>2</decimalPlaces>
      </gen_DoubleGenerator>
      <!-- generator[1] -->
      <gen_OtherFieldValueGenerator>
      	<reference field="sr_return_amt" />
      </gen_OtherFieldValueGenerator>
    </gen_ExtendedFormulaGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="sr_reversed_charge" size="7" type="NUMERIC" primary="false">
    <!-- same ss_reversed_charge-->
    <!-- rand[0.01, 1.00] * (net_paid - refunded_cash) -->
    <!-- rand[0.01, 1.00] * (sr_return_amt - sr_refunded_cash) -->
    <gen_ExtendedFormulaGenerator>
      <formula>generator[0] * (generator[1]  - generator[2])</formula>
      <decimalPlaces>2</decimalPlaces>
      <!-- generator[0] -->    
      <gen_DoubleGenerator>
        <minD>0.01d</minD>
        <maxD>1.00d</maxD>
      <decimalPlaces>2</decimalPlaces>
      </gen_DoubleGenerator>
      <!-- generator[1] -->
      <gen_OtherFieldValueGenerator>
        <reference field="sr_return_amt" />
      </gen_OtherFieldValueGenerator>
      <!-- generator[2] -->
      <gen_OtherFieldValueGenerator>
        <reference field="sr_refunded_cash" />
      </gen_OtherFieldValueGenerator>
    </gen_ExtendedFormulaGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="sr_store_credit" size="7" type="NUMERIC" primary="false">
    <!-- same ss_store_credit-->
    <!-- net_paid - reversed_charge - refunded_cash    -->
    <!-- sr_return_amt - sr_reversed_charge - sr_refunded_cash    -->

    <gen_ExtendedFormulaGenerator>
      <formula>generator[0]  - generator[1] - generator[2]</formula>
      <decimalPlaces>2</decimalPlaces>
      <!-- generator[0] -->
      <gen_OtherFieldValueGenerator>
        <reference field="sr_return_amt" />
      </gen_OtherFieldValueGenerator>
      <!-- generator[1] -->
      <gen_OtherFieldValueGenerator>
        <reference field="sr_reversed_charge" />
      </gen_OtherFieldValueGenerator>
      <!-- generator[2] -->
      <gen_OtherFieldValueGenerator>
        <reference field="sr_refunded_cash" />
      </gen_OtherFieldValueGenerator>
    </gen_ExtendedFormulaGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="sr_net_loss" size="7" type="NUMERIC" primary="false">
    <!--  
    sr_return_ship_cost = ext_shipping_cost = shipping_cost * quantity
    net_paid_inc_ship = net_paid(sr_return_amt) + ext_shipping_cost 
    sr_return_tax = ext_tax = tax * net_paid 
    net_paid_inc_ship_tax = net_paid_inc_ship + ext_tax

    sr_net_loss = net_paid_inc_ship_tax  -store_credit - refunded_cash - reversed_charge + fee
    subistute sr_net_loss formula componets with above formulas: 
    sr_net_loss = sr_return_amt + sr_return_ship_cost  + sr_return_tax - sr_store_credit - sr_refunded_cash - sr_reversed_charge + sr_fee
    -->
    <gen_ExtendedFormulaGenerator>
      <formula>generator[0] + generator[1] + generator[2] - generator[3] - generator[4] - generator[5] + generator[2]</formula>
      <decimalPlaces>2</decimalPlaces>
      <!-- generator[0] -->
      <gen_OtherFieldValueGenerator>
        <reference field="sr_return_amt" />
      </gen_OtherFieldValueGenerator>
      <!-- generator[1] -->
      <gen_OtherFieldValueGenerator>
        <reference field="sr_return_ship_cost" />
      </gen_OtherFieldValueGenerator>
      <!-- generator[2] -->
      <gen_OtherFieldValueGenerator>
        <reference field="sr_return_tax" />
      </gen_OtherFieldValueGenerator>
      <!-- generator[3] -->
      <gen_OtherFieldValueGenerator>
        <reference field="sr_store_credit" />
      </gen_OtherFieldValueGenerator>
      <!-- generator[4] -->
      <gen_OtherFieldValueGenerator>
        <reference field="sr_refunded_cash" />
      </gen_OtherFieldValueGenerator>
      <!-- generator[5] -->
      <gen_OtherFieldValueGenerator>
        <reference field="sr_reversed_charge" />
      </gen_OtherFieldValueGenerator>
      <!-- generator[6 -->
      <gen_OtherFieldValueGenerator>
        <reference field="sr_fee" />
      </gen_OtherFieldValueGenerator>
    </gen_ExtendedFormulaGenerator>
  </field>
 </table>






 <!-- Each row in this table represents a single lineitem for a sale made through the web channel and recorded in the web_sales fact table -->
 <table name="web_sales">
  <size>${web_sales_size}</size>
  
  <!-- used by Q6, Q8, Q11, Q13, Q16, Q21, Q24, Q25 -->
  <!-- FK d_date_sk -->
  <field name="ws_sold_date_sk" size="19" type="BIGINT" primary="false">
    <gen_FormulaGenerator>
    <formula>${web_sales_days_since_date_begin_date} + Math.floor(gc.getID() * ((${web_sales_days_within} - 1) / ${web_sales_size}))</formula>
    <decimalPlaces>0</decimalPlaces>
   </gen_FormulaGenerator>
  </field>
  
  <!-- used by Q14 -->
  <!-- FK t_time_sk -->
  <field name="ws_sold_time_sk" size="19" type="BIGINT" primary="false">
    <gen_ReferenceGenerator choose="random" from="historical">
     <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="time_dim" field="t_time_sk" />
    </gen_ReferenceGenerator>
  </field>
  
  <!-- FK d_date_sk -->
  <field name="ws_ship_date_sk" size="19" type="BIGINT" primary="false">
   <gen_ForGenerator>
    <sameChoiceAs field="ws_promo_sk" generatorByID="numberOfItemsChooser"/>
    <do>
      <gen_FormulaGenerator>
       <formula>generator[0] + generator[1]</formula>
       <gen_OtherFieldValueGenerator>
        <reference field="ws_sold_date_sk" />
       </gen_OtherFieldValueGenerator>
       <gen_LongGenerator>
        <min>${WS_MIN_SHIP_DELAY}</min>
        <max>${WS_MAX_SHIP_DELAY}</max>
       </gen_LongGenerator>
       <decimalPlaces>0</decimalPlaces>
      </gen_FormulaGenerator>
    </do>
   </gen_ForGenerator>
  </field>
  
  <!-- used by Q11, Q16, Q21, Q24, Q29 -->
  <!-- FK i_item_sk,wr_item_sk -->
  <field name="ws_item_sk" size="19" type="BIGINT" primary="true">
    <!-- we have to satisfy many query reqirements here: 
    1) a query may choose to select a single random item_sk and do analytics on this item => ensure that each item gets sold at least once.
    2) a query may search for "frequently sold" and "frequently sold together" relations, so we need to ensure to have good selling items while still satisfying 1)
    3) a query may compare sales channels, so web-sales must have roughly the same sales charateristics
    -->
    <!-- "ForGenerator" is inside of Probabitly choice, because we want high frequency itmes to be "SOLD TOGETHER" not just appearing mor frequent over all purchases -->
    <!-- because of this modeling, ss_item_sk no longer determines the number of items per order, this responsibility is switched over to ss_promo_sk (PDGF'S reference system will ensure correctness even if ss_promo_sk is defined after ss_item_sk) --> 
      
      <!-- purchase i items together in the same purchase (list of items will be expanded by custom output plugin in bigbench-generation.xml to multiple lines in the final table) -->
      <gen_ForGenerator id="uniform_numberOfItemsChooser">
        <sameChoiceAs field="ws_promo_sk" generatorByID="numberOfItemsChooser"/>
        <do>
           <gen_ProbabilityGenerator>
              <!-- uniform random -->
              <!-- ${staticPurchasedItems_Ratio} relates to the total number of sold items => translate to fraction of a fraction -->
              <probability value="1.0 - ( ${staticPurchasedItems_Ratio} + ${nonUniformyPurchasedItems_Ratio} )">
                  <gen_ReferenceGenerator id="uniform_itemChooser" choose="random" from="historical" > 
                    <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="item" field="i_item_sk" />
                  </gen_ReferenceGenerator>
              </probability>
              
              <probability value=" ${staticPurchasedItems_Ratio}">
                <gen_ReferenceGenerator id="uniform_itemChooser" choose="idFromSubGenerator" from="historical" > 
                   <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="item" field="i_item_sk" />          
                   <!-- sub generator that chooses the item_sk id -->      
                   <gen_LongGenerator>
                    <min>10000</min>
                    <max>10003</max>
                   </gen_LongGenerator> 
                </gen_ReferenceGenerator>
              </probability>
            
              <probability value="${nonUniformyPurchasedItems_Ratio}">
                <gen_ReferenceGenerator id="nonUniform_itemChooser" choose="randomPermuted" from="historical" > 
                  <distribution name="Normal" mean="${item_size} / 2 " sd="${nonUniformyPurchasedItems_SD_BASE}*${SF_log_5}"/> <!-- 68% of all values are within [-sd, sd] and 99.7% are within [-3*sd, 3*sd] -->
                  <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="item" field="i_item_sk" />
                  <!-- ws_item_sk and ss_item_sk ReferenceGenerator use the same fixed permutation => they will compute the same permutation in 'randomPermuted' mode and thus picking the same items with the same frequency. -->
                  <!--Alternativly to the 'samePermutationAs' node you cold add  a 'seed="123456789L" attribute to the  <gen_ReferenceGenerator>'s  of both ws_item_sk and ss_item_sk, which would result in them both computing the same permutation from the same seed. -->
                  <samePermutationAs table="store_sales" field="ss_item_sk" generatorByID="nonUniform_itemChooser"/>
                </gen_ReferenceGenerator>
              </probability>
          
          </gen_ProbabilityGenerator>
          
        </do>
      </gen_ForGenerator>
  </field>
  
  <!-- used by Q6, Q13, Q21, Q25, Q29 -->
  <!-- FK c_customer_sk -->
  <field name="ws_bill_customer_sk" size="19" type="BIGINT" primary="false">
    <!-- Modeling: every customer_sk has purchases (the customer registered, so he has purchases) To achieve this, a fraction of all sales is distributed evenly accross all customers-->
    <!-- After some minimal purchase activiy per customer is ensured, we select some higly active customers using a normal distribution. -->
    <gen_ProbabilityGenerator id="customerDistributionChooser">
      <probability value="1.0 - ${nonUniformyCustomerPurchases_Ratio}">
        <gen_ReferenceGenerator choose="random" from="historical" id="customerChooser_uniform">
          <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer" field="c_customer_sk" />
        </gen_ReferenceGenerator>
      </probability>
      <probability value="${nonUniformyCustomerPurchases_Ratio}">
        <gen_ReferenceGenerator choose="randomPermuted" from="historical" id="customerChooser_nonUniform">
          <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer" field="c_customer_sk" />
          <distribution name="Normal" mean="${customer_size} / 2 " sd="${nonUniformyCustomerPurchases_SD_BASE}*${SF_log_5}"/> <!-- 68% of all values are within [-sd, sd] and 99.7% are within [-3*sd, 3*sd] -->
           <!-- ws_bill_customer_sk and ss_customer_sk ReferenceGenerator use the same fixed permutation => they will compute the same permutation in 'randomPermuted' mode and thus picking the same customers with the same frequency. -->
           <!-- Alternativly to the 'samePermutationAs' node you cold add  a 'seed="123456789L" attribute to the  <gen_ReferenceGenerator>'s  of both ws_bill_customer_sk and ss_customer_sk, which would result in them both computing the same permutation from the same seed. -->
           <!-- Its somewhat illogical for the "high frequency purchaser" customers to be equaly most active on both sales channels (web/store), but the workload demands such modeling, because it tries to find customers that bought something from a store, returned it and later purchased it in web.
           There is only a very little chance of that happening in random and its almost impossible to happen with small scalefactors. Without explicitly modeling such "customer behaviour groups" the only way to "ensure" this to happen is for the moste active web buyers to be also the most active store-buyers, increasing the chance to "return store sale and repurchase through web" -->
           <samePermutationAs table="store_sales" field="ss_customer_sk" generatorByID="customerChooser_nonUniform"/>
        </gen_ReferenceGenerator>
      </probability>
    </gen_ProbabilityGenerator>
  </field>

  
  <!-- FK cd_demo_sk -->
  <field name="ws_bill_cdemo_sk" size="19" type="BIGINT" primary="false" nullable="true"> 
    <gen_NullGenerator probability="${NULL_CHANCE}">
       <gen_ProbabilityGenerator>
          <sameChoiceAs field="ws_bill_customer_sk" generatorByID="customerDistributionChooser"/>
          <probability value="1.0 - ${nonUniformyCustomerPurchases_Ratio}">
            <gen_ReferenceGenerator choose="sameChoiceAs" from="">
              <sameChoiceAs field="ws_bill_customer_sk" generatorByID="customerChooser_uniform"/>
              <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer" field="c_current_cdemo_sk" /><!-- reference result can be null -->
            </gen_ReferenceGenerator>
         </probability>
         <probability value="${nonUniformyCustomerPurchases_Ratio}">
            <gen_ReferenceGenerator choose="sameChoiceAs" from="">
              <sameChoiceAs field="ws_bill_customer_sk" generatorByID="customerChooser_nonUniform"/>
              <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer" field="c_current_cdemo_sk" /><!-- reference result can be null -->
            </gen_ReferenceGenerator>
         </probability>
       </gen_ProbabilityGenerator>
    </gen_NullGenerator>
  </field>
  
  <!-- FK hd_demo_sk -->
  <field name="ws_bill_hdemo_sk" size="19" type="BIGINT" primary="false" nullable="true">
    <gen_NullGenerator probability="${NULL_CHANCE}">
       <gen_ProbabilityGenerator>
          <sameChoiceAs field="ws_bill_customer_sk" generatorByID="customerDistributionChooser"/>
          <probability value="1.0 - ${nonUniformyCustomerPurchases_Ratio}">
            <gen_ReferenceGenerator choose="sameChoiceAs" from="">
              <sameChoiceAs field="ws_bill_customer_sk" generatorByID="customerChooser_uniform"/>
              <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer" field="c_current_hdemo_sk" /><!-- reference result can be null -->
            </gen_ReferenceGenerator>
         </probability>
         <probability value="${nonUniformyCustomerPurchases_Ratio}">
            <gen_ReferenceGenerator choose="sameChoiceAs" from="">
              <sameChoiceAs field="ws_bill_customer_sk" generatorByID="customerChooser_nonUniform"/>
              <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer" field="c_current_hdemo_sk" /><!-- reference result can be null -->
            </gen_ReferenceGenerator>
         </probability>
       </gen_ProbabilityGenerator>
    </gen_NullGenerator>  
  </field>
  
  <!-- FK ca_address_sk -->
  <field name="ws_bill_addr_sk" size="19" type="BIGINT" primary="false">
     <!-- the purchasing customer recieves the bill  -->
     <gen_ProbabilityGenerator>
        <sameChoiceAs field="ws_bill_customer_sk" generatorByID="customerDistributionChooser"/>
        <probability value="1.0 - ${nonUniformyCustomerPurchases_Ratio}">
          <gen_ReferenceGenerator choose="sameChoiceAs" from="">
            <sameChoiceAs field="ws_bill_customer_sk" generatorByID="customerChooser_uniform"/>
            <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}"  table="customer" field="c_current_addr_sk" /><!-- reference result can be null -->
          </gen_ReferenceGenerator>
       </probability>
       <probability value="${nonUniformyCustomerPurchases_Ratio}">
          <gen_ReferenceGenerator choose="sameChoiceAs" from="">
            <sameChoiceAs field="ws_bill_customer_sk" generatorByID="customerChooser_nonUniform"/>
            <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer" field="c_current_addr_sk" /><!-- reference result can be null -->
          </gen_ReferenceGenerator>
       </probability>
     </gen_ProbabilityGenerator>
  </field>
  
  <!-- FK c_customer_sk -->
  <field name="ws_ship_customer_sk" size="19" type="BIGINT" primary="false" nullable="true">
    <!-- if item is a gift: ship to different random customer. else: ship to address of purchasing customer -->
   <gen_ProbabilityGenerator id="isGiftChooser">
    <probability value="${WS_GIFT_PCT}">
      <gen_ReferenceGenerator choose="random" from="historical" id="giftBillCustomerChooser">
       <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer" field="c_customer_sk" />
      </gen_ReferenceGenerator>
    </probability>
    <probability value="1 - ${WS_GIFT_PCT}">
      <gen_OtherFieldValueGenerator>
       <reference field="ws_bill_customer_sk" />
      </gen_OtherFieldValueGenerator>
    </probability>
   </gen_ProbabilityGenerator>
  </field>
  
  <!-- FK cd_demo_sk -->
  <field name="ws_ship_cdemo_sk" size="19" type="BIGINT" primary="false" nullable="true">
   <gen_ProbabilityGenerator>
    <sameChoiceAs field="ws_ship_customer_sk" generatorByID="isGiftChooser"/>
    <probability value="${WS_GIFT_PCT}">
     <gen_NullGenerator probability="${NULL_CHANCE}">
       <gen_ReferenceGenerator choose="sameChoiceAs" from="">
         <sameChoiceAs field="ws_ship_customer_sk" generatorByID="giftBillCustomerChooser"/>
         <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer" field="c_current_cdemo_sk" /><!-- reference result can be null -->
       </gen_ReferenceGenerator>
     </gen_NullGenerator>
    </probability>
    <probability value="1 - ${WS_GIFT_PCT}">
     <gen_NullGenerator probability="${NULL_CHANCE}">
      <gen_OtherFieldValueGenerator>
       <reference field="ws_bill_cdemo_sk" /><!-- reference result can be null -->
      </gen_OtherFieldValueGenerator>
     </gen_NullGenerator>
    </probability>
   </gen_ProbabilityGenerator>
  </field>
  
  <!-- used by Q14 -->
  <!-- FK hd_demo_sk -->
  <field name="ws_ship_hdemo_sk" size="19" type="BIGINT" primary="false" nullable="true">
   <gen_ProbabilityGenerator>
    <sameChoiceAs field="ws_ship_customer_sk" generatorByID="isGiftChooser"/>
    <probability value="${WS_GIFT_PCT}">
     <gen_NullGenerator probability="${NULL_CHANCE}">
       <gen_ReferenceGenerator choose="sameChoiceAs" from="">
         <sameChoiceAs field="ws_ship_customer_sk" generatorByID="giftBillCustomerChooser"/>
         <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer" field="c_current_hdemo_sk" /> <!-- reference result can be null -->
       </gen_ReferenceGenerator>
     </gen_NullGenerator>
    </probability>
    <probability value="1 - ${WS_GIFT_PCT}">
     <gen_NullGenerator probability="${NULL_CHANCE}">
      <gen_OtherFieldValueGenerator>
       <reference field="ws_bill_hdemo_sk" /> <!-- reference result can be null -->
      </gen_OtherFieldValueGenerator>
     </gen_NullGenerator>
    </probability>
   </gen_ProbabilityGenerator>
  </field>
  
  <!-- FK ca_address_sk -->
  <field name="ws_ship_addr_sk" size="19" type="BIGINT" primary="false">
   <gen_ProbabilityGenerator>
    <sameChoiceAs field="ws_ship_customer_sk" generatorByID="isGiftChooser"/>
    <probability value="${WS_GIFT_PCT}">
     <gen_NullGenerator probability="${NULL_CHANCE}">
       <gen_ReferenceGenerator choose="sameChoiceAs" from="">
         <sameChoiceAs field="ws_ship_customer_sk" generatorByID="giftBillCustomerChooser"/>
         <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer" field="c_current_addr_sk" />
       </gen_ReferenceGenerator>
     </gen_NullGenerator>
    </probability>
    <probability value="1 - ${WS_GIFT_PCT}">
     <gen_NullGenerator probability="${NULL_CHANCE}">
      <gen_OtherFieldValueGenerator>
       <reference field="ws_bill_addr_sk" />
      </gen_OtherFieldValueGenerator>
     </gen_NullGenerator>
    </probability>
   </gen_ProbabilityGenerator>
  </field>
  
  <!-- used by Q14 -->
  <!-- FK wp_web_page_sk -->
  <field name="ws_web_page_sk" size="19" type="BIGINT" primary="false">
   <gen_ForGenerator>
    <sameChoiceAs field="ws_promo_sk" generatorByID="numberOfItemsChooser"/>
    <do>
     <gen_NullGenerator probability="${NULL_CHANCE}">
      <gen_ReferenceGenerator choose="random" from="historical">
       <!-- web_page (web_page_use=[order, dynamic, ad, general, ..]) choosing is totaly random and does not link to web_sales logic -->
       <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="web_page" field="wp_web_page_sk" />
      </gen_ReferenceGenerator>
     </gen_NullGenerator>
    </do>
   </gen_ForGenerator>
  </field>
  
  <!-- FK web_site_sk -->
  <field name="ws_web_site_sk" size="19" type="BIGINT" primary="false">
   <gen_ForGenerator>
    <sameChoiceAs field="ws_promo_sk" generatorByID="numberOfItemsChooser"/>
    <do>
     <gen_NullGenerator probability="${NULL_CHANCE}">
      <gen_ReferenceGenerator choose="random" from="historical">
       <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="web_site" field="web_site_sk" />
      </gen_ReferenceGenerator>
     </gen_NullGenerator>
    </do>
   </gen_ForGenerator>
  </field>
  
  <!-- FK sm_ship_mode_sk -->
  <field name="ws_ship_mode_sk" size="19" type="BIGINT" primary="false">
    <gen_ForGenerator>
      <sameChoiceAs field="ws_promo_sk" generatorByID="numberOfItemsChooser"/>
      <do>
        <gen_NullGenerator probability="${NULL_CHANCE}">
          <gen_ReferenceGenerator choose="random" from="historical">
            <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="ship_mode" field="sm_ship_mode_sk" />
          </gen_ReferenceGenerator>
        </gen_NullGenerator>
      </do>
    </gen_ForGenerator>
  </field>
  
  <!-- used by Q16, Q22 -->
  <!-- FK w_warehouse_sk -->
  <field name="ws_warehouse_sk" size="19" type="BIGINT" primary="false">
    <gen_ForGenerator>
      <sameChoiceAs field="ws_promo_sk" generatorByID="numberOfItemsChooser"/>
      <do>
        <gen_NullGenerator probability="${NULL_CHANCE}">
          <gen_ReferenceGenerator choose="random" from="historical">
            <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="warehouse" field="w_warehouse_sk" />
          </gen_ReferenceGenerator>
        </gen_NullGenerator>
      </do>
    </gen_ForGenerator>
  </field>
  
  <!-- FK p_promo_sk -->
  <field name="ws_promo_sk" size="19" type="BIGINT" primary="false">
    <gen_ForGenerator id ="numberOfItemsChooser">
      <i>
        <gen_LongGenerator>
          <min>${WS_ITEMS_PER_ORDER_MIN}</min>
          <max>${WS_ITEMS_PER_ORDER_MAX}</max>
        </gen_LongGenerator>
      </i>

      <do>
        <gen_NullGenerator probability="${NULL_CHANCE}">
          <gen_ReferenceGenerator choose="random" from="historical">
            <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="promotion" field="p_promo_sk" />
          </gen_ReferenceGenerator>
        </gen_NullGenerator>
      </do>
    </gen_ForGenerator>
  </field>
  
  <!-- used by Q16, Q25 -->
  <!-- FK wr_order_number ??? cyclic dependency ws_order_number <=> wr_order_number -->
  <field name="ws_order_number" size="19" type="BIGINT" primary="true">
    <gen_IdGenerator> <min>${SK_ID_OFFSET}</min> </gen_IdGenerator>
  </field>
  
  <!-- used by Q21,Q24 -->
  <field name="ws_quantity" size="10" type="INTEGER" primary="false">
   <gen_ForGenerator>
    <sameChoiceAs field="ws_promo_sk" generatorByID="numberOfItemsChooser"/>
    <do>
     <gen_LongGenerator>
      <min>1.0</min>
      <max>${WS_QUANTITY_MAX}</max>
     </gen_LongGenerator>
    </do>
   </gen_ForGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="ws_wholesale_cost" size="7" type="NUMERIC" primary="false">
   <gen_ForGenerator>
    <sameChoiceAs field="ws_promo_sk" generatorByID="numberOfItemsChooser"/>
    <do>
     <gen_DoubleGenerator>
      <minD>1.00d</minD>
      <maxD>${WS_WHOLESALE_MAX}</maxD>
      <decimalPlaces>2</decimalPlaces>
     </gen_DoubleGenerator>
    </do>
   </gen_ForGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="ws_list_price" size="7" type="NUMERIC" primary="false">
    <gen_ForGenerator>
      <sameChoiceAs field="ws_promo_sk" generatorByID="numberOfItemsChooser"/>
      <do>
        <gen_ForFormulaGenerator>
          <formula>generator[0] * (1 + generator[1])</formula>
          <decimalPlaces roundPlainValue="1">2</decimalPlaces>
          <gen_OtherFieldValueGenerator>
            <reference field="ws_wholesale_cost" />
          </gen_OtherFieldValueGenerator>
            <gen_DoubleGenerator>
            <minD>0.00d</minD>
            <maxD>${WS_MARKUP_MAX}</maxD>
            <decimalPlaces>2</decimalPlaces>
          </gen_DoubleGenerator>
        </gen_ForFormulaGenerator>
      </do>
    </gen_ForGenerator>
  </field>
  
  <!-- used by Q16 -->
  <!-- decimalSize="7,2"-->
  <field name="ws_sales_price" size="7" type="NUMERIC" primary="false">
    <gen_ForGenerator>
      <sameChoiceAs field="ws_promo_sk" generatorByID="numberOfItemsChooser"/>
      <do>
        <gen_ForFormulaGenerator>
          <formula>generator[0] * (1 - generator[1])</formula>
          <decimalPlaces roundPlainValue="1">2</decimalPlaces>
          <gen_OtherFieldValueGenerator>
            <reference field="ws_list_price" />
          </gen_OtherFieldValueGenerator>
          <gen_DoubleGenerator>
            <minD>0.00d</minD>
            <maxD>${WS_DISCOUNT_MAX}</maxD>
            <decimalPlaces>2</decimalPlaces>
          </gen_DoubleGenerator>
        </gen_ForFormulaGenerator>
      </do>
    </gen_ForGenerator>
  </field>
  
  <!-- used by Q6 -->
  <!-- decimalSize="7,2"-->
  <field name="ws_ext_discount_amt" size="7" type="NUMERIC" primary="false">
    <gen_ForGenerator>
      <sameChoiceAs field="ws_promo_sk" generatorByID="numberOfItemsChooser"/>
      <do>
        <gen_ForFormulaGenerator>
          <formula>generator[0] - generator[1]</formula>
          <decimalPlaces roundPlainValue="1">2</decimalPlaces>
          <gen_OtherFieldValueGenerator>
            <reference field="ws_ext_list_price" />
          </gen_OtherFieldValueGenerator>
          <gen_OtherFieldValueGenerator>
            <reference field="ws_ext_sales_price" />
          </gen_OtherFieldValueGenerator>
        </gen_ForFormulaGenerator>
      </do>
    </gen_ForGenerator>
  </field>
  
  <!-- used by Q6 -->
  <!-- decimalSize="7,2"-->
  <field name="ws_ext_sales_price" size="7" type="NUMERIC" primary="false">
   <gen_ForGenerator>
    <sameChoiceAs field="ws_promo_sk" generatorByID="numberOfItemsChooser"/>
    <do>
     <gen_ForFormulaGenerator>
      <formula>generator[0] * generator[1]</formula>
      <gen_OtherFieldValueGenerator>
       <reference field="ws_sales_price" />
      </gen_OtherFieldValueGenerator>
      <gen_OtherFieldValueGenerator>
       <reference field="ws_quantity" />
      </gen_OtherFieldValueGenerator>
      <decimalPlaces roundPlainValue="1">2</decimalPlaces>
     </gen_ForFormulaGenerator>
    </do>
   </gen_ForGenerator>
  </field>
  
  <!-- used by Q6 -->
  <!-- decimalSize="7,2"-->
  <field name="ws_ext_wholesale_cost" size="7" type="NUMERIC" primary="false">
   <gen_ForGenerator>
    <sameChoiceAs field="ws_promo_sk" generatorByID="numberOfItemsChooser"/>
    <do>
     <gen_ForFormulaGenerator>
      <formula>generator[0] * generator[1]</formula>
      <gen_OtherFieldValueGenerator>
       <reference field="ws_wholesale_cost" />
      </gen_OtherFieldValueGenerator>
      <gen_OtherFieldValueGenerator>
       <reference field="ws_quantity" />
      </gen_OtherFieldValueGenerator>
      <decimalPlaces roundPlainValue="1">2</decimalPlaces>
     </gen_ForFormulaGenerator>
    </do>
   </gen_ForGenerator>
  </field>
  
  <!-- used by Q6 -->
  <!-- decimalSize="7,2"-->
  <field name="ws_ext_list_price" size="7" type="NUMERIC" primary="false">
   <gen_ForGenerator>
    <sameChoiceAs field="ws_promo_sk" generatorByID="numberOfItemsChooser"/>
    <do>
     <gen_ForFormulaGenerator>
      <formula>generator[0] * generator[1]</formula>
      <gen_OtherFieldValueGenerator>
      <reference field="ws_list_price" />
      </gen_OtherFieldValueGenerator>
      <gen_OtherFieldValueGenerator>
       <reference field="ws_quantity" />
      </gen_OtherFieldValueGenerator>
      <decimalPlaces roundPlainValue="1">2</decimalPlaces>
     </gen_ForFormulaGenerator>
    </do>
   </gen_ForGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="ws_ext_tax" size="7" type="NUMERIC" primary="false">
   <gen_ForGenerator>
    <sameChoiceAs field="ws_promo_sk" generatorByID="numberOfItemsChooser"/>
    <do>
     <gen_ForFormulaGenerator>
      <formula>generator[0] * generator[1]</formula>
      <gen_DoubleGenerator>
       <minD>0.00d</minD>
       <maxD>0.09d</maxD>
       <decimalPlaces>2</decimalPlaces>
      </gen_DoubleGenerator>
      <gen_OtherFieldValueGenerator>
       <reference field="ws_net_paid" />
      </gen_OtherFieldValueGenerator>
      <decimalPlaces roundPlainValue="1">2</decimalPlaces>
     </gen_ForFormulaGenerator>
    </do>
   </gen_ForGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="ws_coupon_amt" size="7" type="NUMERIC" primary="false">
    <gen_ForGenerator>
      <sameChoiceAs field="ws_promo_sk" generatorByID="numberOfItemsChooser"/>
      <do>
        <gen_ProbabilityGenerator>
          <probability value="0.8">
            <gen_StaticValueGenerator>
              <value>0.00</value>
            </gen_StaticValueGenerator>
          </probability>
          <probability value="0.2">
            <gen_ForFormulaGenerator>
              <formula>generator[0] * generator[1]</formula>
              <decimalPlaces roundPlainValue="1">2</decimalPlaces>
              <gen_OtherFieldValueGenerator>
                <reference field="ws_ext_sales_price" />
              </gen_OtherFieldValueGenerator>
              <gen_DoubleGenerator>
                <minD>0.00d</minD>
                <maxD>1.00d</maxD>
                <decimalPlaces>2</decimalPlaces>
              </gen_DoubleGenerator>
            </gen_ForFormulaGenerator>
          </probability>
        </gen_ProbabilityGenerator>
      </do>
    </gen_ForGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="ws_ext_ship_cost" size="7" type="NUMERIC" primary="false">
    <!--  ws_list_price * randomDecimal[0.00, 0.50] * ws_quantity-->
    <gen_ForGenerator>
      <sameChoiceAs field="ws_promo_sk" generatorByID="numberOfItemsChooser"/>
      <do>
        <gen_ForFormulaGenerator>
          <formula>generator[0] * generator[1] * generator[2]</formula>
          <decimalPlaces roundPlainValue="1">2</decimalPlaces>
          <gen_OtherFieldValueGenerator>
            <reference field="ws_list_price" />
          </gen_OtherFieldValueGenerator>
          <gen_DoubleGenerator>
            <minD>0.00d</minD>
            <maxD>0.50d</maxD>
            <decimalPlaces>2</decimalPlaces>
          </gen_DoubleGenerator>
            <gen_OtherFieldValueGenerator>
            <reference field="ws_quantity" />
          </gen_OtherFieldValueGenerator>
        </gen_ForFormulaGenerator>
      </do>
    </gen_ForGenerator>
  </field>
  
  <!-- used by Q8, Q11, Q13, Q25 -->
  <!-- decimalSize="7,2"-->
  <field name="ws_net_paid" size="7" type="NUMERIC" primary="false">
  <!-- ws_ext_sales_price -  ws_coupon_amt -->
   <gen_ForGenerator>
    <sameChoiceAs field="ws_promo_sk" generatorByID="numberOfItemsChooser"/>
    <do>
     <gen_ForFormulaGenerator>
      <formula>generator[0] - generator[1]</formula>
      <gen_OtherFieldValueGenerator>
       <reference field="ws_ext_sales_price" />
      </gen_OtherFieldValueGenerator>
      <gen_OtherFieldValueGenerator>
       <reference field="ws_coupon_amt" />
      </gen_OtherFieldValueGenerator>
      <decimalPlaces roundPlainValue="1">2</decimalPlaces>
     </gen_ForFormulaGenerator>
    </do>
   </gen_ForGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="ws_net_paid_inc_tax" size="7" type="NUMERIC" primary="false">
  <!-- ws_net_paid + ws_ext_tax-->
   <gen_ForGenerator>
    <sameChoiceAs field="ws_promo_sk" generatorByID="numberOfItemsChooser"/>
    <do>
     <gen_ForFormulaGenerator>
      <formula>generator[0] + generator[1]</formula>
      <gen_OtherFieldValueGenerator>
       <reference field="ws_net_paid" />
      </gen_OtherFieldValueGenerator>
      <gen_OtherFieldValueGenerator>
       <reference field="ws_ext_tax" />
      </gen_OtherFieldValueGenerator>
      <decimalPlaces roundPlainValue="1">2</decimalPlaces>
     </gen_ForFormulaGenerator>
    </do>
   </gen_ForGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="ws_net_paid_inc_ship" size="7" type="NUMERIC" primary="false">
  <!-- ws_net_paid + ws_ext_ship_cost-->
   <gen_ForGenerator>
    <sameChoiceAs field="ws_promo_sk" generatorByID="numberOfItemsChooser"/>
    <do>
     <gen_ForFormulaGenerator>
      <formula>generator[0] + generator[1]</formula>
      <gen_OtherFieldValueGenerator>
       <reference field="ws_net_paid" />
      </gen_OtherFieldValueGenerator>
      <gen_OtherFieldValueGenerator>
       <reference field="ws_ext_ship_cost" />
      </gen_OtherFieldValueGenerator>
      <decimalPlaces roundPlainValue="1">2</decimalPlaces>
     </gen_ForFormulaGenerator>
    </do>
   </gen_ForGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="ws_net_paid_inc_ship_tax" size="7" type="NUMERIC" primary="false">
  <!-- ws_net_paid_inc_tax + ws_ext_ship_cost -->
   <gen_ForGenerator>
    <sameChoiceAs field="ws_promo_sk" generatorByID="numberOfItemsChooser"/>
    <do>
     <gen_ForFormulaGenerator>
      <formula>generator[0] + generator[1]</formula>
      <gen_OtherFieldValueGenerator>
       <reference field="ws_net_paid_inc_tax" />
      </gen_OtherFieldValueGenerator>
      <gen_OtherFieldValueGenerator>
       <reference field="ws_ext_ship_cost" />
      </gen_OtherFieldValueGenerator>
      <decimalPlaces roundPlainValue="1">2</decimalPlaces>
     </gen_ForFormulaGenerator>
    </do>
   </gen_ForGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="ws_net_profit" size="7" type="NUMERIC" primary="false">
  <!-- ws_net_paid - ws_ext_wholesale_cost -->
   <gen_ForGenerator>
    <sameChoiceAs field="ws_promo_sk" generatorByID="numberOfItemsChooser"/>
    <do>
     <gen_ForFormulaGenerator>
      <formula>generator[0] - generator[1]</formula>
      <gen_OtherFieldValueGenerator>
       <reference field="ws_net_paid" />
      </gen_OtherFieldValueGenerator>
      <gen_OtherFieldValueGenerator>
       <reference field="ws_ext_wholesale_cost" />
      </gen_OtherFieldValueGenerator>
      <decimalPlaces roundPlainValue="1">2</decimalPlaces>
     </gen_ForFormulaGenerator>
    </do>
   </gen_ForGenerator>
  </field>
 </table>
 
 
 
 <!-- Each row in this table represents a single lineitem for the return of an item sold through the web sales channel and recorded in the web_returns table -->
 <table name="web_returns">
  <size>${web_returns_size}</size>
  
  <!-- used by Q19 -->
  <!-- FK d_date_sk -->
  <field name="wr_returned_date_sk" size="19" type="BIGINT" primary="false">
      <gen_ExtendedFormulaGenerator>
        <formula>(long)generator[0] + parent.getRandomSample(0L, (long) (${WR_MAX_RETURN_DAYS_AFTER_PURCHASE}), random)</formula>
        <decimalPlaces>0</decimalPlaces>
        <gen_RandomListItemsGenerator>
          <sameChoiceAs field="wr_item_sk" generatorByID="listIndexChooser" />
          <gen_ReferenceGenerator choose="sameChoiceAs" from="">
            <sameChoiceAs field="wr_order_number" generatorByID="orderChooser"/>
            <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="web_sales" field="ws_ship_date_sk" />
          </gen_ReferenceGenerator>
        </gen_RandomListItemsGenerator>
      </gen_ExtendedFormulaGenerator>
  </field>
  
  <!-- FK t_time_sk -->
  <field name="wr_returned_time_sk" size="19" type="BIGINT" primary="false">
   <gen_ForGenerator>
    <sameChoiceAs field="wr_item_sk" generatorByID="listIndexChooser" />
    <do>
      <gen_ReferenceGenerator choose="random" from="historical">
       <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="time_dim" field="t_time_sk" />
      </gen_ReferenceGenerator>
    </do>
   </gen_ForGenerator>
  </field>
  
  <!-- used by Q16, Q19 -->
  <!-- FK i_item_sk,ws_item_sk -->
  <field name="wr_item_sk" size="19" type="BIGINT" primary="true">
   <gen_RandomListItemsGenerator id="listIndexChooser">
    <gen_ReferenceGenerator choose="sameChoiceAs" from="">
     <sameChoiceAs field="wr_order_number" generatorByID="orderChooser"/>
     <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="web_sales" field="ws_item_sk" />
    </gen_ReferenceGenerator>
   </gen_RandomListItemsGenerator>
  </field>
  
  <!-- FK c_customer_sk -->
  <field name="wr_refunded_customer_sk" size="19" type="BIGINT" primary="false" nullable="true">
  <gen_ProbabilityGenerator id="isGiftChooser">
    <probability value="${WS_GIFT_PCT}">
      <gen_ReferenceGenerator choose="random" from="historical" id="refundCustomerChooser">
       <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer" field="c_customer_sk" />
      </gen_ReferenceGenerator>
    </probability>
    <probability value="1 - ${WS_GIFT_PCT}">
      <gen_ReferenceGenerator choose="sameChoiceAs" from="">
       <sameChoiceAs field="wr_order_number" generatorByID="orderChooser"/>
       <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="web_sales" field="ws_ship_customer_sk" /><!-- reference result can be null -->
      </gen_ReferenceGenerator>
    </probability>
  </gen_ProbabilityGenerator>
  </field>
  
  <!-- FK c_current_cdemo_sk/cd_demo_sk -->
  <field name="wr_refunded_cdemo_sk" size="19" type="BIGINT" primary="false" nullable="true">
    <gen_ProbabilityGenerator>
      <sameChoiceAs field="wr_refunded_customer_sk" generatorByID="isGiftChooser"/>
      <probability value="${WS_GIFT_PCT}">
       <gen_ReferenceGenerator choose="sameChoiceAs" from="">
         <sameChoiceAs field="wr_refunded_customer_sk" generatorByID="refundCustomerChooser"/>
         <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer" field="c_current_cdemo_sk" /><!-- reference result can be null -->
       </gen_ReferenceGenerator>
      </probability>
      <probability value="1 - ${WS_GIFT_PCT}">
        <gen_ReferenceGenerator choose="sameChoiceAs" from="">
         <sameChoiceAs field="wr_order_number" generatorByID="orderChooser"/>
         <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="web_sales" field="ws_ship_cdemo_sk" /><!-- reference result can be null -->
        </gen_ReferenceGenerator>
      </probability>
    </gen_ProbabilityGenerator>
  </field>
  
  <!-- FK c_current_hdemo_sk/hd_demo_sk -->
  <field name="wr_refunded_hdemo_sk" size="19" type="BIGINT" primary="false" nullable="true">
    <gen_ProbabilityGenerator>
      <sameChoiceAs field="wr_refunded_customer_sk" generatorByID="isGiftChooser"/>
      <probability value="${WS_GIFT_PCT}">
        <gen_ReferenceGenerator choose="sameChoiceAs" from="">
         <sameChoiceAs field="wr_refunded_customer_sk" generatorByID="refundCustomerChooser"/>
         <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer" field="c_current_hdemo_sk" /> <!-- reference result can be null -->
       </gen_ReferenceGenerator>
      </probability>
      <probability value="1 - ${WS_GIFT_PCT}">
        <gen_ReferenceGenerator choose="sameChoiceAs" from="">
         <sameChoiceAs field="wr_order_number" generatorByID="orderChooser"/>
         <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="web_sales" field="ws_ship_hdemo_sk" /> <!-- reference result can be null -->
        </gen_ReferenceGenerator>
      </probability>
    </gen_ProbabilityGenerator>
  </field>
  
  <!-- FK c_current_addr_sk/ca_address_sk -->
  <field name="wr_refunded_addr_sk" size="19" type="BIGINT" primary="false" nullable="true">
    <gen_ProbabilityGenerator>
      <sameChoiceAs field="wr_refunded_customer_sk" generatorByID="isGiftChooser"/>
      <probability value="${WS_GIFT_PCT}">
        <gen_ReferenceGenerator choose="sameChoiceAs" from="">
         <sameChoiceAs field="wr_refunded_customer_sk" generatorByID="refundCustomerChooser"/>
         <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer" field="c_current_addr_sk" /> <!-- reference result can be null -->
       </gen_ReferenceGenerator>
      </probability>
      <probability value="1 - ${WS_GIFT_PCT}">
        <gen_ReferenceGenerator choose="sameChoiceAs" from="">
         <sameChoiceAs field="wr_order_number" generatorByID="orderChooser"/>
         <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="web_sales" field="ws_ship_addr_sk" />
        </gen_ReferenceGenerator>
      </probability>
    </gen_ProbabilityGenerator>
  </field>
  
  <!-- FK c_customer_sk -->
  <field name="wr_returning_customer_sk" size="19" type="BIGINT" primary="false">
      <gen_OtherFieldValueGenerator>
        <reference field="wr_refunded_customer_sk" />
      </gen_OtherFieldValueGenerator>
  </field>
  
  <!-- FK cd_demo_sk -->
  <field name="wr_returning_cdemo_sk" size="19" type="BIGINT" primary="false" nullable="true">
    <gen_NullGenerator probability="${NULL_CHANCE}">
      <gen_OtherFieldValueGenerator>
        <reference field="wr_refunded_cdemo_sk" /><!-- reference result can be null -->
      </gen_OtherFieldValueGenerator>
    </gen_NullGenerator>
  </field>
  
  <!-- FK hd_demo_sk -->
  <field name="wr_returning_hdemo_sk" size="19" type="BIGINT" primary="false" nullable="true">
    <gen_NullGenerator probability="${NULL_CHANCE}">
      <gen_OtherFieldValueGenerator>
        <reference field="wr_refunded_hdemo_sk" />
      </gen_OtherFieldValueGenerator>
    </gen_NullGenerator>
  </field>
  
  <!-- FK ca_address_sk -->
  <field name="wr_returning_addr_sk" size="19" type="BIGINT" primary="false">
    <gen_NullGenerator probability="${NULL_CHANCE}">
      <gen_OtherFieldValueGenerator>
        <reference field="wr_refunded_addr_sk" />
      </gen_OtherFieldValueGenerator>
    </gen_NullGenerator>
  </field>
  
  <!-- FK wp_web_page_sk -->
  <field name="wr_web_page_sk" size="19" type="BIGINT" primary="false">
    <gen_NullGenerator probability="${NULL_CHANCE}">
      <gen_RandomListItemsGenerator>
        <sameChoiceAs field="wr_item_sk" generatorByID="listIndexChooser" />
        <gen_ReferenceGenerator choose="sameChoiceAs" from="">
          <sameChoiceAs field="wr_order_number" generatorByID="orderChooser"/>
          <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="web_sales" field="ws_web_page_sk" />
        </gen_ReferenceGenerator>
      </gen_RandomListItemsGenerator>
    </gen_NullGenerator>
  </field>
  
  <!-- FK r_reason_sk -->
  <field name="wr_reason_sk" size="19" type="BIGINT" primary="false">
   <gen_ForGenerator>
    <sameChoiceAs field="wr_item_sk" generatorByID="listIndexChooser" />
    <do>
     <gen_NullGenerator probability="${NULL_CHANCE}">
      <gen_ReferenceGenerator choose="random" from="historical">
       <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="reason" field="r_reason_sk" />
      </gen_ReferenceGenerator>
     </gen_NullGenerator>
    </do>
   </gen_ForGenerator>
  </field>
  
  <!-- used by Q16 -->
  <!-- FK ws_order_number -->
  <field name="wr_order_number" size="19" type="BIGINT" primary="true">
   <gen_PermutationReferenceGenerator id="orderChooser">
    <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="web_sales" field="ws_order_number" />
   </gen_PermutationReferenceGenerator>
  </field>
  
  <!-- used by Q19 -->
  <field name="wr_return_quantity" size="10" type="INTEGER" primary="false">
   <gen_ExtendedFormulaGenerator>
    <formula>parent.getRandomSample(1l, (long) generator[0], random)</formula>
    <decimalPlaces>0</decimalPlaces>
    <gen_RandomListItemsGenerator>
     <sameChoiceAs field="wr_item_sk" generatorByID="listIndexChooser" />
     <gen_ReferenceGenerator choose="sameChoiceAs" from="">
      <sameChoiceAs field="wr_order_number" generatorByID="orderChooser"/>
      <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="web_sales" field="ws_quantity" />
     </gen_ReferenceGenerator>
    </gen_RandomListItemsGenerator>
   </gen_ExtendedFormulaGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="wr_return_amt" size="7" type="NUMERIC" primary="false">
    <!-- alias: ext_sales_price, net_paid -->
    <!-- Formula: ws_sales_price * wr_return_quantity -->
    <gen_ExtendedFormulaGenerator>
      <formula>generator[0] * generator[1]</formula>
      <decimalPlaces>2</decimalPlaces>
      <!-- generator[0] -->
      <gen_RandomListItemsGenerator>
        <sameChoiceAs field="wr_item_sk" generatorByID="listIndexChooser" />
        <gen_ReferenceGenerator choose="sameChoiceAs" from="">
          <sameChoiceAs field="wr_order_number" generatorByID="orderChooser"/>
          <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="web_sales" field="ws_sales_price" />
        </gen_ReferenceGenerator>
      </gen_RandomListItemsGenerator>
      <!-- generator[1] -->
      <gen_OtherFieldValueGenerator>
        <reference field="wr_return_quantity" />
      </gen_OtherFieldValueGenerator>
    </gen_ExtendedFormulaGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="wr_return_tax" size="7" type="NUMERIC" primary="false">
    <!-- alias: ext_tax -->
    <!-- Formula: wr_return_amt * tax_pct -->
    <!-- TODO: where should tax_pct come from????? -->
    <gen_ExtendedFormulaGenerator>
      <formula>generator[0] * generator[1]</formula>
      <decimalPlaces>2</decimalPlaces>
      <!-- generator[0] -->
      <gen_DoubleGenerator>
        <minD>0.00d</minD>
        <maxD>0.09d</maxD>
        <decimalPlaces>2</decimalPlaces>
      </gen_DoubleGenerator>
      <!-- generator[1] -->
      <gen_OtherFieldValueGenerator>
        <reference field="wr_return_amt" />
      </gen_OtherFieldValueGenerator>
    </gen_ExtendedFormulaGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="wr_return_amt_inc_tax" size="7" type="NUMERIC" primary="false">
    <!-- alias: net_paid_inc_tax-->
    <!-- wr_return_amt + wr_return_tax -->
    <gen_ExtendedFormulaGenerator>
      <formula>generator[0] + generator[1]</formula>
      <decimalPlaces>2</decimalPlaces>
      <gen_OtherFieldValueGenerator>
        <reference field="wr_return_amt" />
      </gen_OtherFieldValueGenerator>
      <gen_OtherFieldValueGenerator>
        <reference field="wr_return_tax" />
      </gen_OtherFieldValueGenerator>
    </gen_ExtendedFormulaGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="wr_fee" size="7" type="NUMERIC" primary="false">
   <gen_ForGenerator>
    <sameChoiceAs field="wr_item_sk" generatorByID="listIndexChooser" />
    <do>
     <gen_DoubleGenerator>
      <minD>0.50d</minD>
      <maxD>100.00d</maxD>
      <decimalPlaces>2</decimalPlaces>
     </gen_DoubleGenerator>
    </do>
   </gen_ForGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="wr_return_ship_cost" size="7" type="NUMERIC" primary="false">
    <!-- alias: ext_shipping_cost-->
    <!-- 
    shipping = rand[0.0, 0.5]
    shipping_cost = list_price * shipping
    ext_shipping_cost = shipping_cost * quantity 
    ext_shipping_cost = list_price * shipping * quantity
    ext_shipping_cost= ws_list_price * random[0.00, 1.00] * wr_return_quantity
    -->
    <gen_ExtendedFormulaGenerator>
      <formula>generator[0] * generator[1] *  generator[2]</formula>
      <decimalPlaces>2</decimalPlaces>
      <!-- generator[0] -->
      <gen_RandomListItemsGenerator>
        <sameChoiceAs field="wr_item_sk" generatorByID="listIndexChooser" />
        <gen_ReferenceGenerator choose="sameChoiceAs" from="">
          <sameChoiceAs field="wr_order_number" generatorByID="orderChooser"/>
          <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="web_sales" field="ws_list_price" />
        </gen_ReferenceGenerator>
      </gen_RandomListItemsGenerator>
      <!-- generator[1] -->
      <gen_DoubleGenerator>
        <minD>0.00d</minD>
        <maxD>1.00d</maxD>
        <decimalPlaces>2</decimalPlaces>
      </gen_DoubleGenerator>
      <!-- generator[2] -->
      <gen_OtherFieldValueGenerator>
        <reference field="wr_return_quantity" />
      </gen_OtherFieldValueGenerator>
    </gen_ExtendedFormulaGenerator>
  </field>
  
  <!-- used by Q16 -->
  <!-- decimalSize="7,2"-->
  <field name="wr_refunded_cash" size="7" type="NUMERIC" primary="false">
    <!-- rand[0.0,1.0] * netPaid == rand[0.0,1.0] * wr_return_amt? -->
    <gen_ExtendedFormulaGenerator>
      <formula>generator[0] * generator[1]</formula>
      <decimalPlaces>2</decimalPlaces>
      <!-- generator[0] -->
      <gen_DoubleGenerator>
        <minD>0.00d</minD>
        <maxD>1.00d</maxD>
        <decimalPlaces>2</decimalPlaces>
      </gen_DoubleGenerator>
      <!-- generator[1] -->
      <gen_OtherFieldValueGenerator>
        <reference field="wr_return_amt" />
      </gen_OtherFieldValueGenerator>
    </gen_ExtendedFormulaGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="wr_reversed_charge" size="7" type="NUMERIC" primary="false">
    <!-- wr_reversed_charge = rand[0.01, 1.00] * (net_paid - refunded_cash) -->
    <!-- wr_reversed_charge = rand[0.01, 1.00] * (wr_return_amt -wr_refunded_cash)-->
    <gen_ExtendedFormulaGenerator>
      <formula>generator[0] * (generator[1]  - generator[2])</formula>
      <decimalPlaces>2</decimalPlaces>
      <!-- generator[0] -->    
      <gen_DoubleGenerator>
        <minD>0.01d</minD>
        <maxD>1.00d</maxD>
        <decimalPlaces>2</decimalPlaces>
      </gen_DoubleGenerator>
      <!-- generator[1] -->
      <gen_OtherFieldValueGenerator>
        <reference field="wr_return_amt" />
      </gen_OtherFieldValueGenerator>
      <!-- generator[2] -->
      <gen_OtherFieldValueGenerator>
        <reference field="wr_refunded_cash" />
      </gen_OtherFieldValueGenerator>
    </gen_ExtendedFormulaGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="wr_account_credit" size="7" type="NUMERIC" primary="false">
    <!-- wr_account_credit=  net_paid - reversed_charge - refunded_cash    -->
    <!-- wr_account_credit= wr_return_amt -wr_reversed_charge - wr_refunded_cash -->
    <gen_ExtendedFormulaGenerator>
      <formula>generator[0]  - generator[1] - generator[2]</formula>
      <decimalPlaces>2</decimalPlaces>
      <!-- generator[0] -->
      <gen_OtherFieldValueGenerator>
        <reference field="wr_return_amt" />
      </gen_OtherFieldValueGenerator>
      <!-- generator[1] -->
      <gen_OtherFieldValueGenerator>
        <reference field="wr_reversed_charge" />
      </gen_OtherFieldValueGenerator>
      <!-- generator[2] -->
      <gen_OtherFieldValueGenerator>
        <reference field="wr_refunded_cash" />
      </gen_OtherFieldValueGenerator>
    </gen_ExtendedFormulaGenerator>
  </field>
  
  <!-- decimalSize="7,2"-->
  <field name="wr_net_loss" size="7" type="NUMERIC" primary="false">
    <!-- 
    wr_return_ship_cost = ext_shipping_cost = shipping_cost * quantity
    net_paid_inc_ship = net_paid(wr_return_amt) + ext_shipping_cost 
    wr_return_tax = ext_tax = tax * net_paid 
    net_paid_inc_ship_tax = net_paid_inc_ship + ext_tax

    wr_net_loss = net_paid_inc_ship_tax  -store_credit - refunded_cash - reversed_charge + fee
    subistute wr_net_loss formula componets with above formulas: 
    wr_net_loss = wr_return_amt + wr_return_ship_cost  + wr_return_tax - wr_store_credit - wr_refunded_cash - wr_reversed_charge + wr_fee
    -->
    <gen_ExtendedFormulaGenerator>
      <formula>generator[0] + generator[1] + generator[2] - generator[3] - generator[4] - generator[5] + generator[2]</formula>
      <decimalPlaces>2</decimalPlaces>
      <!-- generator[0] -->
      <gen_OtherFieldValueGenerator>
        <reference field="wr_return_amt" />
      </gen_OtherFieldValueGenerator>
      <!-- generator[1] -->
      <gen_OtherFieldValueGenerator>
        <reference field="wr_return_ship_cost" />
      </gen_OtherFieldValueGenerator>
      <!-- generator[2] -->
      <gen_OtherFieldValueGenerator>
        <reference field="wr_return_tax" />
      </gen_OtherFieldValueGenerator>
      <!-- generator[3] -->
      <gen_OtherFieldValueGenerator>
        <reference field="wr_account_credit" />
      </gen_OtherFieldValueGenerator>
      <!-- generator[4] -->
      <gen_OtherFieldValueGenerator>
        <reference field="wr_refunded_cash" />
      </gen_OtherFieldValueGenerator>
      <!-- generator[5] -->
      <gen_OtherFieldValueGenerator>
        <reference field="wr_reversed_charge" />
      </gen_OtherFieldValueGenerator>
      <!-- generator[6 -->
      <gen_OtherFieldValueGenerator>
        <reference field="wr_fee" />
      </gen_OtherFieldValueGenerator>

    </gen_ExtendedFormulaGenerator>
  </field>
 </table>
 
 <!-- 
 web_clickstreams_size = 5 times web_sales table size
 every 5th clickstream is a "buy" and linked to the web_sale
 the other four are "non buying visitors"
 e.g.:
 
 id |type              |ws_order_number |ws_bill_customer_sk 
 ============================================================================
 1  |visitor anonymous |null            |null
 2  |visitor anonymous |null            |null
 3  |visitor known user|null            |random
 4  |visitor known user|null            |random
 5  |Buyer             |id/5 = 5/5= 1   |same as in referenced ws_order_number
 6  |visitor anonymous |null            |null
 7  |visitor anonymous |null            |null
 8  |visitor known user|null            |random
 9  |visitor known user|null            |random
 10 |Buyer             |id/5 = 10/5= 2  |same as in referenced ws_order_number
 11 |visitor anonymous |null            |null
 12 |visitor anonymous |null            |null
 13 |visitor known user|null            |random
 14 |visitor known user|null            |random
 15 |Buyer             |id/5 = 15/5= 3  |same as in referenced ws_order_number
 
 
 
  -->
 <table name="web_clickstreams">
  <size>${web_clickstreams_size}</size>
  
  <!-- Removed in accordance with Tilmann (conference call 2014-04-15) -->
  <!--
  <field name="wcs_click_sk" size="19" type="BIGINT" primary="true">
  <gen_IdGenerator> <min>${SK_ID_OFFSET}</min> </gen_IdGenerator>
  </field>
  -->
   
 <!-- used by Q3, Q4, Q8, Q12 -->
  <field name="wcs_click_date_sk" size="19" type="BIGINT" primary="false">
   <gen_ProbabilityGenerator>
    <sameChoiceAs field="wcs_sales_sk" generatorByID="buyerOrVisitorChooser"/>

    <!--visitor -->    
    <probability value="${visitor_likelihood}">
      <gen_FormulaGenerator>
       <formula>${web_sales_days_since_date_begin_date} + Math.floor(gc.getID() * ((${web_sales_days_within} - 1) / ${web_clickstreams_size}))</formula>
       <decimalPlaces>0</decimalPlaces>
      </gen_FormulaGenerator>
    </probability>
    
    <!-- buyer -->
    <probability value="1 - ${visitor_likelihood}">
     <gen_ReferenceGenerator choose="sameChoiceAs" from="">
      <sameChoiceAs field="wcs_sales_sk" generatorByID="salesSKChooser"/>
      <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="web_sales" field="ws_sold_date_sk" />
     </gen_ReferenceGenerator>
    </probability>
   </gen_ProbabilityGenerator>
  </field>
  
  <!-- used by Q3, Q4, Q8, Q12 -->
  <field name="wcs_click_time_sk" size="19" type="BIGINT" primary="false">
   <gen_ProbabilityGenerator>
    <sameChoiceAs field="wcs_sales_sk" generatorByID="buyerOrVisitorChooser"/>
    
    <!--visitor -->    
    <probability value="${visitor_likelihood}">
     <gen_ForGenerator>
      <sameChoiceAs field="wcs_sales_sk" generatorByID="numberOfVisitorClicksChooser"/>
      <do>
        <gen_ReferenceGenerator choose="random" from="historical">
         <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="time_dim" field="t_time_sk" />
        </gen_ReferenceGenerator>
      </do>
     </gen_ForGenerator>
    </probability>
    
    <!-- buyer -->
    <probability value="1 - ${visitor_likelihood}">
      <gen_BuildListGenerator flattenSubList="true"><!-- merges the two sublists into one list  -->
      
        <!-- List 1 random additional clicks-->
        <gen_ForGenerator id="additionalBuyerClicksChooser">
         <sameChoiceAs field="wcs_sales_sk" generatorByID="additionalBuyerClicksChooser"/>
         <do>
           <gen_ReferenceGenerator choose="random" from="historical">
             <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="time_dim" field="t_time_sk" />
           </gen_ReferenceGenerator>
         </do>
        </gen_ForGenerator>
        
        <!-- list 2 clicks on purchased items-->
         <gen_ForGenerator id="salesTimePadding">
          <i>
            <gen_LongGenerator>
              <min>${WS_ITEMS_PER_ORDER_MAX}</min> <!-- always padd to max items per order -->
              <max>${WS_ITEMS_PER_ORDER_MAX}</max>
            </gen_LongGenerator>
          </i>    
          <do>
            <gen_ReferenceGenerator choose="sameChoiceAs" from="">
             <sameChoiceAs field="wcs_sales_sk" generatorByID="salesSKChooser"/>
              <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="web_sales" field="ws_sold_time_sk" />
            </gen_ReferenceGenerator>
          </do>
        </gen_ForGenerator>
      </gen_BuildListGenerator>
    </probability>
    
   </gen_ProbabilityGenerator>
   
  </field>
  
  <!-- used by Q3, Q8 -->
  <field name="wcs_sales_sk" size="19" type="BIGINT" primary="false" nullable="true">
   <gen_ProbabilityGenerator id="buyerOrVisitorChooser">
    <disableRng>true</disableRng>
    <chunkSize>${clickstreams_chunksize}</chunkSize>
    
    <!--visitor -->
    <probability value="${visitor_likelihood}">
      <gen_ForGenerator id="numberOfVisitorClicksChooser">
        <i>
         <gen_LongGenerator>
          <min>${mean_clicks_per_visitor} - 5</min>
          <max>${mean_clicks_per_visitor} + 5</max>
         </gen_LongGenerator>
        </i>
        <do>
         <gen_StaticValueGenerator>
          <value></value>
         </gen_StaticValueGenerator>
        </do>
     </gen_ForGenerator>
    </probability>
    
    <!-- buyer -->
    <probability value="1 - ${visitor_likelihood}">
      <gen_BuildListGenerator flattenSubList="true"><!-- merges the two sublists into one list  -->
     
        <!-- List 1 random additional clicks-->
        <gen_ForGenerator id="additionalBuyerClicksChooser">
          <i>
            <gen_LongGenerator>
             <min>${mean_clicks_per_buyer} - 1</min>
             <max>${mean_clicks_per_buyer} + 2</max>
            </gen_LongGenerator>
          </i>
          <do>
           <gen_StaticValueGenerator>
            <value></value>
           </gen_StaticValueGenerator>
          </do>
         </gen_ForGenerator>
      
      <!-- list 2 clicks on purchased items-->
       <!--  RelativeGenerator: (long) Math.floor( staticFactor * relativeFactor * generatedDouble);  If not explicitly specified, every factor has a default value of 1.0 
           RelativeGenerator's result is a 'choice' queryable with <gen_ReferenceGenerator><sameChoiceAs>
       -->
       <!-- Choose the ws_order_number. Every  ${clickstreams_chunksize}'th clickstream is a "buy" all others are "visitors" -->
         <gen_ForGenerator id="salesSkPadding">
          <i>
            <gen_LongGenerator>
              <min>${WS_ITEMS_PER_ORDER_MAX}</min> <!-- always padd to max items per order -->
              <max>${WS_ITEMS_PER_ORDER_MAX}</max>
            </gen_LongGenerator>
          </i>    
          <do>
           <gen_RelativeGenerator id="salesSKChooser" correctionFactor="1 / ${clickstreams_chunksize}">
             <gen_IdGenerator /> <!-- current ID as input source to RelativeGenerator -->
           </gen_RelativeGenerator>
          </do>
        </gen_ForGenerator>
      </gen_BuildListGenerator>
    </probability>
   </gen_ProbabilityGenerator>
  </field>
  
  <!-- used by Q2, Q3, Q4, Q5, Q8, Q12, Q30 -->
  <field name="wcs_item_sk" size="19" type="BIGINT" primary="false">
   <gen_ProbabilityGenerator id="itemSKChooser">
    <sameChoiceAs field="wcs_sales_sk" generatorByID="buyerOrVisitorChooser"/>
    
    <!--visitor -->
    <probability value="${visitor_likelihood}">
     <gen_ForGenerator>
      <sameChoiceAs field="wcs_sales_sk" generatorByID="numberOfVisitorClicksChooser"/>
      <do>
       <gen_ReferenceGenerator choose="random" from="historical">
        <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="item" field="i_item_sk" />
       </gen_ReferenceGenerator>
      </do>
     </gen_ForGenerator>
    </probability>
    
    <!-- buyer -->
    <probability value="1 - ${visitor_likelihood}">
     <gen_BuildListGenerator flattenSubList="true"><!-- merges the two sublists into one list  -->
      
      <!-- List 1 random additional clicks-->
      <gen_ForGenerator id="additionalBuyerClicksChooser">
       <sameChoiceAs field="wcs_sales_sk" generatorByID="additionalBuyerClicksChooser"/>
       <do>
        <gen_ReferenceGenerator choose="random" from="historical">
         <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="item" field="i_item_sk" />
        </gen_ReferenceGenerator>
       </do>
      </gen_ForGenerator>
      
      <!-- list 2 clicks on purchased items-->
      <gen_ReferenceGenerator choose="sameChoiceAs" from="">
       <sameChoiceAs field="wcs_sales_sk" generatorByID="salesSKChooser"/>
       <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="web_sales" field="ws_item_sk" />
      </gen_ReferenceGenerator>
     </gen_BuildListGenerator>
    </probability>
    
   </gen_ProbabilityGenerator>
  </field>
  
  <!-- used by Q4, Q8 -->
  <field name="wcs_web_page_sk" size="19" type="BIGINT" primary="false">
   <gen_ProbabilityGenerator>
    <sameChoiceAs field="wcs_sales_sk" generatorByID="buyerOrVisitorChooser"/>
    
    <!-- visitor -->
    <probability value="${visitor_likelihood}">
     <gen_ForGenerator>
      <sameChoiceAs field="wcs_sales_sk" generatorByID="numberOfVisitorClicksChooser"/>
      <do>
        <gen_ReferenceGenerator choose="random" from="historical">
         <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="web_page" field="wp_web_page_sk" />
        </gen_ReferenceGenerator>
      </do>
     </gen_ForGenerator>
    </probability>
    
    <!-- buyer -->
    <probability value="1 - ${visitor_likelihood}">
      <gen_BuildListGenerator flattenSubList="true"><!-- concatenate lists as single flat list -->
       <!-- list 1 random additional clicks -->
       <gen_ForGenerator>
        <sameChoiceAs field="wcs_sales_sk" generatorByID="additionalBuyerClicksChooser"/>        
        <do>
         <gen_ReferenceGenerator choose="random" from="historical">
          <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="web_page" field="wp_web_page_sk" />
         </gen_ReferenceGenerator>
        </do>
       </gen_ForGenerator>
       <!-- list 2 clicks on purchased items-->
       <gen_ReferenceGenerator choose="sameChoiceAs" from="">
        <sameChoiceAs field="wcs_sales_sk" generatorByID="salesSKChooser"/>
        <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="web_sales" field="ws_web_page_sk" />
       </gen_ReferenceGenerator>
      </gen_BuildListGenerator>
    </probability>
    
   </gen_ProbabilityGenerator>
  </field>
  
  <!-- used by Q2, Q3, Q4, Q5, Q8, Q12, Q30 -->
  <field name="wcs_user_sk" size="19" type="BIGINT" primary="false" nullable="true">
   <gen_ProbabilityGenerator>
    <sameChoiceAs field="wcs_sales_sk" generatorByID="buyerOrVisitorChooser"/>
    <!-- visitor -->
    <probability value="${visitor_likelihood}">
     <gen_ProbabilityGenerator>
     
      <!-- known visitor -->
      <probability value="${visitor_known_likelihood}">
       <gen_ReferenceGenerator choose="random" from="historical">
        <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer" field="c_customer_sk" />
       </gen_ReferenceGenerator>
      </probability>
      
      <!-- unknown visitor -->
      <probability value="1 - ${visitor_known_likelihood}">
       <gen_StaticValueGenerator>
        <value></value>
       </gen_StaticValueGenerator>
      </probability>
     </gen_ProbabilityGenerator>
   
    </probability>
    
    <!-- buyer -->
    <probability value="1 - ${visitor_likelihood}">
     <gen_ReferenceGenerator choose="sameChoiceAs" from="">
      <sameChoiceAs field="wcs_sales_sk" generatorByID="salesSKChooser"/>
      <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="web_sales" field="ws_bill_customer_sk" />
     </gen_ReferenceGenerator>
    </probability>
   </gen_ProbabilityGenerator>
  </field>
  
  <!-- unique click session id for debug -->
  <!-- 
   <field name="wcs_click_sk" size="19" type="BIGINT" primary="true">
    <gen_IdGenerator> <min>${SK_ID_OFFSET}</min> </gen_IdGenerator>
  </field>
   -->
  
 </table>
 
 
 <!-- Each row in this table represents details of a web page within a web site -->
 <table name="web_page">
  <size>${web_page_size}</size>
  
  <!-- used by Q4, Q8, Q14 -->
  <field name="wp_web_page_sk" size="19" type="BIGINT" primary="true">
  <gen_IdGenerator> <min>${SK_ID_OFFSET}</min> </gen_IdGenerator>
  </field>
  
  <field name="wp_web_page_id" size="16" type="CHAR" primary="false">
   <gen_ConvertNumberToStringGenerator>
    <gen_IdGenerator/>
    <size>16.0</size>
    <characters>ABCDEFGHIJKLMNOPQRSTUVWXYZ</characters>
   </gen_ConvertNumberToStringGenerator>
  </field>
  
  <field name="wp_rec_start_date" size="13" type="CHAR" primary="false">
    <gen_DateTimeGenerator>
     <useFixedStepSize>true</useFixedStepSize>
     <startDate>${web_page_begin_date}</startDate>
     <endDate>${web_sales_begin_date}</endDate>
     <outputFormat>yyyy-MM-dd</outputFormat>
    </gen_DateTimeGenerator>
  </field>
  
  <field name="wp_rec_end_date" size="13" type="CHAR" primary="false"  nullable="true">
   <!-- all pages are active for the moment => NULL -->
   <gen_StaticValueGenerator>
    <value></value>
   </gen_StaticValueGenerator>
   <!--
   <gen_NullGenerator probability="0.5">
      <gen_AddRandomSecondsGenerator>
       <reference field="wp_rec_start_date" />
       <outputFormat>yyyy-MM-dd</outputFormat>
       <min>2.0 * 365 * ${one_day_in_milliseconds} / 1000</min>
       <max>4.0 * 365 * ${one_day_in_milliseconds} / 1000</max>
      </gen_AddRandomSecondsGenerator>
   </gen_NullGenerator>
   -->
  </field>
  
  <!-- FK d_date_sk -->
  <field name="wp_creation_date_sk" size="19" type="BIGINT" primary="false">
    <gen_ReferenceGenerator choose="random" from="historical">
     <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="date_dim" field="d_date_sk" />
    </gen_ReferenceGenerator>
  </field>
  
  <!-- FK d_date_sk -->
  <field name="wp_access_date_sk" size="19" type="BIGINT" primary="false"><!-- TODO access date after creation -->
    <gen_FormulaGenerator>
     <formula>parent.getRandomSample((long)generator[0], (long) (${date_dim_size} ), random)</formula>
     <decimalPlaces>0</decimalPlaces>
     <gen_OtherFieldValueGenerator>
      <reference field="wp_creation_date_sk" />
     </gen_OtherFieldValueGenerator>
    </gen_FormulaGenerator>
  </field>
  
  <field name="wp_autogen_flag" size="1" type="CHAR" primary="false">
   <gen_ProbabilityGenerator>
     <probability value="${WP_AUTOGEN_PCT}">
      <gen_StaticValueGenerator>
       <value>1</value>
      </gen_StaticValueGenerator>
     </probability>
     <probability value="1 - ${WP_AUTOGEN_PCT}">
      <gen_StaticValueGenerator>
       <value>0</value>
      </gen_StaticValueGenerator>
     </probability>
    </gen_ProbabilityGenerator>
  </field>
  
  <!-- FK c_customer_sk -->
  <field name="wp_customer_sk" size="19" type="BIGINT" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_ReferenceGenerator choose="random" from="historical">
     <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="customer" field="c_customer_sk" />
    </gen_ReferenceGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="wp_url" size="100" type="VARCHAR" primary="false">
    <gen_TemplateGenerator>
     <getValue>fvdto.setBothValues("http://www." + generator[0] + ".com");</getValue>
     <gen_RandomAString>
      <min>4.0</min>
      <max>85.0</max>
     </gen_RandomAString>
    </gen_TemplateGenerator>
  </field>
  
  <!-- used by Q4, Q8 -->
  <field name="wp_type" size="50" type="CHAR" primary="false">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="web_page_use" valueColumn="0" weightColumn="0" />
  </field>
  
  <!-- used by Q14 -->
  <field name="wp_char_count" size="10" type="INTEGER" primary="false">
   <gen_FormulaGenerator >
     <!-- 
     min =wp_link_count * 125 + wp_image_count * 50  = 25 * 125 + 7 * 50  = 3475
     max =wp_link_count * 300 + wp_image_count * 150 = 25 * 300 + 7 * 150 = 8550
      -->
     <formula unlockFullAccess="true"><!-- 0.0d;
     long min =((long)generator[0])*125L + ((long)generator[1])*50L;
     long max=((long)generator[0])*300L + ((long)generator[1])*150L;
     result=parent.getRandomSample(min,max, random)
     -->
  </formula>
     <decimalPlaces>0</decimalPlaces>
     <gen_OtherFieldValueGenerator>
      <reference field="wp_link_count" />
     </gen_OtherFieldValueGenerator>
     <gen_OtherFieldValueGenerator>
      <reference field="wp_image_count" />
     </gen_OtherFieldValueGenerator>
   </gen_FormulaGenerator>
  </field>
  
  <field name="wp_link_count" size="10" type="INTEGER" primary="false">
    <gen_LongGenerator>
     <min>${WP_LINK_MIN}</min>
     <max>${WP_LINK_MAX}</max>
    </gen_LongGenerator>
  </field>
  
  <field name="wp_image_count" size="10" type="INTEGER" primary="false">
    <gen_LongGenerator>
     <min>${WP_IMAGE_MIN}</min>
     <max>${WP_IMAGE_MAX}</max>
    </gen_LongGenerator>
  </field>
  
  <field name="wp_max_ad_count" size="10" type="INTEGER" primary="false">
    <gen_LongGenerator>
     <min>${WP_AD_MIN}</min>
     <max>${WP_AD_MAX}</max>
    </gen_LongGenerator>
  </field>
 </table>
 
 <!-- currently not touched by queries -->
 <!-- Each row in this table represents details of a web site -->
 <table name="web_site">
  <size>${web_site_size}</size>
  
  <field name="web_site_sk" size="19" type="BIGINT" primary="true">
  <gen_IdGenerator> <min>${SK_ID_OFFSET}</min> </gen_IdGenerator>
  </field>
  
  <field name="web_site_id" size="16" type="CHAR" primary="false">
   <gen_ConvertNumberToStringGenerator>
    <gen_IdGenerator/>
    <size>16.0</size>
    <characters>ABCDEFGHIJKLMNOPQRSTUVWXYZ</characters>
   </gen_ConvertNumberToStringGenerator>
  </field>
  
  <field name="web_rec_start_date" size="13" type="CHAR" primary="false">
    <gen_DateTimeGenerator>
     <useFixedStepSize>true</useFixedStepSize>
     <inputFormat>yyyy-MM-dd</inputFormat>
     <startDate>${DIMENSION_TABLES_START_DAY}</startDate>
     <endDate>${DIMENSION_TABLES_END_DAY}</endDate>
     <outputFormat>yyyy-MM-dd</outputFormat>
    </gen_DateTimeGenerator>
  </field>
  
  <field name="web_rec_end_date" size="13" type="CHAR" primary="false" nullable="true">
   <!-- all web sites are active for the moment => NULL -->
   <gen_StaticValueGenerator>
    <value></value>
   </gen_StaticValueGenerator>
   <!--
   <gen_NullGenerator probability="0.5">
      <gen_AddRandomSecondsGenerator>
       <reference field="web_rec_start_date" />
       <outputFormat>yyyy-MM-dd</outputFormat>
       <min>2.0 * 365 * ${one_day_in_milliseconds} / 1000</min>
       <max>4.0 * 365 * ${one_day_in_milliseconds} / 1000</max>
      </gen_AddRandomSecondsGenerator>
   </gen_NullGenerator>
  -->
  </field>>
  
  <field name="web_name" size="50" type="VARCHAR" primary="false">
   <gen_TemplateGenerator>
     <getValue>fvdto.setBothValues("site_" + Long.valueOf(gc.getID()/6).toString());</getValue>
    </gen_TemplateGenerator>
  </field>
  
  <!-- FK d_date_sk -->
  <field name="web_open_date_sk" size="19" type="BIGINT" primary="false">
    <gen_ReferenceGenerator choose="random" from="historical">
     <reference maxIDFromSchedulerPrepartitioner="${REFRESH_SYSTEM_ENABLED}" table="date_dim" field="d_date_sk" />
    </gen_ReferenceGenerator>
  </field>
  
  <!-- FK d_date_sk -->
  <field name="web_close_date_sk" size="19" type="BIGINT" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_FormulaGenerator>
     <formula>parent.getRandomSample((long)generator[0], (long) (${date_dim_size} ), random)</formula>
     <decimalPlaces>0</decimalPlaces>
     <gen_OtherFieldValueGenerator>
       <reference field="web_open_date_sk" />
      </gen_OtherFieldValueGenerator>
    </gen_FormulaGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="web_class" size="50" type="VARCHAR" primary="false">
    <gen_StaticValueGenerator>
     <value>Unknown</value>
    </gen_StaticValueGenerator>
  </field>
  
  <field name="web_manager" size="40" type="VARCHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_TemplateGenerator>
     <getValue>fvdto.setBothValues(generator[0] + " " + generator[1]);</getValue>
     <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="first_names" valueColumn="0" weightColumn="0" />
     <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="last_names" valueColumn="0" weightColumn="0" />
    </gen_TemplateGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="web_mkt_id" size="10" type="INTEGER" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_LongGenerator>
     <min>1.0</min>
     <max>6.0</max>
    </gen_LongGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="web_mkt_class" size="50" type="VARCHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
     <gen_RandomSentence>
      <min>25</min> <max>50</max>
    </gen_RandomSentence>
   </gen_NullGenerator>
  </field>
  
  <field name="web_mkt_desc" size="100" type="VARCHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
     <gen_RandomSentence>
      <min>50</min> <max>100</max>
    </gen_RandomSentence>
   </gen_NullGenerator>
  </field>
  
  <field name="web_market_manager" size="40" type="VARCHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_TemplateGenerator>
     <getValue>fvdto.setBothValues(generator[0] + " " + generator[1]);</getValue>
     <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="first_names" valueColumn="0" weightColumn="0" />
     <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="last_names" valueColumn="0" weightColumn="0" />
    </gen_TemplateGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="web_company_id" size="10" type="INTEGER" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_LongGenerator>
     <min>1.0</min>
     <max>6.0</max>
    </gen_LongGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="web_company_name" size="50" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="syllables" valueColumn="0" weightColumn="0" />
   </gen_NullGenerator>
  </field>
  
  <field name="web_street_number" size="10" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_LongGenerator>
     <min>${address_street_number_min}</min>
     <max>${address_street_number_max}</max>
    </gen_LongGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="web_street_name" size="60" type="VARCHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_TemplateGenerator>
     <getValue><!-- String streetName= (rng.nextDouble()>0.5 ? (generator[0].toString() + " " + generator[1].toString()):  generator[1].toString());
             fvdto.setBothValues(streetName); 
     --></getValue>
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="street_names" valueColumn="0" weightColumn="0" />
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="street_names" valueColumn="0" weightColumn="0" />
    </gen_TemplateGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="web_street_type" size="15" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="street_type" valueColumn="0" weightColumn="0" />
   </gen_NullGenerator>
  </field>
  
  <field name="web_suite_number" size="10" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_RandomAString>
     <min>${address_suite_number_min}</min>
     <max>${address_suite_number_max}</max>
    </gen_RandomAString>
   </gen_NullGenerator>
  </field>
  
  <field name="web_city" size="60" type="VARCHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="cities" valueColumn="0" weightColumn="0" />
   </gen_NullGenerator>
  </field>
  
  <field name="web_county" size="30" type="VARCHAR" primary="false">
    <gen_WeightedListGenerator id="countyChooser" filename="dicts/bigbench/ds-genProbabilities.txt" list="fips_county" valueColumn="county" weightColumn="uniform" />
  </field>
  
  <field name="web_state" size="2" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="fips_county" valueColumn="st" weightColumn="uniform">
     <sameChoiceAs field="web_county" generatorByID="countyChooser"/>
    </gen_WeightedListGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="web_zip" size="10" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_LongGenerator>
     <min>${address_zip_min}</min>
     <max>${address_zip_max}</max>
    </gen_LongGenerator>
   </gen_NullGenerator>
  </field>
  
  <field name="web_country" size="20" type="VARCHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_StaticValueGenerator>
     <value>United States</value>
    </gen_StaticValueGenerator>
   </gen_NullGenerator>
  </field>
  
  <!-- decimalSize="5,2"-->
  <field name="web_gmt_offset" size="5" type="NUMERIC" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_WeightedListGenerator filename="dicts/bigbench/ds-genProbabilities.txt" list="fips_county" valueColumn="gmt" weightColumn="uniform">
     <sameChoiceAs field="web_county" generatorByID="countyChooser"/>
    </gen_WeightedListGenerator>
   </gen_NullGenerator>
  </field>
  
  <!-- decimalSize="5,2"-->
  <field name="web_tax_percentage" size="5" type="NUMERIC" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_DoubleGenerator>
     <minD>0.00d</minD>
     <maxD>0.12d</maxD>
     <decimalPlaces>2</decimalPlaces>
    </gen_DoubleGenerator>
   </gen_NullGenerator>
  </field>
 </table>
 
  
 <!-- currently not touched by queries -->
 <!-- Each row in this table represents details of an income range -->
 <table name="income_band">
  <size>${income_band_size}</size>
  
  <field name="ib_income_band_sk" size="19" type="BIGINT" primary="true">
  <gen_IdGenerator> <min>${SK_ID_OFFSET}</min> </gen_IdGenerator>
  </field>
  
  <field name="ib_lower_bound" size="10" type="BIGINT" primary="false">
    <gen_FormulaGenerator>
     <formula>gc.getID() * ${income_band_stepsize} + 1</formula>
     <decimalPlaces>0</decimalPlaces>
    </gen_FormulaGenerator>
  </field>
  
  <field name="ib_upper_bound" size="10" type="BIGINT" primary="false">
    <gen_FormulaGenerator>
     <formula>(gc.getID() + 1) * ${income_band_stepsize}</formula>
     <decimalPlaces>0</decimalPlaces>
    </gen_FormulaGenerator>
  </field>
 </table>
 
  <!-- currently not touched by queries -->
 <!-- Each row in this table represents a reason why an item was returned -->
 <table name="reason">
  <size>${reason_size}</size>
  
  <field name="r_reason_sk" size="19" type="BIGINT" primary="true">
  <gen_IdGenerator> <min>${SK_ID_OFFSET}</min> </gen_IdGenerator>
  </field>
  
  <field name="r_reason_id" size="16" type="CHAR" primary="false">
   <gen_RandomAString>
    <min>1.0</min>
    <max>16.0</max>
   </gen_RandomAString>
  </field>
  
  <field name="r_reason_desc" size="100" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
     <gen_RandomSentence>
      <min>50</min> <max>100</max>
    </gen_RandomSentence>
   </gen_NullGenerator>
  </field>
 </table>
 
 
 <!-- currently not touched by queries -->
 <!-- Each row in this table represents a shipping mode -->
 <table name="ship_mode">
  <size>${ship_mode_size}</size>
  
  <field name="sm_ship_mode_sk" size="19" type="BIGINT" primary="true">
  <gen_IdGenerator> <min>${SK_ID_OFFSET}</min> </gen_IdGenerator>
  </field>
  
  <field name="sm_ship_mode_id" size="16" type="CHAR" primary="false">
   <gen_RandomAString>
    <min>1.0</min>
    <max>16.0</max>
   </gen_RandomAString>
  </field>
  
  <field name="sm_type" size="30" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_RandomAString>
     <min>1.0</min>
     <max>30.0</max>
    </gen_RandomAString>
   </gen_NullGenerator>
  </field>
  
  <field name="sm_code" size="10" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_RandomAString>
     <min>1.0</min>
     <max>10.0</max>
    </gen_RandomAString>
   </gen_NullGenerator>
  </field>
  
  <field name="sm_carrier" size="20" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_RandomAString>
     <min>1.0</min>
     <max>20.0</max>
    </gen_RandomAString>
   </gen_NullGenerator>
  </field>
  
  <field name="sm_contract" size="20" type="CHAR" primary="false">
   <gen_NullGenerator probability="${NULL_CHANCE}">
    <gen_RandomAString>
     <min>1.0</min>
     <max>20.0</max>
    </gen_RandomAString>
   </gen_NullGenerator>
  </field>
 </table>
 
 
 </schema>
